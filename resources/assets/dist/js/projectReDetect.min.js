/* All right reserved by Neusoft Co. Ltd. 2016-10-14 10:10:00 */
!function(a){function b(){i(),h(),c(),e()}function c(){a("#closeDialog").click(function(){f()}),a("#saveProjectReDetail").click(function(){g()}),a("#deleteRedetectBtn").click(function(){d()})}function d(){var b=a("#projectRedetectTable").udeTable().fnGetSelectedRowData();if(!b)return void showMessage(a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.deleteProjectReDetail_showMessage"),null,"error");var c=function(b){if(b&&"0"===b.getCode())showMessage(a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.deleteProjectReDetectComplete"),null,"info"),a("#projectRedetectTable").udeTable().fnDeleteRow();else{var c=b.getDetail();showMessage(c,null,"error")}},d=function(){var d=b.id;a.ude.rpc.projectReDetect.deleteProjectReDetect(c,d)};a.ude.util.confirm(a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.deleteReDetectConfirm")+"\uff1f",d)}function e(){a("#projectRedetectDetailTable").udeTable({data:null,columns:[{sTitle:a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.initReDetectDetailTable_menuNameOld"),mData:"menuNameOld"},{sTitle:a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.initReDetectDetailTable_menuNameNew"),mData:"menuNameNew",mRender:n},{sTitle:a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.initReDetectDetailTable_parentMenuIdOld"),mData:"parentMenuIdOld"},{sTitle:a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.initReDetectDetailTable_parentMenuIdNew"),mData:"parentMenuIdNew",mRender:o},{sTitle:a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.initReDetectDetailTable_nodeUrlOld"),mData:"nodeUrlOld"},{sTitle:a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.initReDetectDetailTable_nodeUrlNew"),mData:"nodeUrlNew",mRender:p},{sTitle:a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.initReDetectDetailTable_detectType"),mData:"detectType",mRender:m}]})}function f(){a.ude.dialog.close()}function g(){var b=a("#projectRedetectDetailTable").udeTable().fnGetData(),c=new DataCenter,d=new DataStore(q);d.setRowSetName(q);for(var e=0;e<b.length;e++)if("add"===b[e].detectType){var f={};f.menuId=b[e].menuId,f.menuName=b[e].menuNameNew.split(",")[1],f.parentMenuId=b[e].parentMenuIdNew.split(",")[1],f.nodeUrl=b[e].nodeUrlNew,f.isEnabled="T",f.analyseKind="auto",f.ismenu="1",f.pageType="pageMenu",""===b[e].nodeUrlNew||null===b[e].nodeUrlNew||"undefined"==typeof b[e].nodeUrlNew?(f.leaf="0",f.nodeUrl=""):f.leaf="1",d.getRowSet().addRow(f)}c.addDataStore(d);var g=function(c){if(c&&"0"===c.getCode()){a("#saveProjectReDetail").attr("disabled",!0);var d=b[0].redetectId;a.ude.rpc.projectReDetect.updateProjectReDetectSyncFlag(null,d),showMessage(a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.saveProjectReDetectDetailComplete"),null,"info")}else{a("#saveProjectReDetail").attr("disabled",!1);var e=c.getDetail();showMessage(e,null,"error")}};a.ude.rpc.projectReDetect.saveProjectReDetectDetail(g,c)}function h(){a(".common-content-down").css("height",a(".common-content").height()-a(".common-content-top").outerHeight())}function i(){var b=function(a){if(a&&"0"===a.getCode()){var b=a.getSingleDataStore();j(b.getRowSet().getData())}else{var c=a.getDetail();showMessage(c,null,"error")}};a.ude.rpc.projectReDetect.initPage(b)}function j(b){a("#projectRedetectTable").udeTable({data:b,columns:[{sTitle:a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.initProjectReDetectLogTable_description"),mData:"description",sWidth:"50%"},{sTitle:a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.initProjectReDetectLogTable_redetectPerson"),mData:"redetectPerson",sWidth:"25%"},{sTitle:a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.initProjectReDetectLogTable_redetectDate"),mData:"redetectDate",sWidth:"25%"}],dblClick:function(a){k(a)}})}function k(b){var c=a("#projectRedetectTable").udeTable().fnGetSelectedRowDataIndex(),d=b.syncFlag;if("1"===d||c>0?a("#reDetectDetailDialog").prop("sync",!0):a("#reDetectDetailDialog").prop("sync",!1),!b)return!1;var e=b.id,f=function(a){if(a&&"0"===a.getCode()){var b=a.getSingleDataStore();l(b.getRowSet().getData())}else{var c=a.getDetail();showMessage(c,null,"error")}};a.ude.rpc.projectReDetect.getProjectReDetectDetail(f,e)}function l(b){a.ude.dialog.open("reDetectDetailDialog",{title:a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.setProjectReDetectDetailTable_title"),width:"1000px"}),a("#reDetectDetailDialog").prop("sync")?a("#saveProjectReDetail").attr("disabled",!0):a("#saveProjectReDetail").attr("disabled",!1),a("#projectRedetectDetailTable").udeTable().fnRedraw(b),a("[name = configGroup]:checkbox").bind("click",function(){a("#projectRedetectDetailTable").udeTable().dataTable().fnClearTable();for(var c=a("[name = configGroup]:checkbox").filter(":checked"),d=0;d<c.length;d++)for(var e=c[d].value,f=0;f<b.length;f++)b[f].detectType===e&&a("#projectRedetectDetailTable").udeTable().fnAddRow(b[f])})}function m(b){return"add"===b?a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.detectType_add"):"modify"===b?a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.detectType_modify"):a.i18n.prop("ude.page.config.projectReDetect.projectReDetectJs.detectType_del")}function n(a,b,c){var d=a.split(",");a=d[0];var e=c.detectType;return"modify"===e&&c.menuNameNew!==c.menuNameOld&&(a="<span style='color:red'>"+a+"</span>"),a}function o(a,b,c){var d=a.split(",");a=d[0];var e=c.detectType;return"modify"===e&&c.parentMenuIdNew!==c.parentMenuIdOld&&(a="<span style='color:red'>"+a+"</span>"),a}function p(a,b,c){var d=c.detectType;return"modify"===d&&c.nodeUrlNew!==c.nodeUrlOld&&(a="<span style='color:red'>"+a+"</span>"),a}a.ude.page.config.projectReDetect.main={init:b};var q="com.neusoft.utf.portal.config.projectstructure.entity.UtfProjectAnalyseResult"}(jQuery),function(a){a.projectReDetect={initPage:function(a){var b={};b.url=appPath+"/utf/config/projectReDetect/getProjectReDetectLog.action",b.sync=!1,b.load=a,$.maf.action.requestData(b)},getProjectReDetectDetail:function(a,b){var c=new DataCenter;c.addParameter("id",b);var d={};d.url=appPath+"/utf/config/projectReDetect/getProjectReDetectDetail.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},saveProjectReDetectDetail:function(a,b){var c={};c.url=appPath+"/utf/config/projectReDetect/saveProjectReDetactDetail.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},updateProjectReDetectSyncFlag:function(a,b){var c=new DataCenter;c.addParameter("id",b);var d={};d.url=appPath+"/utf/config/projectReDetect/updateProjectReDetectSyncFlag.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},deleteProjectReDetect:function(a,b){var c=new DataCenter;c.addParameter("id",b);var d={};d.url=appPath+"/utf/config/projectReDetect/deleteProjectReDetect.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)}}}($.ude.rpc);