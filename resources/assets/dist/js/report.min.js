/* All right reserved by Neusoft Co. Ltd. 2016-10-13 18:10:14 */

!function(a){a.adaptiveTestReport={getAdaptiveTest:function(a,b){var c={};c.url=appPath+"/utf/report/getAdaptiveTest.action",c.sync=!1,c.load=a;var d;d=b&&b instanceof DataCenter?b:new DataCenter;var e=!0;$.maf.action.requestData(c,d,e)},getAdaptiveTestResult:function(a,b){var c={};c.url=appPath+"/utf/report/getAdaptiveTestResult.action",c.sync=!1,c.load=a;var d;d=b&&b instanceof DataCenter?b:new DataCenter;var e=!0;$.maf.action.requestData(c,d,e)},getAdaptiveTestDetail:function(a,b){var c={};c.url=appPath+"/utf/report/getAdaptiveTestDetail.action",c.sync=!1,c.load=a;var d;d=b&&b instanceof DataCenter?b:new DataCenter;var e=!0;$.maf.action.requestData(c,d,e)},getShowTabs:function(a,b){var c={};c.url=appPath+"/utf/report/getShowTabs.action",c.sync=!1,c.load=a;var d;d=b&&b instanceof DataCenter?b:new DataCenter;var e=!1;$.maf.action.requestData(c,d,e)},getMonkeyTestDetail:function(a,b){var c={};c.url=appPath+"/utf/report/getMonkeyTestDetail.action",c.sync=!1,c.load=a;var d;d=b&&b instanceof DataCenter?b:new DataCenter;var e=!0;$.maf.action.requestData(c,d,e)},getPerformanceData:function(a,b){var c={};c.url=appPath+"/utf/report/getPerformanceDetail.action",c.sync=!1,c.load=a;var d;d=b&&b instanceof DataCenter?b:new DataCenter;var e=!0;$.maf.action.requestData(c,d,e)}}}($.ude.rpc),function(a,b){function c(){f(),d(),k(appPath+"/utf/report/getAdaptiveTest.action",[]),l()}function d(){a("#searchBtn").off("click").on("click",function(){g()}),a(document).off("click",".detail").on("click",".detail",function(b){b.preventDefault(),a("#adaptiveTestReport").data("detailId",a(this).attr("id")),e(a(this))})}function e(b){var c=appPath+b.attr("url"),d="&d="+(new Date).getTime();a.ude.util.loadPage({},c+d,a(".rightContent")[0])}function f(){var b={timeOnlyTitle:a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_timeOnlyTitle"),currentText:a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_currentText"),closeText:a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_closeText"),timepicker:!1,dateFormat:"yy-mm-dd",showHour:!1,showMinute:!1,showTime:!1,changeMonth:!0,changeYear:!0,monthNamesShort:[a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort1"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort2"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort3"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort4"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort5"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort6"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort7"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort8"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort9"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort10"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort11"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort12")],dayNamesMin:[a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_dayNamesMin0"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_dayNamesMin1"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_dayNamesMin2"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_dayNamesMin3"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_dayNamesMin4"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_dayNamesMin5"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_dayNamesMin6")]};a("#createDate").datetimepicker(b),a("#endDate").datetimepicker(b)}function g(){var b=a.trim(a("#appName").val()),c=a.trim(a("#version").val()),d=a.trim(a("#createDate").val()),e=a.trim(a("#endDate").val());return""!=d&&""!=e&&d>e?(showMessage("\u5f00\u59cb\u65f6\u95f4\u4e0d\u80fd\u5927\u4e8e\u7ed3\u675f\u65f6\u95f4",null,"error"),!1):void i(b,c,d,e)}function h(c,d,e){var f=a("body");f.find(".tests").remove(),f.append(c);var g=a(".tests").html();template=b.compile(g);var h=template(d);a(e).html(h)}function i(b,c,d,e){a("#adaptiveTestTable").dataTable().fnDestroy(),k(appPath+"/utf/report/getAdaptiveTest.action",[{name:"appName",value:b},{name:"version",value:c},{name:"createDate",value:d},{name:"endDate",value:e}])}function j(b){if(!b)return void showMessage(a.i18n.prop("ude.page.execute.redrawExecResultSuccess"),null,"error");if(1===b.getCode())return void showMessage(b.getDetail(),null,"");var c=b.getDataStore("data").getRowSet(0).getData();return a.each(c,function(a,b){var c=b.createAt?new Date(b.createAt):new Date;b.createAt=Sugar.Date.format(c,"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}"),b.status=b.status?"T"===b.status.toUpperCase()?m.success.name:m.failed.name:m.unknown.name}),c}function k(b,c){var d=function(a){return'<a class="detail" href="javascript: void(0); return false;" id="'+a+'" url="/utf/report/toAdaptiveTestDetail.action?id="'+a+">\u67e5\u770b</a>"},e={server:b,serverParams:c,serverCallback:j,columns:[{sTitle:"\u5e94\u7528\u540d\u79f0",mData:"appName",sWidth:"10%"},{sTitle:"\u5305\u540d",mData:"packageName",sWidth:"30%"},{sTitle:"\u63d0\u6d4b\u4eba",mData:"account",sWidth:"10%"},{sTitle:"\u8bbe\u5907\u6570\u91cf",mData:"deviceCount",sWidth:"10%"},{sTitle:"\u63d0\u6d4b\u65f6\u95f4",mData:"createAt",sWidth:"15%"},{sTitle:"\u72b6\u6001",mData:"status",sWidth:"10%"},{sTitle:"\u64cd\u4f5c",sWidth:"15%",mData:"id",mRender:d}]};a("#adaptiveTestTable").pagingTable(e)}function l(){require(["echarts","echarts/chart/bar","echarts/chart/line","echarts/chart/pie","echarts/chart/gauge","echarts/chart/scatter"],function(b){var c=b;option={tooltip:{trigger:"axis"},legend:{data:["\u57fa\u672c\u6d4b\u8bd5","\u904d\u5386\u6d4b\u8bd5","\u6027\u80fd\u6d4b\u8bd5"],x:"center",y:"bottom"},xAxis:[{type:"category",boundaryGap:!1,data:["\u5c0f\u7c73","\u534e\u4e3a","\u8054\u60f3","\u8c37\u6b4c","\u4e09\u661f","oppo","\u683c\u529b"]}],yAxis:[{type:"value"}],grid:{x:40,y:10,x2:10,y2:60},series:[{name:"\u57fa\u672c\u6d4b\u8bd5",type:"line",data:[120,132,301,134,90,230,210]},{name:"\u904d\u5386\u6d4b\u8bd5",type:"line",data:[120,82,201,134,190,230,110]},{name:"\u6027\u80fd\u6d4b\u8bd5",type:"line",data:[20,182,101,34,90,130,210]}]};c.init(a(".report-container")[0])})}a.ude.page.adaptiveTestReport.report={init:c,bind:d,render:h};var m={success:{name:"\u6210\u529f",value:"T"},failed:{name:"\u5931\u8d25",value:"F"},unknown:{name:"\u672a\u77e5",value:""}}}(jQuery,Handlebars),function(a,b,c){function d(){e(),f(),h(),i()}function e(){var b=function(b){var c=a(".nav.nav-tabs"),d=a(c).next(".tab-content"),e=b.getDataStore("data").getRowSet(0).getData()[0];"1"!==e.isShowBase&&(c.children("li:eq(0)").remove(),d.children(".tab-pane:eq(0)").remove()),"1"!==e.isShowMonkey&&(c.children("li:eq(1)").remove(),d.children(".tab-pane:eq(1)").remove()),"1"!==e.isShowPerformance&&(c.children("li:eq(2)").remove(),d.children(".tab-pane:eq(2)").remove()),c.children("li:eq(0)").addClass("active")},c=new DataCenter,d=a("#adaptiveTestReport").data("detailId");return d?(c.setParameter("detailId",d),void a.ude.rpc.adaptiveTestReport.getShowTabs(b,c)):(showMessage("result id can not be null"),!1)}function f(){a(document).off("click",".nav a.base").on("click",".nav a.base",function(){var a=q();j(a.chartData)}),a(document).off("click",".nav a.monkey").on("click",".nav a.monkey",function(){var b=function(){var b=a("#adaptiveTestReport").data("monkey");a.each(b,function(a,b){b.result="T"===b.result.toUpperCase()?u.success.name:u.failed.name}),m(b.chartData),n(b)};l(b)}),a(document).off("click",".nav a.performance").on("click",".nav a.performance",function(){var b=function(){var b=a("#adaptiveTestReport").data("performances");p(b)};o(b)}),a(document).on("change",'input[type="radio"][name="base"]',function(){var b=a(this).val(),c=q(b);j(c.chartData),k(c)}),a(document).on("click","a.screen-shot",function(b){b.preventDefault();var c=a(this).attr("screenShot");if(c){var d=a("#show-screen-shot");d.find("img").attr("src",c).css("width","300px").css("height","500px"),a.ude.dialog.open("show-screen-shot",{title:"\u8bbe\u5907\u622a\u5c4f",width:"400px"}),d.css({width:"400px",height:"566px",padding:0,"text-align":"center"}),d.parent("div").css({position:"absolute",width:"400px",height:"600px","z-index":2048,left:"50%",top:"50%",transform:"translate(-50%, -50%)","-moz-transform":"translate(-50%, -50%)","-ms-transform":"translate(-50%, -50%)","-webkit-transform":"translate(-50%, -50%)"})}})}function g(c,d,e){var f=a("body");f.find(".tests").remove(),f.append(c);var g=a(".tests").html();template=b.compile(g);var h=template(d);a(e).html(h)}function h(){var b=function(b){var d=a(".report-detail");console.log(b);var e=b.getDataStore("data").getRowSet(0).getData();a.each(e,function(a,b){var d=new Date(b.createAt);b.createAt=c.Date.format(d,"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}"),d=new Date(b.updateAt),b.updateAt=c.Date.format(d,"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}"),b.result="T"===b.result.toUpperCase()?u.success.name:u.failed.name}),a("#adaptiveTestResult").data("result",e),g(templates["template/reports-detail.hbs"],{results:e,appPath:appPath,description:e[0]},d)},d=new DataCenter,e=a("#adaptiveTestReport").data("detailId");return e?(d.setParameter("detailId",e),void a.ude.rpc.adaptiveTestReport.getAdaptiveTestResult(b,d)):(showMessage("result id can not be null"),!1)}function i(){var b=function(b){var d=b.getDataStore("data").getRowSet(0).getData();a.each(d,function(a,b){var d=new Date(b.createAt);b.createAt=c.Date.format(d,"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}"),b.result="T"===b.result.toUpperCase()?u.success.name:u.failed.name}),a("#adaptiveTestReport").data("detail",d);var e=q();j(e.chartData),k(e)},d=new DataCenter,e=a("#adaptiveTestReport").data("detailId");return e?(d.setParameter("detailId",e),void a.ude.rpc.adaptiveTestReport.getAdaptiveTestDetail(b,d)):(showMessage("result id can not be null"),!1)}function j(b){require(["echarts","echarts/chart/bar","echarts/chart/line","echarts/chart/pie","echarts/chart/gauge","echarts/chart/scatter"],function(c){var d=c,e={title:{text:"\u5b89\u88c5/\u542f\u52a8/\u5378\u8f7d"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"horizontal",x:"right",y:"center",data:["\u6210\u529f","\u5931\u8d25"]},series:[{name:"\u6d4b\u8bd5\u7ed3\u679c",type:"pie",radius:"55%",center:["50%","60%"],data:b,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},f=d.init(a("#base .chart")[0]);f.setOption(e)})}function k(b){var c=a("#base .result");g(templates["template/base-test.hbs"],{base:b,appPath:appPath},c)}function l(b){var c=function(c){console.log(c);var d=c.getDataStore("data").getRowSet(0).getData();r(d),a("#adaptiveTestReport").data("monkey",d),b&&"function"==typeof b&&b()},d=new DataCenter,e=a("#adaptiveTestReport").data("detailId");return e?(d.setParameter("detailId",e),void a.ude.rpc.adaptiveTestReport.getMonkeyTestDetail(c,d)):(showMessage("result id can not be null"),!1)}function m(b){require(["echarts","echarts/chart/bar","echarts/chart/line","echarts/chart/pie","echarts/chart/gauge","echarts/chart/scatter"],function(c){var d=c,e={title:{text:"\u904d\u5386\u6d4b\u8bd5"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"horizontal",x:"right",y:"center",data:["\u6210\u529f","\u5931\u8d25"]},series:[{name:"\u6d4b\u8bd5\u7ed3\u679c",type:"pie",radius:"55%",center:["50%","60%"],data:b,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},f=d.init(a("#adaptiveResult .chart")[0]);f.setOption(e)})}function n(b){var c=a("#adaptiveResult .result");g(templates["template/adaptive-test.hbs"],{monkeys:b.categoryMobiles,appPath:appPath},c)}function o(b){var c=function(c){console.log(c);var d=c.getDataStore("data").getRowSet(0).getData();s(d),a("#adaptiveTestReport").data("performances",d),b&&"function"==typeof b&&b()},d=new DataCenter,e=a("#adaptiveTestReport").data("detailId");return e?(d.setParameter("detailId",e),void a.ude.rpc.adaptiveTestReport.getPerformanceData(c,d)):(showMessage("result id can not be null"),!1)}function p(b){require(["echarts","echarts/chart/line"],function(c){var d=c,e={title:{text:"CPU(%)"},tooltip:{trigger:"axis"},legend:{data:b.legends,x:"center",y:"bottom"},xAxis:[{type:"category",boundaryGap:!1,data:b.xAixsData}],yAxis:[{type:"value"}],series:b.cpu},f={title:{text:"\u5185\u5b58(MB)"},tooltip:{trigger:"axis"},legend:{data:b.legends,x:"center",y:"bottom"},xAxis:[{type:"category",boundaryGap:!1,data:b.xAixsData}],yAxis:[{type:"value"}],series:b.mem},g=d.init(a(".performance-result")[0]);g.setOption(e),g=d.init(a(".performance-result")[1]),g.setOption(f)})}function q(b){var c=a("#adaptiveTestReport").data("detail"),d=[];switch(b){case t.base.install:d=a.grep(c,function(a,b){return a.type===t.base.install});break;case t.base.start:d=a.grep(c,function(a,b){return a.type===t.base.start});break;case t.base.uninstall:d=a.grep(c,function(a,b){return a.type===t.base.uninstall});break;default:d=a.grep(c,function(a,b){return a.type&&a.type!==t.adaptive})}if(d&&d.length>0){var e=0,f=0;a.each(d,function(a,b){b.type!==t.adaptive&&(b.result===u.success.name?e++:b.result===u.failed.name&&f++)}),d.chartData=[{name:u.success.name,value:e},{name:u.failed.name,value:f}]}return d}function r(b){if(b&&b.length>0){var d=0,e=0,f=[];a.each(b,function(a,b){b.result===u.success.value?d++:b.result===u.failed.value&&e++,f.push({name:b.mobileName,value:b.eventCount})});var g=new c.Array(f);b.eventCounts=g.unique().raw;var h=[];a.each(b.eventCounts,function(d,e){var f=[],g=e.value,i=0;a.each(b,function(a,b){b.mobileName===e.name&&(f.push(b),"T"===b.result&&i++)}),h.push({name:e.name,value:f,passedRadio:100*c.Number.round(i/g,4)})}),b.chartData=[{name:u.success.name,value:d},{name:u.failed.name,value:e}],b.categoryMobiles=h}return b}function s(b){if(b&&b.length>0){var d=[],e=[],f=[],g=[];a.each(b,function(a,b){d.push(b.deviceId),e.push(b.mobileName),f.push(b.mobileName),g.push(b.eventType)}),d=c.Array.unique(d),e=c.Array.unique(e),f=c.Array.unique(f),g=c.Array.unique(g);var h=[];a.each(g,function(a,b){h.push(b.split(","))}),g=c.Array.flatten(h);var i=[],j=[],k="line";a.each(d,function(d,f){var g=[],h=[];a.each(b,function(a,b){b.deviceId===f&&(g.push(b.cpu.split(",")),h.push(b.mem.split(",")))}),g=c.Array.flatten(g),h=c.Array.flatten(h),i.push({name:e[d],type:k,data:g}),j.push({name:e[d],type:k,data:h})}),b.cpu=i,b.mem=j,b.xAixsData=g,b.legends=e}return b}a.ude.page.adaptiveTestReport.reportDetail={init:d,bind:f,render:g};var t={base:{install:"\u5b89\u88c5\u6d4b\u8bd5",start:"\u542f\u52a8\u6d4b\u8bd5",uninstall:"\u5378\u8f7d\u6d4b\u8bd5"},adaptive:"\u904d\u5386\u6d4b\u8bd5",performance:"\u6027\u80fd\u6d4b\u8bd5"},u={success:{name:"\u6210\u529f",value:"T"},failed:{name:"\u5931\u8d25",value:"F"}}}(jQuery,Handlebars,Sugar);
//# sourceMappingURL=report.map