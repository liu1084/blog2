/* All right reserved by Neusoft Co. Ltd. 2016-10-14 10:10:28 */
!function(a){function b(){a("#userTypehead").data("searchKeyWord",null),a("#userTypehead").data("searchKey",null),a("#userTable").data("userStore",null),a("#statisTable").data("statisRecordStore",null)}function c(b){a("#userTable").data("userStore",b),b.addRowData=function(a){b.getRowSet().addRow(a)},b.deleteRowData=function(a,c){c=c?c:"id";for(var d=b.getRowSet().getRowCount(),e=null,f=-1,g=0;g<d;g++)if(e=b.getRowSet().getRow(g),e.getItemValue(c)==a[c]){f=g;break}f<0||b.getRowSet().deleteRow(f)},b.updateRowData=function(a,c){c=c?c:"id";for(var d=b.getRowSet().getRowCount(),e=null,f=0;f<d&&(e=b.getRowSet().getRow(f),e.getItemValue(c)!=a[c]);f++);if(e)for(var g in a)e.setItemValue(g,a[g])}}function d(){return a("#userTable").data("userStore")}function e(){return a("#statisTable").data("statisRecordStore")}function f(b){a("#statisTable").data("statisRecordStore",b),b.addRowData=function(a){b.getRowSet().addRow(a)},b.deleteRowData=function(a,c){c=c?c:"id";for(var d=b.getRowSet().getRowCount(),e=null,f=-1,g=0;g<d;g++)if(e=b.getRowSet().getRow(g),e.getItemValue(c)==a[c]){f=g;break}f<0||b.getRowSet().deleteRow(f)},b.updateRowData=function(a,c){c=c?c:"id";for(var d=b.getRowSet().getRowCount(),e=null,f=0;f<d&&(e=b.getRowSet().getRow(f),e.getItemValue(c)!=a[c]);f++);if(e)for(var g in a)e.setItemValue(g,a[g])}}function g(b){a("#userTypehead").data("searchKeyWord",b)}function h(){return a("#userTypehead").data("searchKeyWord")}function i(b){a("#userTypehead").data("searchKey",b)}function j(){return a("#userTypehead").data("searchKey")}a.ude.page.statistic.parameter={initParameters:b,setUserStore:c,getUserStore:d,getRecordStore:e,setRecordStore:f,setSearchKeyWord:g,setSearchKey:i,getSearchKeyWord:h,getSearchKey:j}}(jQuery),function(a){a.statistic={initResources:function(a,b){var c=new DataCenter;c.addParameter("flag",a);var d={};d.url=appPath+"/utf/statistic/initGrid.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},getRecord:function(a){var b={};b.url=appPath+"/utf/statistic/initGrid.action",b.sync=!1,b.load=a,$.maf.action.requestData(b)},deleteRecord:function(a,b){var c=new DataCenter;c.addParameter("id",a);var d={};d.url=appPath+"/utf/statistic/deleteRecord.action",d.load=b,$.maf.action.requestData(d,c)},updateRecord:function(a,b,c){var d=new DataCenter;d.addParameter("id",a),d.addParameter("reportFlag",b);var e={};e.url=appPath+"/utf/statistic/updateRecord.action",e.load=c,$.maf.action.requestData(e,d)},deleteRecords:function(a,b){for(var c=new DataCenter,d=0;d<a.length;d++)c.addParameter(a[d],a[d]);var e={};e.url=appPath+"/utf/statistic/deleteRecords.action",e.sync=!1,e.load=b,$.maf.action.requestData(e,c)},createReport:function(a,b,c){var d=new DataCenter;d.addParameter("sceneIdStr",a),d.addParameter("reportType",b);var e={};e.url=appPath+"/utf/statistic/createReport.action",e.load=c,$.maf.action.requestData(e,d)},generateReport:function(a,b,c){var d=new DataCenter;d.addParameter("sceneIdStr",a),d.addParameter("updateDate",b);var e={};e.url=appPath+"/utf/statistic/generateReport.action",e.load=c,$.maf.action.requestData(e,d)},generateCaseReport:function(a,b,c){var d=new DataCenter;d.addParameter("sceneIdStr",a),d.addParameter("updateDate",b),d.addParameter("executeTime",c);var e={};e.url=appPath+"/utf/statistic/generateCaseReport.action",$.maf.action.requestData(e,d)},createXML:function(a,b,c){var d=new DataCenter;d.addParameter("sceneIdStr",a),d.addParameter("updateDate",b);var e={};e.url=appPath+"/utf/statistic/createXML.action",e.load=c,$.maf.action.requestData(e,d)},lookCovReport:function(a,b){var c=new DataCenter;c.addParameter("excuteTime",b);var d={};d.url=appPath+"/utf/statistic/lookCovReport.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},downLoadReport:function(a,b,c){var d=new DataCenter;d.addParameter("excuteTime",b),d.addParameter("flag",c);var e={};e.url=appPath+"/utf/statistic/downLoadReport.action",e.sync=!1,e.load=a,$.maf.action.requestData(e,d)},doInsertStatisReportRecord:function(a,b){var c={};c.url=appPath+"/utf/statistic/doInsertStatisReportRecord.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)}}}($.ude.rpc),function(a){function b(b){E=b,a.ude.util.pageResize(),a.ude.rpc.statistic.initResources(b,c)}function c(b){if(!b)return void showMessage(a.i18n.prop("testcase.paramjs.init.showSucessMessage"),null,"error");if(1==b.getCode())return void showMessage(b.getDetail(),null,"error");var c=b.getDataStore("statisRecordStore");d(c)}function d(b){w=!1,a("#deleteRecordBtn").bind("click",function(){o()}),a("#createReportBtn").bind("click",function(){l()}),f(b.getRowSet().getData()),a("#statisTable_chk_all").bind("click",function(){e()})}function e(){w?(a("input[name='check']").attr("checked",!1),w=!1):(a("input[name='check']").attr("checked",!0),w=!0)}function f(b){a("#statisTable").udeTable({data:b,columns:[{sTitle:"",mData:"id",sWidth:"5%",mRender:j},{sTitle:a.i18n.prop("statistic.statisjs.init.sceneName"),mData:"sceneIdAll",sWidth:"35%",mRender:function(b,c){var d=b;b.length>30&&(d=b.substring(0,30),d+="...");var e=a("<div title='"+b+"' class='cell-widget' column-index='1'>"+d+"</div>");return a("<div/>").append(e).html()}},{sTitle:a.i18n.prop("statistic.statisjs.init.testReport"),mData:function(b,c,d,e){var f=new Array;return"1|1"==b.ifCovReport?(f.push("<div style='text-align:center;'>"),f.push("<div title ="+a.i18n.prop("statistic.statisjs.init.testCase")+"  class='table-cell-button-item "),f.push("monitor-task-trigger-download"),f.push("' onclick='$.ude.page.statistic.main.downCaseReport()'></div>"),f.push("<div title= "+a.i18n.prop("statistic.statisjs.init.covPage")+" class = 'table-cell-button-item report-lookonline' onclick='$.ude.page.statistic.main.lookCovReport(event)'></div>"),f.push("</div>"),f.join("")):"1|0"==b.ifCovReport?(f.push("<div style='text-align:center;'>"),f.push("<div title= "+a.i18n.prop("statistic.statisjs.init.covPage")+" class = 'table-cell-button-item report-lookonline' onclick='$.ude.page.statistic.main.lookCovReport(event)'></div>"),f.push("<div title ="+a.i18n.prop("statistic.statisjs.init.downLoad")+" class='table-cell-button-item "),f.push("monitor-task-trigger-download"),f.push("' onclick='$.ude.page.statistic.main.downCovReport()'></div>"),f.push("</div>"),f.join("")):"0|1"==b.ifCovReport?(f.push("<div style='text-align:center;'>"),f.push("<div title ="+a.i18n.prop("statistic.statisjs.init.downLoad")+" class='table-cell-button-item "),f.push("monitor-task-trigger-download"),f.push("' onclick='$.ude.page.statistic.main.downCaseReport()'></div>"),f.push("</div>"),f.join("")):void 0},sWidth:"20%"},{sTitle:a.i18n.prop("statistic.statisjs.init.updatePerson"),mData:"updatePerson",sWidth:"20%"},{sTitle:a.i18n.prop("statistic.statisjs.init.updateDate"),mData:"updateDate",sWidth:"20%",mRender:g}]}),a("#statisTable").udeTable().fnSetCheckbox("statisTable")}function g(b){var c=a("<div style='text-align: left;'></div>");return c.text(a.ude.util.dateFormat(b,"yyyy-MM-dd HH:mm:ss")),a("<div>").append(c).html()}function h(b){var c=a("#statisTable").udeTable().fnGetSelectedRowData(),d=c.updateDate,e=function(a){var b=a.getParameter("lookPath");window.open("/utf"+b,"","width=1050,height=565,scrollbars=yes")};a.ude.rpc.statistic.lookCovReport(e,d)}function i(){var b=a("#statisTable").udeTable().fnGetSelectedRowData(),c=b.updateDate,d=function(a){var b=a.getParameter("downLoadPath");window.location.href="/utf"+b};a.ude.rpc.statistic.downLoadReport(d,c,"caseFlag")}function j(b,c){var d=a("<div class='cell-widget' align='center'/>"),e=a("<input type='checkbox' name='check' value='"+b+"'/>");return d.append(e),a("<div/>").append(d).html()}function k(){var b=a("#statisTable").udeTable().fnGetSelectedRowData();if(!b)return void showMessage(a.i18n.prop("testcase.paramjs.init.checkEditParam.showMessage"),null,"error");var c=b.ifCovReport,d=b.updateDate;if("0|1"==c)return void showMessage(a.i18n.prop("testcase.paramjs.init.checkEditParam.showMessage"),null,"error");var e=function(a){var b=a.getParameter("downLoadPath");window.location.href="/utf"+b};a.ude.rpc.statistic.downLoadReport(e,d,"covFlag")}function l(b,c,d){return x=b,y=c,z=d,z="caseFlag"===E?"1|0":"0|1",""==b?(showMessage(a.i18n.prop("statistic.statisjs.init.sceneInfoStr.showMessage"),null,"error"),!1):void a.ude.rpc.statistic.createReport(b,z,m)}function m(b){var c=z.split("|"),d={};d.sceneIdAll=x,d.ifCovReport=c[1],d.ifCaseReport=c[0];var e=new DataCenter,f=new DataStore(u);f.setRowSetName(u),f.getRowSet().addRow(d),e.addDataStore(f),a.ude.rpc.statistic.doInsertStatisReportRecord(e,n)}function n(b){if(b&&"0"==b.getCode()){A=b.getSingleDataStore();var c=z.split("|"),d="";if(C="",B="",D=A.getRowSet().getRow(0).data.updateDate,A.getRowSet().getRow(0).data.ifCovReport=c[1]+"|"+c[0],A.getRowSet().getRow(0).data.sceneIdAll=y,"1"==c[1]){var e=function(b){if(b&&"0"==b.getCode())C="1";else{var e=b.getDetail();C="0",d="0|"+c[0],showMessage(e,null,"error");var f=A.getRowSet().getRow(0).data.id;"0|0"==d?a.ude.rpc.statistic.deleteRecord(f,""):a.ude.rpc.statistic.updateRecord(f,"covFlag","")}"1"!=C||""!=B&&"0"!=B||(w=!1,a("#statisTable").udeTable().fnAddRowToFirst(A.getRowSet().getRow(0).data),a("input[name='statisTable_chk_all']").attr("checked",!1))};a.ude.rpc.statistic.generateReport(x,D,e)}if("1"==c[0]){var f=function(b){if(b&&"0"==b.getCode()){var e=b.getParameter("executeTime");a.ude.rpc.statistic.generateCaseReport(y,D,e),B="1","0"==c[1]?A.getRowSet().getRow(0).data.ifCovReport=c[1]+"|1":""==C?A.getRowSet().getRow(0).data.ifCovReport=c[1]+"|1":A.getRowSet().getRow(0).data.ifCovReport=C+"|1"}else{B="0";var f=(b.getDetail(),A.getRowSet().getRow(0).data.id);d="0"==c[1]?c[1]+"|0":C+"|0","0|0"==d?a.ude.rpc.statistic.deleteRecord(f,""):a.ude.rpc.statistic.updateRecord(f,"caseFlag",""),showMessage(a.i18n.prop("statistic.statisjs.init.caseExport.showMessage"),null,"error")}"1"!=B||"0"!=C&&""!=C||(w=!1,a("#statisTable").udeTable().fnAddRowToFirst(A.getRowSet().getRow(0).data),a("input[name='statisTable_chk_all']").attr("checked",!1))};a.ude.rpc.statistic.createXML(x,D,f)}}else{var g=b.getDetail();showMessage(g,null,"error")}}function o(){var b=a("input[name='check']:checked");if(b.length>0)a(b).each(function(){v.push(this.value)}),a.ude.util.confirm(a.i18n.prop("testcase.paramjs.init.delParam.showMessage"),q);else{var c=a("#statisTable").udeTable().fnGetSelectedRowData();if(deletedUser=c,!c)return void showMessage(a.i18n.prop("testcase.paramjs.init.checkDelParam.showMessage"),null,"error");a.ude.util.confirm(a.i18n.prop("testcase.paramjs.init.delParam.showMessage"),p)}}function p(){var b=a("#statisTable").udeTable().fnGetSelectedRowData();a.ude.rpc.statistic.deleteRecord(b.id,t)}function q(){a.ude.rpc.statistic.deleteRecords(v,r)}function r(b){if(b&&"0"==b.getCode()){for(var c=a("#statisTable").udeTable().fnGetData(),d=new DataStore("recordDataStore",c),e=0;e<v.length;e++)for(var f=0;f<c.length;f++)if(v[e]===c[f].id){d.getRowSet().deleteRow(f);break}s(d.getRowSet().getData()),v.length=0}else{var g=b.getDetail();showMessage(g,null,"error")}}function s(b){w=!1,a("input[name='statisTable_chk_all']").attr("checked",!1),a("#statisTable").udeTable().dataTable().fnClearTable();for(var c=0;c<b.length;c++)a("#statisTable").udeTable().fnAddRow(b[c])}function t(b){if(b&&"0"==b.getCode())a("#statisTable").udeTable().fnDeleteRow();else{var c=b.getDetail();showMessage(c,null,"error")}}a.ude.page.statistic.main={init:b,lookCovReport:h,downCaseReport:i,createReport:l,downCovReport:k};var u="com.neusoft.utf.portal.statistic.entity.StatisReportRecord",v=(a.ude.page.statistic.parameter,new Array),w="",x="",y="",z="",A="",B="",C="",D="",E="";a.ude.page.statistic}(jQuery);