/* All right reserved by Neusoft Co. Ltd. 2016-10-14 09:10:45 */
!function(a){a.scene={getSceneNodes:function(a,b){var c=new DataCenter;c.addParameter("sceneId",a);var d={};d.url=appPath+"/utf/testcase/scenedesign/getSceneNodes.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},getComboBoxDataCommon:function(a,b){var c={};c.url=appPath+"/utf/testcase/scenedesign/getComboBoxDataCommon.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},setSceneNode:function(a,b,c){var d=new DataCenter;d.addParameter("nodeId",a),d.addParameter("operType",b);var e={};e.url=appPath+"/utf/testcase/scenedesign/setSceneNod.action",e.sync=!1,e.load=c,$.maf.action.requestData(e,d)},addSceneNode:function(a,b,c,d,e,f){var g=new DataCenter;g.addParameter("sceneId",a),g.addParameter("nodeId",b),g.addParameter("caseId",c),g.addParameter("paramFileGrop",d),g.addParameter("methodsStr",e);var h={};h.url=appPath+"/utf/testcase/scenedesign/addSceneNode.action",h.sync=!1,h.load=f,$.maf.action.requestData(h,g)},getSceneInfoAndLevel:function(a,b){var c=new DataCenter;c.addParameter("sceneId",a);var d={};d.url=appPath+"/utf/testcase/scenedesign/getSceneInfoAndLevel.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},saveSceneInfoAndLevel:function(a,b,c,d,e){var f=new DataCenter,g=new DataStore(a),h=new DataStore(b);g.setRowSetName(a),h.setRowSetName(b),g.getRowSet().addRow(c),h.getRowSet().addRow(d),f.addDataStore(g),f.addDataStore(h);var i={};i.url=appPath+"/utf/testcase/scenedesign/saveSceneInfoAndLevel.action",i.sync=!1,i.load=e,$.maf.action.requestData(i,f)},deleteScene:function(a,b){var c=new DataCenter;c.addParameter("sceneId",a);var d={};d.url=appPath+"/utf/testcase/scenedesign/deleteScene.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},saveSceneNode:function(a,b){var c={};c.url=appPath+"/utf/testcase/scenedesign/saveSceneNode.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},getCurrentProjectInfo:function(a){var b={};b.url=appPath+"/utf/testcase/scenedesign/getCurrentProjectInfo.action",b.sync=!1,b.load=a,$.maf.action.requestData(b)},getSceneByCaseId:function(a,b){var c=new DataCenter;c.addParameter("caseId",a);var d={};d.url=appPath+"/utf/testcase/scenedesign/getSceneByCaseId.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},setSceneNodeStateByCaseId:function(a,b,c,d){var e=new DataCenter;e.addParameter("caseId",a),e.addParameter("status",b),e.addParameter("sceneId",c);var f={};f.url=appPath+"/utf/testcase/scenedesign/setSceneNodeStateByCaseId.action",f.sync=!1,f.load=d,$.maf.action.requestData(f,e)}}}($.ude.rpc),function(a){function b(){Z="$.ude.page.testcase.appScenedesign.main.",ja=null,da=!0,ea=!1,$="",a("#sceneContentDown").css("height",a("#sceneContent").height()-a(".common-content-top").outerHeight()),a(".tab-content").css("height",a("#sceneContentDown").height()-a(".container").outerHeight()+1),a("#sceneT1").css("height",a(".tab-content").height()),a("#sceneT2").css("height",a(".tab-content").height()),a("#scenePickList").css("height",a(".tab-content").height()),d(),c(),a.ude.rpc.scene.getCurrentProjectInfo(function(a){_=a.getParameter("PROJID"),aa=a.getParameter("TESTKIND"),f()})}function c(){a("#editSceneBtn").bind("click",function(){a.ude.page.testcase.appSceneExec.main.editScene()}),a("#runScenes").bind("click",function(){a.ude.page.testcase.appSceneExec.main.runScene()}),a("#addSceneBtn").bind("click",function(){a.ude.page.testcase.appSceneExec.main.initDownloadSceneButton()}),a("#deleteSceneBtn").bind("click",function(){r()}),a("#deleteSceneNodeBtn").bind("click",function(){var b=a("#scene_ul").find("div.borderdashed");b.length>0?a.ude.util.confirm(a.i18n.prop("testcase.scenedesign.sceneJs.initBindFunction_delete_confirm")+"\uff1f",function(){J(b.parent()[0],"nodeDel")}):showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.initBindFunction_showMessage"),null,"error")}),a("#sceneNodeA").bind("click",function(){a("#deleteSceneBtn").css("display","none"),a("#addSceneNodeBtn").css("display",""),a("#deleteSceneNodeBtn").css("display","")}),a("#sceneListA").bind("click",function(){a("#addSceneBtn").css("display",""),a("#editSceneBtn").css("display",""),a("#deleteSceneBtn").css("display",""),a("#addSceneNodeBtn").css("display","none"),a("#deleteSceneNodeBtn").css("display","none")}),a("#Dialog_saveSceneNode").bind("click",function(){n()}),a("#addMethodToSceneBtn").bind("click",function(){g(),a("#sceneMethodsTbody").append("<tr class='tr' align='center'><td class='td'><input type='checkbox' name='' value='methodSeclect'/></td><td class='td'><input style='width:340px;'  type='text' ></input></td></tr>");var b=a("#sceneMethodsTbody").find("td:last-child").find("input").last();b.udeSelect({}),b.setData(ia)}),a("#deletMethodToSceneBtn").bind("click",function(){var b=m();for(var c in b)b[c]&&a(b[c]).remove();g("del")}),a("#moveupMethodBtn").bind("click",function(){var b=m();1!==b.length?showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.initBindFunction_moveMethod_showMessage"),a("#sceneNodeDialog"),"error"):a(b[0]).prev()[0]?a(b[0]).insertBefore(a(b[0]).prev()):showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.initBindFunction_moveupMethodBtn"),a("#sceneNodeDialog"),"error")}),a("#movedownMethodBtn").bind("click",function(){var b=m();1!==b.length?showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.initBindFunction_moveMethod_showMessage"),a("#sceneNodeDialog"),"error"):a(b[0]).next()[0]?a(b[0]).insertAfter(a(b[0]).next()):showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.initBindFunction_movedownMethodBtn"),a("#sceneNodeDialog"),"error")}),a(".common-buttons-item").unbind("setDisableT").unbind("setDisableF"),a(".common-buttons-item").bind("setDisableT",function(b){var c=b.currentTarget.className;b.currentTarget.className=c.indexOf("-unavailable")<0?c+"-unavailable":c,a(b.currentTarget).attr("disabled","disabled")}).bind("setDisableF",function(b){var c=b.currentTarget.className;b.currentTarget.className=c.replace("-unavailable",""),a(b.currentTarget).removeAttr("disabled")}),a("#scenePickList").pickListSingle({label:"CODENAME",height:a("#scenePickList").height()+"px",width:a("#scenePickList").width()+"px",render:e}),a("#Dialog_paramFileGrop").udeSelect({})}function d(){a("#Dialog_sceneName").prop("maxlength",30),a("#Dialog_paramFile").prop("maxlength",30),a("#Dialog_xmlFile").prop("maxlength",30),a("#Dialog_sceneDesc").prop("maxlength",100),a("#Dialog_saveScene").bind("click",function(){s()}),a("#Dialog_sceneNodeName").prop("maxlength",30),a("#Dialog_paramFileGrop").prop("maxlength",30),a("#Dialog_sceneMethodsDiv").css("height","auto")}function e(b){var c=a("<div/>").append("<div style='margin-left:-10px;margin-top:-4px;width:110%;height:130%' ondblclick="+Z+"sceneDbClick('"+b.CODEVALUE+"') onclick="+Z+"paramEditOpen('"+b.CODEVALUE+"')><a style='text-decoration:underline;float:left;margin-top:4px;margin-left:10px;'  onclick="+Z+"sceneClick(this) codevalue='"+b.CODEVALUE+"' codename='"+b.CODENAME+"'>"+b.CODENAME+"</a><div style='width:20px;height:20px;float:right;margin-top:4px;margin-left:10px;'><div id='"+b.CODEVALUE+"ScCite' class='common-buttons-item opt-associate' title="+a.i18n.prop("testcase.scenedesign.sceneJs.renderPickList")+"></div></div></div>");return c.html()}function f(){a("#sceneNameTitle").children()&&a("#sceneNameTitle").children().remove(),a("#sceneDiv").children()&&a("#sceneDiv").children().remove(),a("#sceneListA").click();var b=_&&"all"!==_?_:"",c={widgetId:"scenePickList",widgetType:"pickListSingle",tableName:"utf_scene_level_t_select_secenInfo",objectName:"",objectValue:"",expandStr:"",condition:b},d=new DataCenter,e=new DataStore("commonDs");e.setRowSetName("commonDs"),e.getRowSet().addRow(c),d.addDataStore(e),a.ude.rpc.scene.getComboBoxDataCommon(d,C)}function g(b){var c=a("#sceneNodeDialog").parent().offset().top,d=a("#sceneNodeDialog").parent().height(),e=document.body.clientHeight,f=e-d-c,g=a("#Dialog_sceneMethodsDiv")[0].scrollHeight,h=a("#Dialog_sceneMethodsDiv")[0].clientHeight,i=g>h;f<30&&("del"!==b||i)?a("#Dialog_sceneMethodsDiv").css("height",a("#Dialog_sceneMethodsDiv").height()):a("#Dialog_sceneMethodsDiv").css("height","auto")}function h(b){b.length>0?a.ude.rpc.scene.getSceneByCaseId(b,F):(ja=null,i())}function i(){a("div[id$='ScCite']").hide();var b=0;for(b=0;ja&&b<ja.length;b++)a("#"+ja[b].sceneId+"ScCite").show()}function j(b,c){return""===$||null===$?void showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.addCaseToScene"),null,"error"):(a("#Dialog_sceneNodeName").val(b.caseName),a("#Dialog_sceneNodeName").data("realVal",b.caseId),a("#Dialog_sceneNodeName").data("rowData",b),a("#Dialog_sceneNodeName").data("addOrUpdate",c),a("#sceneMethodsTbody").children().remove(),a("#Dialog_sceneMethodsDiv").css("height","auto"),"add"===c&&h(b.caseId),a.ude.dialog.open("sceneNodeDialog",{title:"update"===c?a.i18n.prop("testcase.scenedesign.sceneJs.addCaseToScene_update"):a.i18n.prop("testcase.scenedesign.sceneJs.addCaseToScene_add"),width:"500px"}),void l(b))}function k(b,c){a.ude.rpc.scene.setSceneNodeStateByCaseId(b,c,$,function(b){if("1"===b.header.code)return void showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.setSceneNodeStateByCaseId_showMessage"),null,"error");if(b&&b.getDataStore("sceneFlowConfigVList")){var c=b.getDataStore("sceneFlowConfigVList");c.getRowSet().forEach(function(b){var c=b.data,d="";d="0"===c.status?"scene_node_grey":("1"===c.status,"scene_node"),a("#scene_ul").find("#"+c.id).attr("class",d)})}})}function l(b){var c=b.include,d="utf_testcase_arg_define_t4",e=b.caseId+";;"+b.caseId+";;"+$;c&&c.length>0&&(c=c.replace(/,/g,"','"),e=b.caseId+";;"+c+";;"+$,d="utf_testcase_arg_define_t3");var f={widgetId:"Dialog_paramFileGrop",widgetType:"dropdownbox",tableName:d,objectName:"",objectValue:"",expandStr:"",condition:e},g={widgetId:"",widgetType:"methodDs",tableName:"utf_testcase_method_t",objectName:"",objectValue:"",expandStr:"",condition:b.caseId},h=new DataCenter,i=new DataStore("commonDs");i.setRowSetName("commonDs"),i.getRowSet().addRow(f),i.getRowSet().addRow(g),h.addDataStore(i),a.ude.rpc.scene.getComboBoxDataCommon(h,y)}function m(){var b=a("#sceneMethodsTbody").children(),c=[],d=0,e=0;for(e=0;b[e];e++)a(b[e]).find("input")[0].checked===!0&&(c[d++]=b[e]);return c}function n(){var b=a.trim(a("#Dialog_sceneNodeName").val()),c=a("#Dialog_sceneNodeName").data("realVal"),d=a("#Dialog_sceneNodeName").data("addOrUpdate"),e=a("#Dialog_paramFileGrop").udeSelect().getValue();e=""===e?a("#s2id_Dialog_paramFileGrop").find(".select2-chosen").html():e;var f=o();if(f===!1)return void showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.saveSceneNode_showMessage"),a("#sceneNodeDialog"),"error");if("update"===d){var g=a("#Dialog_sceneNodeName").data("rowData");g.caseName=b,g.caseId=c,g.paramGroup=e,g.include=f;var h=new DataCenter,i=new DataStore(ha);i.setRowSetName(ha),i.getRowSet().addRow(g),h.addDataStore(i),a.ude.rpc.scene.saveSceneNode(h,function(b){if(b&&b.getDataStore("sceneFlowConfigV")){var c=b.getDataStore("sceneFlowConfigV"),d=c.getRowSet().getData();if(d.length>0){var e=d[0],f=a("#scene_ul").find("#"+e.id);1===f.length?f.data("nodeData",e):""}}})}else t(c,e,f);a.ude.dialog.close("sceneNodeDialog")}function o(){var b=a("#sceneMethodsTbody").children(),c=0,d="";for(c=0;b[c];c++){var e=a(b[c]).find(".select2-container").udeSelect().getValue();if(!e)return!1;d+=e+","}return d.length>0&&(d=d.substring(0,d.length-1)),d}function p(){var b=a("#scenePickList").pickListSingle("getSourceList");if(b.length>0){var c="";for(var d in b)b[d]&&(c+=b[d].CODEVALUE+"','");return c}if(""!=Y)return Y}function q(){var b=[],c=a("#scenePickList").pickListSingle("getSourceList");if(c.length>0)for(var d in c)b.push({id:c[d].CODEVALUE,name:c[d].CODENAME});return b}function r(){var b=a("#scenePickList").pickListSingle("getSourceList"),c="";for(var d in b)b[d]&&(c+=b[d].CODEVALUE+"','");return c.length>0?(c=c.substring(0,c.length-3),void a.ude.util.confirm(a.i18n.prop("testcase.scenedesign.sceneJs.initBindFunction_delete_confirm")+"\uff1f",function(){a.ude.rpc.scene.deleteScene(c,f)})):void showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.chooseSceneshowMessage"),null,"error")}function s(){var b=a.trim(a("#Dialog_sceneName").val());return b?(ba.xmlFile=a.trim(a("#Dialog_xmlFile").val()),ba.paramFile=a.trim(a("#Dialog_paramFile").val()),ca.sceneName=a.trim(a("#Dialog_sceneName").val()),ca.sceneDesc=a.trim(a("#Dialog_sceneDesc").val()),a.ude.rpc.scene.saveSceneInfoAndLevel(fa,ga,ba,ca,function(b){"0"==b.header.code?(a.ude.dialog.close("sceneDialog"),f()):showMessage(a.i18n.prop(b.header.message.detail),null,"error")}),void 0):(showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.saveSceneInfoAndLevel"),a("#sceneDialog"),"error"),!1)}function t(b,c,d){if(""===$||null===$)return void showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.addSceneNode"),null,"error");var e="",f=a("#scene_ul").find("div.borderdashed");if(f.length>0&&f.data("nodeData"))e=f.data("nodeData").id;else{var g=a("#scene_ul");g.find("li > div").length>0&&(e=g.find("li > div:last").data("nodeData").id)}a.ude.rpc.scene.addSceneNode($,e,b,c,d,E)}function u(b){var c=a(b).attr("codevalue"),d=a(b).attr("codename");c=c,$=c,a("#sceneNodeA").click(),a("#sceneNameTitle").children()&&a("#sceneNameTitle").children().remove(),d&&a("#sceneNameTitle").append("<span>&nbsp;&nbsp;"+a.i18n.prop("testcase.scenedesign.sceneJs.sceneClick")+"\uff1a"+d+"</span>"),a.ude.rpc.scene.getSceneNodes(c,z)}function v(b){a.ude.page.testcase.appSceneExec.main.editScene()}function w(){da=!1,a(".nodeOper").remove(),a("#addSceneBtn").remove(),a("#editSceneBtn").remove(),a("#deleteSceneBtn").remove(),a("#sceneDialog").remove(),a("#deleteSceneNodeBtn").remove(),a("#changeSearchModelBtn").remove(),ja=null,i(),a("#sceneT1").children().remove();var b=.8*a(".tab-content").height();a("#sceneT1").append("<div id='scenePickList' style='width:100%;height:"+b+"px;overflow:visible;'></div>"),a("#scenePickList").pickListSingle({label:"CODENAME",height:a("#scenePickList").height()+"px",width:a("#scenePickList").width()+"px",render:e}),a.ude.rpc.scene.getCurrentProjectInfo(function(a){_=a.getParameter("PROJID"),aa=a.getParameter("TESTKIND"),f()}),a("#sceneT1").append("<div style=''><div style='float:right;'><button id='sceneExec' class='btn btn-success' type='button'>"+a.i18n.prop("testcase.scenedesign.sceneJs.showSceneOnly_sceneExec")+"</button></div></div>"),a("#sceneExec").bind("click",function(){var b=a("#scenePickList").pickListSingle("getSourceList"),c="",d="";for(var e in b)b[e]&&(c+=b[e].CODEVALUE+",",d+=b[e].CODENAME+",");c.length>0&&(c=c.substring(0,c.length-1)),d.length>0&&(d=d.substring(0,d.length-1)),a.ude.page.statistic.main.createReport(c,d,"")})}function x(){da=!1,ea=!0,a(".nodeOper").remove(),a("#addSceneBtn").remove(),a("#editSceneBtn").remove(),a("#deleteSceneBtn").remove(),a("#sceneDialog").remove(),a("#deleteSceneNodeBtn").remove(),a("#changeSearchModelBtn").bind("click",function(){a.ude.util.loadPage(null,appPath+"/utf/testcase/paramManage/menu/search.action",a("#m-content")[0])}),a("#scenePickList").pickListSingle({label:"CODENAME",height:a("#scenePickList").height()+"px",width:a("#scenePickList").width()+"px",render:e,singleSelect:ea})}function y(b){C(b);var c=a("#Dialog_sceneNodeName").data("rowData"),d=c.paramGroup;a("#Dialog_paramFileGrop").udeSelect().setValue(d);var e=a("#Dialog_paramFileGrop").udeSelect().getValue();d&&d.length>0&&""===e&&a("#s2id_Dialog_paramFileGrop").find(".select2-chosen").html(d);var f=c.include,g=[];if(f){g=f.split(",");for(var h=0;h<g.length;h++){a("#addMethodToSceneBtn").click();var i=a("#sceneMethodsTbody").find("td:last-child").find("input").last();i.udeSelect().setValue(g[h])}}}function z(b){if("1"===b.header.code)return void showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.getSceneNodesSuccess"),null,"error");if(b&&b.getDataStore("SFlowList")){J(null,"addsceneDiv");var c=b.getDataStore("SFlowList"),d="-1",e=c.getRowSet().getData();B(e,d),a("#sceneDiv").height("100%"),a("#testcaseInfo").hide(),setTimeout("$.ude.page.testcase.scenedesign.main.firstCaseNodeClick()",500)}}function A(){var b=a("#sceneDiv").find("a.scene_a").first();a(b).click()}function B(a,b){var c,d=b;for(c in a)if(a[c].parentOrderId===d){var e=a[c];e.name=e.caseName,d=e.orderId,J(e,"nodeAdd"),B(a,d);break}}function C(b){if("1"===b.header.code)return void showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.getComboBoxDataCommonSuccess"),null,"error");for(var c in b.getDataStores())if(b.getDataStores()[c]){var d=b.getDataStores()[c],e=d.getParameter("widgetId"),f=d.getParameter("widgetType"),g=a("#"+e),h=d.parameters.data;"dropdownbox"===f?(g.udeSelect().setData(h),a("#s2id_"+e).find(".select2-search-choice-close").show()):"pickListSingle"===f?(g.pickListSingle("redraw",h),i()):"methodDs"===f&&(ia=h)}}function D(b){if("1"===b.header.code)return void showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.setSceneNodeSuccess"),null,"error")}function E(b){if("1"===b.header.code)return void showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.addSceneNodeSuccess"),null,"error");if(b&&b.getDataStore("sceneFlowConfigV")){var c=b.getDataStore("sceneFlowConfigV"),d=c.getRowSet().getData();if(d.length>0){var e=d[0];e.name=e.caseName,J(e,"nodeAdd")}}}function F(b){if("1"===b.header.code)return void showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.getSceneByCaseIdSuccess"),null,"error");if(ja=null,b&&b.getDataStore("SceneLevel")){var c=b.getDataStore("SceneLevel").getRowSet().getData();c.length>0&&(ja=c)}i()}function G(b){if(b){var c=b.operType,d=b.id,e=b.nodeData;if("nodeClick"===c){var f={widgetId:"",widgetType:"methodDs",tableName:"utf_testcase_method_t",objectName:"",objectValue:"",expandStr:"",condition:e.caseId},g=new DataCenter,h=new DataStore("commonDs");h.setRowSetName("commonDs"),h.getRowSet().addRow(f),g.addDataStore(h),a.ude.rpc.scene.getComboBoxDataCommon(g,H),a.ude.page.testcase.caseDesign.main.caseNameOnclickByScene(e.caseId,e.caseName,e.parentCaseId)}else a.ude.rpc.scene.setSceneNode(d,c,D)}}function H(b){var c={};for(var d in b.getDataStores())if(b.getDataStores()[d])for(var e=b.getDataStores()[d],f=e.parameters.data,g=0;g<f.length;g++)c[f[g].CODEVALUE]=f[g].CODENAME;var h=a("#scene_ul").find("div.borderdashed"),i=(a("#scene_ul").find("div.borderdashed").parent(),h.data("nodeData")),j=i.include,k=(new Array,"");if(j&&j.length>0)for(var l=j.split(","),m=0;m<l.length;m++)k=k+c[l[m]]+"<br/>";a("#testcaseInfo").html("<table width='100%'><tr><td width='30%' style='vertical-align:top'>"+a.i18n.prop("testcase.scenedesign.sceneJs.testcasename")+":</td><td width='70%' style='vertical-align:top'>"+i.caseName+"</td></tr><tr><td style='vertical-align:top'>"+a.i18n.prop("testcase.scenedesign.sceneJs.paramgroup")+":</td><td style='vertical-align:top'>"+i.paramGroup+"</td></tr><tr><td style='vertical-align:top'>"+a.i18n.prop("testcase.scenedesign.sceneJs.includemethod")+":</td><td style='vertical-align:top'>"+k+"</td></tr></table>"),a("#testcaseInfo").is(":hidden")&&(a("#sceneDiv").height("70%"),a("#testcaseInfo").show());for(var n=a("#caseTable").udeTable().fnGetData(),d=0;d<n.length;d++)if(n[d].caseId==i.caseId){a("#caseTable").udeTable().fnSelectRowByIndex(d),a("#caseTable").udeTable().fnScrollToSelectedRow();var f=a("#caseTable").udeTable().fnGetSelectedRowData(),o=a("#caseTable").udeTable().data("onClick");o(f),setTimeout(function(){I(i.paramGroup)},1e3);break}}function I(b){a("#paramGroupSelect").udeSelect().setValue(b);var c=a("#methodTable").udeTable().fnGetSelectedRowData(),d=a.ude.page.testcase.caseDesign.main.getCurrentScene();a.ude.rpc.testcaseeditrpc.getEventByMethodId(a.ude.page.testcase.caseDesign.eventjs.getEventByMethodIdSuccess,c.methodId,d,b)}function J(a,b){"nodeDel"===b&&R(a),"nodeAdd"===b&&T(a),"addsceneDiv"===b&&W(a)}function K(){var b=a("#scene_ul").find("div.borderdashed"),c=b.data("nodeData");return b.length>0&&c?c:null}function L(){a("#scene_ul").find("div").removeClass("borderdashed")}function M(b){var c=a(b.currentTarget).parent().parent().parent();b.stopPropagation(),N(c)}function N(b){var c=b.prev(),d=b.prev().prev();if(c.length>0&&d.length>0){Q(d,b);var e={id:d.find("div:first").data("nodeData").id,operType:"nodeDown"};G(e)}a("#scene_ul").find(".nodeOper").css("display","none")}function O(b){var c=a(b.currentTarget).parent().parent().parent();b.stopPropagation(),P(c)}function P(b){var c=b.next(),d=b.next().next();if(c.length>0&&d.length>0){Q(b,d);var e={id:b.find("div:first").data("nodeData").id,operType:"nodeDown"};G(e)}a("#scene_ul").find(".nodeOper").css("display","none")}function Q(a,b){var c=a.next(),d=b.prev();b.insertBefore(c),a.insertAfter(d)}function R(){var b=a("#scene_ul").find("div.borderdashed"),c=a("#scene_ul").find("div.borderdashed").parent(),d=b.data("nodeData"),e=c.next(),f=c.prev();if(c.remove(),"scene_line"===e.find("div:first").attr("class")?e.remove():"scene_line"===f.find("div:first").attr("class")&&f.remove(),d){var g={id:d.id,operType:"nodeDel"};G(g)}}function S(b){a(b.currentTarget).focus(),"mouseover"===b.type?a(b.currentTarget).find(".nodeOper").css("display","block"):"mouseout"===b.type&&a(b.currentTarget).find(".nodeOper").css("display","none")}function T(b){var c=a("#scene_ul"),d=a("<li></li>").append("<div class='scene_line'></div>"),e=a("<li></li>"),f="scene_node",g="nodeOper",h="scene_a",i="exclamation";"1"===b.status?f="scene_node":"0"===b.status&&(f="scene_node_grey"),"2"===b.status&&(i="exclamation exclamationBg",f="scene_node"),null!==b.name&&""!==b.name||(b.name=a.i18n.prop("testcase.scenedesign.sceneJs.nodeAdd"));var j=b.name,k="";b.name.length>6&&(j=b.name.substring(0,6)+"...",k=b.name);var l=a("<div>",{id:b.id,class:f,click:U,mouseover:S,mouseout:S}).append("<a class='"+h+"'>"+j+"</a>").append("<div class = '"+i+"'/>");l.data("nodeData",b);var m=a("<div class = '"+g+"' style='display:none' />").append(a("<div>",{class:"nodeUp",click:M})).append(a("<div>",{class:"nodeDown",click:O}));da&&l.append(m),e.append(l);var n=a("#scene_ul").find("div.borderdashed").parent();1===n.length?(n.after(e),n.after(d)):c.children().length>0?(c.append(d),c.append(e)):c.append(e)}function U(b){if(ea){var c=a("#caseParamTabChangedFlag").val();if("true"==c)a.ude.util.confirm(a.i18n.prop("testcase.paramjs.init.isSaveParam"),a.ude.page.testcase.paramManage.main.saveParam,function(){a("#scene_ul").find("div").removeClass("borderdashed"),a(b.currentTarget).addClass("borderdashed"),b.stopPropagation();var c=a(b.currentTarget).data("nodeData");a.ude.rpc.param.getParam("",c.caseId,c.caseName,a.ude.page.testcase.paramManage.main.getCaseParamSuccess)});else{a("#scene_ul").find("div").removeClass("borderdashed"),a(b.currentTarget).addClass("borderdashed"),b.stopPropagation();var d=a(b.currentTarget).data("nodeData");a.ude.rpc.param.getParam("",d.caseId,d.caseName,a.ude.page.testcase.paramManage.main.getCaseParamSuccess)}}else V(b)}function V(b){a("#scene_ul").find("div").removeClass("borderdashed"),a(b.currentTarget).addClass("borderdashed"),b.stopPropagation();var c=a(b.currentTarget).data("nodeData"),d={id:b.currentTarget.id,operType:"nodeClick",nodeData:c};return G(d),c}function W(b){a("#sceneDiv").children().remove();var c=a("<ul id='scene_ul'></ul>");if(a("#sceneDiv").append(c),b)for(var d=0;d<b.length;d++){var e=b[d];e&&J(e,"nodeAdd")}}function X(b){ea&&(a("#sceneNameTitle").children()&&a("#sceneNameTitle").children().remove(),a("#sceneDiv").empty(),a("#sceneDiv").height("100%"),a("#testcaseInfo").hide(),a.ude.rpc.param.getParam(b,"","",a.ude.page.testcase.paramManage.main.getSceneParamSuccess))}a.ude.page.testcase.appScenedesign.main={init:b,sceneClick:u,sceneDbClick:v,paramEditOpen:X,showSceneOnly:w,showSceneForParam:x,addCaseToScene:j,getSceneByCaseId:h,getCurrentNode:K,clearnCurrentNode:L,setSceneNodeStateByCaseId:k,firstCaseNodeClick:A,saveSceneInfoAndLevel:s,getComboBoxDataCommon:f,findSceneName:p,findAllSelectedScenes:q};var Y="",Z="",$="",_="",aa="",ba={},ca={},da=!0,ea=!1,fa="com.neusoft.utf.portal.common.entity.SceneInfo",ga="com.neusoft.utf.portal.common.entity.SceneLevel",ha="com.neusoft.utf.portal.common.entity.SceneFlowConfig",ia=null,ja=[]}(jQuery);