/* All right reserved by Neusoft Co. Ltd. 2016-10-14 09:10:03 */
!function(a){function b(){return a("<div/>")}var c=Math.abs,d=Math.max,e=Math.min,f=Math.round;a.imgAreaSelect=function(g,h){function i(a){return a+qa.left-ra.left}function j(a){return a+qa.top-ra.top}function k(a){return a-qa.left+ra.left}function l(a){return a-qa.top+ra.top}function m(a){return a.pageX-ra.left}function n(a){return a.pageY-ra.top}function o(a){var b=a||S,c=a||T;return{x1:f(ua.x1*b),y1:f(ua.y1*c),x2:f(ua.x2*b),y2:f(ua.y2*c),width:f(ua.x2*b)-f(ua.x1*b),height:f(ua.y2*c)-f(ua.y1*c)}}function p(a,b,c,d,e){var g=e||S,h=e||T;ua={x1:f(a/g||0),y1:f(b/h||0),x2:f(c/g||0),y2:f(d/h||0)},ua.width=ua.x2-ua.x1,ua.height=ua.y2-ua.y1}function q(){J&&ka.width()&&(qa={left:f(ka.offset().left),top:f(ka.offset().top)},N=ka.innerWidth(),O=ka.innerHeight(),qa.top+=ka.outerHeight()-O>>1,qa.left+=ka.outerWidth()-N>>1,V=f(h.minWidth/S)||0,W=f(h.minHeight/T)||0,X=f(e(h.maxWidth/S||1<<24,N)),Y=f(e(h.maxHeight/T||1<<24,O)),"1.3.2"!=a().jquery||"fixed"!=ta||va.getBoundingClientRect||(qa.top+=d(document.body.scrollTop,va.scrollTop),qa.left+=d(document.body.scrollLeft,va.scrollLeft)),ra=/absolute|relative/.test(P.css("position"))?{left:f(P.offset().left)-P.scrollLeft(),top:f(P.offset().top)-P.scrollTop()}:"fixed"==ta?{left:a(document).scrollLeft(),top:a(document).scrollTop()}:{left:0,top:0},L=i(0),M=j(0),(ua.x2>N||ua.y2>O)&&y())}function r(b){if($){switch(la.css({left:i(ua.x1),top:j(ua.y1)}).add(ma).width(ha=ua.width).height(ia=ua.height),ma.add(na).add(pa).css({left:0,top:0}),na.width(d(ha-na.outerWidth()+na.innerWidth(),0)).height(d(ia-na.outerHeight()+na.innerHeight(),0)),a(oa[0]).css({left:L,top:M,width:ua.x1,height:O}),a(oa[1]).css({left:L+ua.x1,top:M,width:ha,height:ua.y1}),a(oa[2]).css({left:L+ua.x2,top:M,width:N-ua.x2,height:O}),a(oa[3]).css({left:L+ua.x1,top:M+ua.y2,width:ha,height:O-ua.y2}),ha-=pa.outerWidth(),ia-=pa.outerHeight(),pa.length){case 8:a(pa[4]).css({left:ha>>1}),a(pa[5]).css({left:ha,top:ia>>1}),a(pa[6]).css({left:ha>>1,top:ia}),a(pa[7]).css({top:ia>>1});case 4:pa.slice(1,3).css({left:ha}),pa.slice(2,4).css({top:ia})}b!==!1&&(a.imgAreaSelect.onKeyPress!=xa&&a(document).unbind(a.imgAreaSelect.keyPress,a.imgAreaSelect.onKeyPress),h.keys&&a(document)[a.imgAreaSelect.keyPress](a.imgAreaSelect.onKeyPress=xa)),ya&&na.outerWidth()-na.innerWidth()==2&&(na.css("margin",0),setTimeout(function(){na.css("margin","auto")},0))}}function s(a){q(),r(a),_=i(ua.x1),aa=j(ua.y1),ba=i(ua.x2),ca=j(ua.y2)}function t(a,b){h.fadeSpeed?a.fadeOut(h.fadeSpeed,b):a.hide()}function u(a){var b=k(m(a))-ua.x1,c=l(n(a))-ua.y1;ja||(q(),ja=!0,la.one("mouseout",function(){ja=!1})),U="",h.resizable&&(c<=h.resizeMargin?U="n":c>=ua.height-h.resizeMargin&&(U="s"),b<=h.resizeMargin?U+="w":b>=ua.width-h.resizeMargin&&(U+="e")),la.css("cursor",U?U+"-resize":h.movable?"move":""),K&&K.toggle()}function v(b){a("body").css("cursor",""),(h.autoHide||ua.width*ua.height==0)&&t(la.add(oa),function(){a(this).hide()}),a(document).unbind("mousemove",z),la.mousemove(u),h.onSelectEnd(g,o())}function w(b){return 1==b.which&&(q(),U?(a("body").css("cursor",U+"-resize"),_=i(ua[/w/.test(U)?"x2":"x1"]),aa=j(ua[/n/.test(U)?"y2":"y1"]),a(document).mousemove(z).one("mouseup",v),la.unbind("mousemove",u)):h.movable?(Q=L+ua.x1-m(b),R=M+ua.y1-n(b),la.unbind("mousemove",u),a(document).mousemove(B).one("mouseup",function(){h.onSelectEnd(g,o()),a(document).unbind("mousemove",B),la.mousemove(u)})):ka.mousedown(b),!1)}function x(a){Z&&(a?(ba=d(L,e(L+N,_+c(ca-aa)*Z*(ba>_||-1))),ca=f(d(M,e(M+O,aa+c(ba-_)/Z*(ca>aa||-1)))),ba=f(ba)):(ca=d(M,e(M+O,aa+c(ba-_)/Z*(ca>aa||-1))),ba=f(d(L,e(L+N,_+c(ca-aa)*Z*(ba>_||-1)))),ca=f(ca)))}function y(){_=e(_,L+N),aa=e(aa,M+O),c(ba-_)<V&&(ba=_-V*(ba<_||-1),ba<L?_=L+V:ba>L+N&&(_=L+N-V)),c(ca-aa)<W&&(ca=aa-W*(ca<aa||-1),ca<M?aa=M+W:ca>M+O&&(aa=M+O-W)),ba=d(L,e(ba,L+N)),ca=d(M,e(ca,M+O)),x(c(ba-_)<c(ca-aa)*Z),c(ba-_)>X&&(ba=_-X*(ba<_||-1),x()),c(ca-aa)>Y&&(ca=aa-Y*(ca<aa||-1),x(!0)),ua={x1:k(e(_,ba)),x2:k(d(_,ba)),y1:l(e(aa,ca)),y2:l(d(aa,ca)),width:c(ba-_),height:c(ca-aa)},r(),h.onSelectChange(g,o())}function z(a){return ba=/w|e|^$/.test(U)||Z?m(a):i(ua.x2),ca=/n|s|^$/.test(U)||Z?n(a):j(ua.y2),y(),!1}function A(b,c){ba=(_=b)+ua.width,ca=(aa=c)+ua.height,a.extend(ua,{x1:k(_),y1:l(aa),x2:k(ba),y2:l(ca)}),r(),h.onSelectChange(g,o())}function B(a){return _=d(L,e(Q+m(a),L+N-ua.width)),aa=d(M,e(R+n(a),M+O-ua.height)),A(_,aa),a.preventDefault(),!1}function C(){a(document).unbind("mousemove",C),q(),ba=_,ca=aa,y(),U="",oa.is(":visible")||la.add(oa).hide().fadeIn(h.fadeSpeed||0),$=!0,a(document).unbind("mouseup",D).mousemove(z).one("mouseup",v),la.unbind("mousemove",u),h.onSelectStart(g,o())}function D(){a(document).unbind("mousemove",C).unbind("mouseup",D),t(la.add(oa)),p(k(_),l(aa),k(_),l(aa)),this instanceof a.imgAreaSelect||(h.onSelectChange(g,o()),h.onSelectEnd(g,o()))}function E(b){return 1==b.which&&!oa.is(":animated")&&(q(),Q=_=m(b),R=aa=n(b),a(document).mousemove(C).mouseup(D),!1)}function F(){s(!1)}function G(){J=!0,I(h=a.extend({classPrefix:"imgareaselect",movable:!0,parent:"body",resizable:!0,resizeMargin:10,onInit:function(){},onSelectStart:function(){},onSelectChange:function(){},onSelectEnd:function(){}},h)),la.add(oa).css({visibility:""}),h.show&&($=!0,q(),r(),la.add(oa).hide().fadeIn(h.fadeSpeed||0)),setTimeout(function(){h.onInit(g,o())},0)}function H(a,b){for(var c in b)void 0!==h[c]&&a.css(b[c],h[c])}function I(c){if(c.parent&&(P=a(c.parent)).append(la.add(oa)),a.extend(h,c),q(),null!=c.handles){for(pa.remove(),pa=a([]),fa=c.handles?"corners"==c.handles?4:8:0;fa--;)pa=pa.add(b());pa.addClass(h.classPrefix+"-handle").css({position:"absolute",fontSize:0,zIndex:sa+1||1}),!parseInt(pa.css("width"))>=0&&pa.width(5).height(5),(ga=h.borderWidth)&&pa.css({borderWidth:ga,borderStyle:"solid"}),H(pa,{borderColor1:"border-color",borderColor2:"background-color",borderOpacity:"opacity"})}for(S=h.imageWidth/N||1,T=h.imageHeight/O||1,null!=c.x1&&(p(c.x1,c.y1,c.x2,c.y2),c.show=!c.hide),c.keys&&(h.keys=a.extend({shift:1,ctrl:"resize"},c.keys)),oa.addClass(h.classPrefix+"-outer"),ma.addClass(h.classPrefix+"-selection"),fa=0;fa++<4;)a(na[fa-1]).addClass(h.classPrefix+"-border"+fa);H(ma,{selectionColor:"background-color",selectionOpacity:"opacity"}),H(na,{borderOpacity:"opacity",borderWidth:"border-width"}),H(oa,{outerColor:"background-color",outerOpacity:"opacity"}),(ga=h.borderColor1)&&a(na[0]).css({borderStyle:"solid",borderColor:ga}),(ga=h.borderColor2)&&a(na[1]).css({borderStyle:"dashed",borderColor:ga}),la.append(ma.add(na).add(K)).append(pa),ya&&((ga=(oa.css("filter")||"").match(/opacity=(\d+)/))&&oa.css("opacity",ga[1]/100),(ga=(na.css("filter")||"").match(/opacity=(\d+)/))&&na.css("opacity",ga[1]/100)),c.hide?t(la.add(oa)):c.show&&J&&($=!0,la.add(oa).fadeIn(h.fadeSpeed||0),s()),Z=(ea=(h.aspectRatio||"").split(/:/))[0]/ea[1],ka.add(oa).unbind("mousedown",E),h.disable||h.enable===!1?(la.unbind("mousemove",u).unbind("mousedown",w),a(window).unbind("resize",F)):((h.enable||h.disable===!1)&&((h.resizable||h.movable)&&la.mousemove(u).mousedown(w),a(window).resize(F)),h.persistent||ka.add(oa).mousedown(E)),h.enable=h.disable=void 0}var J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka=a(g),la=b(),ma=b(),na=b().add(b()).add(b()).add(b()),oa=b().add(b()).add(b()).add(b()),pa=a([]),qa={left:0,top:0},ra={left:0,top:0},sa=0,ta="absolute",ua={x1:0,y1:0,x2:0,y2:0,width:0,height:0},va=document.documentElement,wa=navigator.userAgent,xa=function(a){var b,c,f=h.keys,g=a.keyCode;if(b=isNaN(f.alt)||!a.altKey&&!a.originalEvent.altKey?!isNaN(f.ctrl)&&a.ctrlKey?f.ctrl:!isNaN(f.shift)&&a.shiftKey?f.shift:isNaN(f.arrows)?10:f.arrows:f.alt,"resize"==f.arrows||"resize"==f.shift&&a.shiftKey||"resize"==f.ctrl&&a.ctrlKey||"resize"==f.alt&&(a.altKey||a.originalEvent.altKey)){switch(g){case 37:b=-b;case 39:c=d(_,ba),_=e(_,ba),ba=d(c+b,_),x();break;case 38:b=-b;case 40:c=d(aa,ca),aa=e(aa,ca),ca=d(c+b,aa),x(!0);break;default:return}y()}else switch(_=e(_,ba),aa=e(aa,ca),g){case 37:A(d(_-b,L),aa);break;case 38:A(_,d(aa-b,M));break;case 39:A(_+e(b,N-k(ba)),aa);break;case 40:A(_,aa+e(b,O-l(ca)));break;default:return}return!1};this.remove=function(){I({disable:!0}),la.add(oa).remove()},this.getOptions=function(){return h},this.setOptions=I,this.getSelection=o,this.setSelection=p,this.cancelSelection=D,this.update=s;var ya=(/msie ([\w.]+)/i.exec(wa)||[])[1],za=/opera/i.test(wa),Aa=/webkit/i.test(wa)&&!/chrome/i.test(wa);for(da=ka;da.length;)sa=d(sa,isNaN(da.css("z-index"))?sa:da.css("z-index")),"fixed"==da.css("position")&&(ta="fixed"),da=da.parent(":not(body)");sa=h.zIndex||sa,ya&&ka.attr("unselectable","on"),a.imgAreaSelect.keyPress=ya||Aa?"keydown":"keypress",za&&(K=b().css({width:"100%",height:"100%",position:"absolute",zIndex:sa+2||2})),la.add(oa).css({visibility:"hidden",position:ta,overflow:"hidden",zIndex:sa||"0"}),la.css({zIndex:sa+2||2}),ma.add(na).css({position:"absolute",fontSize:0}),g.complete||"complete"==g.readyState||!ka.is("img")?G():ka.one("load",G),!J&&ya&&ya>=7&&(g.src=g.src)},a.fn.imgAreaSelect=function(b){return b=b||{},this.each(function(){a(this).data("imgAreaSelect")?b.remove?(a(this).data("imgAreaSelect").remove(),a(this).removeData("imgAreaSelect")):a(this).data("imgAreaSelect").setOptions(b):b.remove||(void 0===b.enable&&void 0===b.disable&&(b.enable=!0),a(this).data("imgAreaSelect",new a.imgAreaSelect(this,b)))}),b.instance?a(this).data("imgAreaSelect"):this}}(jQuery),function(a){a.testcaseRpc={initResources:function(a,b,c){var d=new DataCenter;d.addParameter("parentCaseId",b),d.addParameter("pageType",c);var e={};e.url=appPath+"/utf/testcase/caseDesign/caseGrid/initUserPage.action",e.sync=!1,e.load=a,$.maf.action.requestData(e,d)},addUser:function(a,b){var c={};c.url=appPath+"/utf/testcase/caseDesign/caseGrid/addUser.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},editUser:function(a,b){var c={};c.url=appPath+"/utf/testcase/caseDesign/caseGrid/editUser.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},deleteUser:function(a,b){var c=new DataCenter;c.addParameter("id",a);var d={};d.url=appPath+"/utf/testcase/caseDesign/caseGrid/deleteUser.action",d.load=b,$.maf.action.requestData(d,c)},testCaseRepeat:function(a,b){var c=new DataCenter;c.addParameter("id",a);var d={};d.url=appPath+"/utf/testcase/caseDesign/caseGrid/testCaseRepeat.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},getIncludeFrame:function(a){var b=new DataCenter,c={};c.url=appPath+"/utf/testcase/caseDesign/caseGrid/getIncludeFrame.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},getAppiumSession:function(a){var b=new DataCenter,c={};c.url=appPath+"/utf/testcase/caseDesign/caseGrid/getAppiumSession.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},refreshImage:function(a,b){var c=new DataCenter;c.addParameter("appiumSessionId",a);var d={};d.url=appPath+"/utf/testcase/caseDesign/caseGrid/refreshImage.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},installApp:function(a,b){var c=new DataCenter;c.addParameter("host",a);var d={};d.url=appPath+"/utf/testcase/caseDesign/caseGrid/installApp.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},saveObject:function(a,b){var c={};c.url=appPath+"/utf/testcase/caseDesign/caseGrid/saveObject.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},saveImage:function(a,b,c,d){var e=new DataCenter;e.addParameter("menuId",a),e.addParameter("appImageHidden",b),e.addParameter("appDomXmlHidden",c);var f={};f.url=appPath+"/utf/testcase/caseDesign/caseGrid/saveImage.action",f.sync=!1,f.load=d,$.maf.action.requestData(f,e)},getSavedImage:function(a,b){var c=new DataCenter;c.addParameter("menuId",a);var d={};d.url=appPath+"/utf/testcase/caseDesign/caseGrid/getSavedImage.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},execScript:function(a,b,c,d,e,f){var g=new DataCenter;g.addParameter("appiumSessionId",a),g.addParameter("selector",b),g.addParameter("action",c),g.addParameter("waitTime",e),g.addParameter("scriptValue",d);var h={};h.url=appPath+"/utf/testcase/caseDesign/caseGrid/execScript.action",h.sync=!1,h.load=f,$.maf.action.requestData(h,g)}}}($.ude.rpc),function(a){function b(){a.ude.util.pageResize(),Ea=null,a.ude.rpc.testcaseRpc.getIncludeFrame(function(b){if(b&&b.getDataStore("utfProjectInfoTResult")){var c=b.getDataStore("utfProjectInfoTResult");if(c.getRowSet().getRowCount()>0){var d=c.getRowSet().getRow(0).data;Ea="1"!==d.perserve01,Ea===!1?(a("#includeFrameMethodFrame").hide(),a("#includeFrameEventFrame").hide(),a("#methodDefaultframe").hide(),a("#includeFrameMethodDefaultframe").hide()):(a("#includeFrameMethodFrame").show(),a("#includeFrameEventFrame").show(),a("#methodDefaultframe").show(),a("#includeFrameMethodDefaultframe").show()),a.ude.page.testcase.caseDesign.methodjs.initMethodTableForgetIncludeFrame(Ea),a("#caseList").show(),a("#caseEdit").hide()}}}),Y(),U(),a.ude.page.config.projectStructure.main.udeTreeClick(function(){a.ude.page.testcase.scenedesign.main.getSceneByCaseId(""),ya=a.ude.page.config.projectStructure.main.treeAttribution(),na(ya.ismenu,""),za=ya.menuId,Ca=ya.ismenu,a("#pageObjectDiv").length>0?(a("#pageObjectTable").udeTable().dataTable().fnClearTable(),"childPage"!==ya.pageType&&a("#caseTable").udeTable().dataTable().fnClearTable()):a("#caseTable").udeTable().dataTable().fnClearTable(),a("#addCaseBtn").trigger("setDisableT"),a("#addCaseToScene").trigger("setDisableT"),a("#editCaseBtn").trigger("setDisableT"),a("#deleteCaseBtn").trigger("setDisableT"),Ba="","pageMenu"===ya.pageType||"childPage"===ya.pageType?(Aa=a.ude.page.config.projectStructure.main.treeNodeNamePath(),a("#addCaseBtn").trigger("setDisableF"),a("#addCaseToScene").trigger("setDisableF"),a("#editCaseBtn").trigger("setDisableF"),a("#deleteCaseBtn").trigger("setDisableF"),a("#pageObjectDiv").length>0&&(a("#syncObject").trigger("setDisableF"),a("#manualPageObjectTab").attr("class").indexOf("active")!=-1?(a("#addPageObject").trigger("setDisableF"),a("#editPageObject").trigger("setDisableF"),a("#saveObject").trigger("setDisableT")):(a("#addPageObject").trigger("setDisableT"),a("#editPageObject").trigger("setDisableT"),a("#saveObject").trigger("setDisableF")),a("#deletePageObject").trigger("setDisableF"),a("#saveImage").trigger("setDisableF")),Ba="'"+ya.menuId+"'"+la(ya,Ba),a.ude.rpc.testcaseRpc.initResources(e,Ba,Ca),a("#addCaseBtn").attr("title",a.i18n.prop("testcase.casejs.init.addCaseBtn"))):ya.parentMenuId&&"-1"!==ya.parentMenuId?(a("#addCaseBtn").trigger("setDisableT"),a("#addCaseToScene").trigger("setDisableF"),a("#editCaseBtn").trigger("setDisableF"),a("#deleteCaseBtn").trigger("setDisableF"),a("#pageObjectDiv").length>0&&(a("#syncObject").trigger("setDisableF"),a("#manualPageObjectTab").attr("class").indexOf("active")!=-1?(a("#addPageObject").trigger("setDisableF"),a("#editPageObject").trigger("setDisableF"),a("#saveObject").trigger("setDisableT")):(a("#addPageObject").trigger("setDisableT"),a("#editPageObject").trigger("setDisableT"),a("#saveObject").trigger("setDisableF")),a("#deletePageObject").trigger("setDisableF"),a("#saveImage").trigger("setDisableF")),a("#caseTable").udeTable().dataTable().fnClearTable(),Ba="'"+la(ya,Ba).substring(2),"'"===Ba?(a("#pageObjectDiv").length>0&&a("#pageObjectTable").udeTable().dataTable().fnClearTable(),a("#caseTable").udeTable().dataTable().fnClearTable()):a.ude.rpc.testcaseRpc.initResources(e,Ba,Ca),a("#addCaseBtn").attr("title",a.i18n.prop("testcase.casejs.init.addCaseBtnT"))):ya.parentMenuId&&"-1"!==ya.parentMenuId||(a("#addCaseBtn").trigger("setDisableT"),a("#addCaseToScene").trigger("setDisableT"),a("#editCaseBtn").trigger("setDisableT"),a("#deleteCaseBtn").trigger("setDisableT"),a("#pageObjectDiv").length>0&&(a("#syncObject").trigger("setDisableT"),a("#addPageObject").trigger("setDisableT"),a("#editPageObject").trigger("setDisableT"),a("#deletePageObject").trigger("setDisableT"),a("#saveObject").trigger("setDisableT"),a("#saveImage").trigger("setDisableT")),a("#addCaseBtn").attr("title",a.i18n.prop("testcase.casejs.init.addCaseBtnT"))),a("#pageObjectDiv").length>0?"childPage"!==ya.pageType&&(a("#caseList").show(),a("#caseEdit").hide()):(a("#caseList").show(),a("#caseEdit").hide())}),a.ude.page.config.projectStructure.main.udeTabClick(function(){a("#pageObjectDiv").length>0||(a("#caseList").show(),a("#caseEdit").hide(),a("#pageObjectDiv").length>0&&a("#pageObjectTable").udeTable().dataTable().fnClearTable(),a("#caseTable").udeTable().dataTable().fnClearTable(),a("#addCaseBtn").trigger("setDisableT"),a("#addCaseToScene").trigger("setDisableT"),a("#editCaseBtn").trigger("setDisableT"),a("#deleteCaseBtn").trigger("setDisableT"),a("#addCaseBtn").attr("title",a.i18n.prop("testcase.casejs.init.addCaseBtnT")))}),d(),k(),a("#addCaseBtn").attr("title",a.i18n.prop("testcase.casejs.init.addCaseBtnT"))}function c(){a.ude.rpc.testcaseRpc.initResources(e,Ba,Ca),a("#caseList").show(),a("#caseEdit").hide(),na(ya.ismenu,"")}function d(){a.ude.pageResizeHandler=function(){a.ude.util.pageResize(),a("#caseTable").udeTable().fnResize(),a("#caseEditMethodDown").css("height",a("#caseEditMethod").height()-a(".common-content-top").outerHeight()-4),a("#caseEditEventDown").css("height",a("#caseEditEvent").height()-a(".common-content-top").outerHeight()-1)}}function e(b){if(!b)return void showMessage("\u521d\u59cb\u5316\u5931\u8d25\u3002",null,"error");if("1"===b.getCode())return void showMessage(b.getDetail(),null,"error");if(a("#pageObjectDiv").length>0){var c=function(b){a("#pageObjectTable").udeTable().dataTable().fnClearTable(),a("#pageObjectTableM").udeTable().dataTable().fnClearTable();for(var c=b.getDataStore(sa).getRowSet().getData(),d=new Array,e=new Array,f=0;f<c.length;f++)"auto"==c[f].analyseKind?e.push(c[f]):d.push(c[f]);a("#pageObjectTable").udeTable().fnRedraw(e),a("#pageObjectTable").udeTable().fnResize(),a("#pageObjectTableM").udeTable().fnRedraw(d),a("#pageObjectTableM").udeTable().fnResize(),i()};h(c),a("#caseMoreConfigTr").hide(),a("#methodMoreConfigTr").hide(),a("#initMenuCheckTr").hide()}var d=b.getDataStore("caseStore"),e=a.ude.page.config.projectStructure.main.treeAttribution();a("#pageObjectDiv").length>0?("childPage"!==e.pageType||Da)&&X(d.getRowSet().getData()):X(d.getRowSet().getData())}function f(){La?(a("input[name='check']").attr("checked",!1),La=!1):(a("input[name='check']").attr("checked",!0),La=!0)}function g(){Ma?(a("input[name='checkM']").attr("checked",!1),Ma=!1):(a("input[name='checkM']").attr("checked",!0),Ma=!0)}function h(b){var c=new DataCenter,d=new DataStore(ra);d.setRowSetName(ra);var e=a.ude.page.config.projectStructure.main.treeAttribution(),f=e.menuId,g=e.ismenu;c.addParameter("caseId",f),c.addParameter("pageType",g),d.getRowSet().addRow(e),c.addDataStore(d),a.ude.rpc.pageObject.getPageElement(c,b)}function i(){var b=a.ude.page.config.projectStructure.main.treeAttribution(),c=b.menuId;a.ude.rpc.testcaseRpc.getSavedImage(c,j)}function j(b){if(b&&"0"===b.getCode()){var c=b.getParameter("imageStream");b.getParameter("domXml");Ha=b.getParameter("height"),Ia=b.getParameter("width");var d=Ha*Ua/Ia;c&&""!=c?a("#savedAppImage").attr("src","data:image/png;base64,"+c):a("#savedAppImage").attr("src",""),a("#savedAppImage").height(d),a("#savedAppImage").width(Ua);var e=b.getDataStore("targetHotSpotNodes");a("#savedhotspot-container").html(""),e.getRowSet().forEach(function(b){var c=b.getItemValue("bounds"),e=b.getItemValue("nodeId");e="saved::"+e;var f=c.replace("][",",").replace("[","").replace("]",""),g=f.split(","),h=Ua*g[0]/Ia,i=d*g[1]/Ha,j=(g[2]-g[0])*Ua/Ia,k=(g[3]-g[1])*d/Ha,l="top:"+i+"px;left:"+h+"px;height:"+k+"px;width:"+j+"px;",m="<li><a href='javascript:void(0)'><span class='hotspot' style='"+l+"' id='"+e+"'></span></a></li>";a("#savedhotspot-container").append(m)})}else{var f=b.getDetail();showMessage(f,null,"error")}}function k(){a("#addCaseBtn").bind("click",function(b){a("#addCaseBtn")[0].className.indexOf("-unavailable")<0&&$()}),a("#editCaseBtn").bind("click",function(b){a("#editCaseBtn")[0].className.indexOf("-unavailable")<0&&_()}),a("#deleteCaseBtn").bind("click",function(b){a("#deleteCaseBtn")[0].className.indexOf("-unavailable")<0&&da()}),a("#caseMoreConfigBtn").bind("click",function(){"none"===a("#caseMoreConfig")[0].style.display?(a("#caseMoreConfigBtn")[0].className="testcase-buttons-item opt-closeup",a("#caseMoreConfig").css("display","block")):(a("#caseMoreConfig").css("display","none"),a("#caseMoreConfigBtn")[0].className="testcase-buttons-item opt-openall")}),a("#addCaseToScene").bind("click",function(){if(a("#addCaseToScene")[0].className.indexOf("-unavailable")<0){var b=a("#caseTable").udeTable().fnGetSelectedRowData();if(null==b)return void showMessage(a.i18n.prop("testcase.casejs.initUser.operPrompt"),null,"error");a.ude.page.testcase.scenedesign.main.addCaseToScene(b,"add")}}),a(".common-buttons-item").unbind("setDisableT"),a(".common-buttons-item").unbind("setDisableF"),a(".common-buttons-item").bind("setDisableT",function(b){var c=b.currentTarget.className;b.currentTarget.className=c.indexOf("-unavailable")<0?c+"-unavailable":c,a(b.currentTarget).attr("disabled","disabled")}),a(".common-buttons-item").bind("setDisableF",function(b){var c=b.currentTarget.className;b.currentTarget.className=c.replace("-unavailable",""),a(b.currentTarget).removeAttr("disabled")})}function l(){a("#refreshImage").bind("click",function(b){a("#refreshImage")[0].className.indexOf("-unavailable")<0&&(L(),a("#currentImage").click())}),a("#installApp").bind("click",function(b){a("#installApp")[0].className.indexOf("-unavailable")<0&&u()}),a("#syncObject").bind("click",function(b){a("#syncObject")[0].className.indexOf("-unavailable")<0&&(K(),a("#autoPageObject").click())}),a("#saveObject").bind("click",function(b){a("#saveObject")[0].className.indexOf("-unavailable")<0&&w()}),a("#deletePageObject").bind("click",function(){a("#deletePageObject")[0].className.indexOf("-unavailable")<0&&z()}),a("#addPageObject").bind("click",function(){a("#addPageObject")[0].className.indexOf("-unavailable")<0&&C()}),a("#editPageObject").bind("click",function(){a("#editPageObject")[0].className.indexOf("-unavailable")<0&&I()}),a("#savePageObject").bind("click",function(){a("#savePageObject")[0].className.indexOf("-unavailable")<0&&H()}),a("#saveImage").bind("click",function(){a("#saveImage")[0].className.indexOf("-unavailable")<0&&r()}),a(document).off("click",".hotspot"),a(document).on("click",".hotspot",function(b){var c=a(this).attr("id");if(c){var d=q(c);d!=-1&&(a("#pageObjectTable").udeTable().fnSelectRowByData(d),a("#pageObjectTable").udeTable().fnScrollToSelectedRow())}}),a(document).off("dblclick",".hotspot"),a(document).on("dblclick",".hotspot",function(b){var c=a(this).attr("id");if(c){var d=q(c);d!=-1?(a("#pageObjectTable").udeTable().fnSelectRowByData(d),a("#pageObjectTable").udeTable().fnScrollToSelectedRow(),t(a("#pageObjectTable").udeTable().fnGetSelectedRowData())):showMessage("\u8be5\u63a7\u4ef6\u5c1a\u672a\u540c\u6b65\uff0c\u8bf7\u540c\u6b65\u5e76\u4fdd\u5b58\u540e\u518d\u6dfb\u52a0\u7528\u4f8b\uff01",null,"error")}}),a(document).off("click","#appImage"),a(document).on("click","#appImage",function(b){b.pageX-a("#appImage").offset().left,b.pageY-a("#appImage").offset().top}),a(document).off("mouseover",".hotspot"),a(document).on("mouseover",".hotspot",function(b){a(".hotspot").removeClass("showborder")}),a("#manualPageObject").bind("click",function(){setTimeout('$("#pageObjectTableM").udeTable().fnResize()',50),a("#addPageObject").trigger("setDisableF"),a("#editPageObject").trigger("setDisableF"),a("#saveObject").trigger("setDisableT")}),a("#autoPageObject").bind("click",function(){setTimeout('$("#pageObjectTable").udeTable().fnResize()',50),a("#addPageObject").trigger("setDisableT"),a("#editPageObject").trigger("setDisableT"),a("#saveObject").trigger("setDisableF")}),Sa=a("#appImage").imgAreaSelect({handles:!0,instance:!0,onSelectEnd:function(a,b){m(b,!1)}}),Ta=a("#savedAppImage").imgAreaSelect({handles:!0,instance:!0,onSelectEnd:function(a,b){m(b,!0)}}),a("#saveControlBtn").bind("click",function(){n()}),a(document).on("click",function(b){var c=a(b.target);a(b.target).parents(".ui-dialog").length>0||c.hasClass("ui-widget-overlay")||(null!=Sa&&Sa.cancelSelection(),Ta&&Ta.cancelSelection())}),L(!0),E()}function m(b,c){if(0!=b.width&&0!=b.height){var d=0,e=0,f=0,g=0;if(c){var h=a("#savedAppImage").attr("src");if(!h)return void showMessage("\u5c1a\u672a\u4fdd\u5b58\u56fe\u50cf\uff01",null,"error");d=Ha,e=Ia,f=a("#savedAppImage").height(),g=a("#savedAppImage").width()}else{var h=a("#appImage").attr("src");if(!h)return void showMessage("\u5c1a\u672a\u83b7\u53d6\u5f53\u524d\u56fe\u50cf\uff01",null,"error");d=Fa,e=Ga,f=a("#appImage").height(),g=a("#appImage").width()}var i=b.x1,j=b.y1,k=b.x2,l=b.y2,m=parseInt(i*e/g,10),n=parseInt(j*d/f,10),o=parseInt(k*e/g,10),p=parseInt(l*d/f,10),q="["+m+","+n+"]["+o+","+p+"]";a("#controlInfo").html("\u9009\u62e9\u8303\u56f4\u5728\u5bf9\u5e94\u8bbe\u5907\u4e0a\u7684\u8fb9\u754c\u662f"+q),a("#controlBounds").val(q),a("#resolution").val("["+e+","+d+"]"),a("#controlText").val(""),a.ude.dialog.open("addControlDialog",{title:"\u65b0\u589e\u63a7\u4ef6",width:"500px"})}}function n(){var b=a("#controlText").val(),c=a("#controlBounds").val(),d=a("#resolution").val();if(!b)return void showMessage("\u8bf7\u8f93\u5165\u63a7\u4ef6\u7684\u540d\u79f0\uff01",null,"error");var e=a.ude.page.config.projectStructure.main.treeAttribution(),f=e.menuId,g=e.parentMenuId;if("-1"==f||"-1"==g)return void showMessage("\u8be5\u83dc\u5355\u65e0\u6cd5\u6dfb\u52a0\u63a7\u4ef6\uff01",null,"error");var h={type:"Webview","resource-id":"",text:b,"content-desc":"",xpath:"",dp:"",bounds:c,resolution:d,density:Ra},i=JSON.stringify(h),j={};j.id="syncAdd",j.name=i,j.menuId=f,j.elementType="custom",j.elementLable=i,j.analyseKind="auto",j.isEnabled="T",j.elementXpath="",j.syncInfo="1",j.text=b,j.bounds=c;var k=new DataCenter,l=new DataStore(ta);l.setRowSetName(ta),l.getRowSet().addRow(j),k.addDataStore(l),a.ude.rpc.testcaseRpc.saveObject(k,o)}function o(b){if(a.ude.dialog.close(),p(),b&&"0"===b.getCode()){showMessage("\u64cd\u4f5c\u6210\u529f\u3002",null,"info");var c=b.getDataStore(ta).getRowSet().getData(),d=c[0];d.syncInfo="",a("#pageObjectTable").udeTable().fnAddRow(d)}else{var e=b.getDetail();showMessage(e,null,"error")}}function p(){Sa.cancelSelection(),Ta.cancelSelection()}function q(b){var c="",d="",e="",f=b.split("::");"saved"==f[0]?(c=f[1],d=f[2],e=f[3]):(c=f[0],d=f[1],e=f[2]);for(var g=c+"::"+d+"::"+e,h=a("#pageObjectTable").udeTable().fnGetData(),i=-1,j=null,k=0;k<h.length;k++){var l=h[k],m=l.resourceId?l.resourceId:"",n=l.text?l.text:"";n||(n=l.contentDesc?l.contentDesc:"");var o=l.elementXpath?l.elementXpath:"",p=m+"::"+n+"::"+o;if(g==p){i=k,j=l;break}}return i}function r(){var b=a("#appImageHidden").val(),c=a("#appDomXmlHidden").val(),d=a.ude.page.config.projectStructure.main.treeAttribution(),e=d.menuId,f=function(){i()};a.ude.rpc.testcaseRpc.saveImage(e,b,c,f)}function s(b){if(b){var c=a("#methodTable").is(":visible");if(!c)return void showMessage("\u8bf7\u9009\u62e9\u7528\u4f8b\u540e\uff0c\u518d\u6dfb\u52a0\u6d4b\u8bd5\u6b65\u9aa4\uff01",null,"error");var d=a("#caseTable").udeTable().fnGetSelectedRowData(),e=a("#methodTable").udeTable().fnGetSelectedRowData();if(!d||!e)return void showMessage("\u8bf7\u6307\u5b9a\u6d4b\u8bd5\u65b9\u6cd5\uff01",null,"error");var f=b.id,g={},h=d.caseId,i=e.methodId;g.caseId=h,g.methodId=i,g.controlType=b.elementType,g.controlId=f;var j=b.elementType;"input"==j||"date"==j?g.operActionId="setValue":"select"==j?g.operActionId="setText":g.operActionId="click",g.varId="",g.wait="1",g.eventDesc="",g.interactiveObject="pageObj",g.interactiveType="operType";var k=new DataCenter,l=new DataStore(ua);l.setRowSetName(ua),l.getRowSet().addRow(g),k.addDataStore(l),a.ude.page.testcase.caseDesign.eventjs.doAddEvent(k)}}function t(b){if(b){var c=b.syncInfo;if("1"==c||"2"==c)return void showMessage("\u60a8\u9009\u62e9\u7684\u8282\u70b9\u672a\u4fdd\u5b58\u6216\u5df2\u5220\u9664\uff0c\u8bf7\u8fdb\u884c\u540c\u6b65\uff01",null,"error");var d=a("#methodTable").is(":visible");if(!d)return void showMessage("\u8bf7\u9009\u62e9\u7528\u4f8b\u540e\uff0c\u518d\u6dfb\u52a0\u6d4b\u8bd5\u6b65\u9aa4\uff01",null,"error");var e=a("#caseTable").udeTable().fnGetSelectedRowData(),f=a("#methodTable").udeTable().fnGetSelectedRowData();if(!e||!f)return void showMessage("\u8bf7\u6307\u5b9a\u6d4b\u8bd5\u65b9\u6cd5\uff01",null,"error");var g=b.id,h=b.name,i={},j=e.caseId,k=f.methodId;i.caseId=j,i.methodId=k,i.controlType=b.elementType,i.controlId=g,h&&h.indexOf("android.widget.EditText")!=-1?i.operActionId="setValue":i.operActionId="click",i.varId="",i.wait="1",i.eventDesc="",i.interactiveObject="pageObj",i.interactiveType="operType";var l=new DataCenter,m=new DataStore(ua);m.setRowSetName(ua),m.getRowSet().addRow(i),l.addDataStore(m),a.ude.page.testcase.caseDesign.eventjs.doAddEvent(l)}}function u(){var b=function(b){b&&"0"===b.getCode()?a.ude.util.confirm("\u5df2\u6709\u5e94\u7528\u88ab\u5b89\u88c5,\u662f\u5426\u91cd\u65b0\u5b89\u88c5\u5e94\u7528?",v):v()};a.ude.rpc.testcaseRpc.getAppiumSession(b)}function v(){var b=function(a){if(a&&"0"===a.getCode())L();else{var b=a.getDetail();showMessage(b,null,"error")}},c=window.location.host;a.ude.rpc.testcaseRpc.installApp(c,b)}function w(){Na=new Array;var b=a("input[name='check']:checked");return b.length>0?(a(b).each(function(){Na.push(this.value)}),void a.ude.util.confirm("\u662f\u5426\u786e\u8ba4\u540c\u6b65\u63a7\u4ef6\u4fe1\u606f?",x)):void showMessage("\u8bf7\u9009\u62e9\u8981\u540c\u6b65\u7684\u6570\u636e",null,"error")}function x(){var b=a("#pageObjectTable").udeTable().fnGetData(),c=new DataCenter,d=new DataStore(ta);d.setRowSetName(ta);for(var e=0;e<b.length;e++)a.inArray(b[e].id,Na)!=-1&&d.getRowSet().addRow(b[e]);c.addDataStore(d),a.ude.rpc.testcaseRpc.saveObject(c,y)}function y(b){if(b&&"0"===b.getCode()){var c=function(b){a("#pageObjectTable").udeTable().dataTable().fnClearTable(),a("#pageObjectTableM").udeTable().dataTable().fnClearTable();for(var c=b.getDataStore(sa).getRowSet().getData(),d=new Array,e=new Array,f=0;f<c.length;f++)"auto"==c[f].analyseKind?e.push(c[f]):d.push(c[f]);a("#pageObjectTable").udeTable().fnRedraw(e),a("#pageObjectTable").udeTable().fnResize(),a("#pageObjectTableM").udeTable().fnRedraw(d),a("#pageObjectTableM").udeTable().fnResize(),showMessage("\u540c\u6b65\u6210\u529f\u3002",null,"info")};h(c);var d=a("#appDomXmlHidden").val();""!=d&&r()}else{var e=b.getDetail();showMessage(e,null,"error")}}function z(){if(Na=new Array,a("#manualPageObjectTab").attr("class").indexOf("active")!=-1){var b=a("input[name='checkM']:checked");if(!(b.length>0))return void showMessage(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.deletePageObject_showMessage"),null,"error");a(b).each(function(){Na.push(this.value)});var c=a.ude.page.config.projectStructure.main.treeAttribution(),d=new DataCenter,e=new DataStore(ra);e.setRowSetName(ra),e.getRowSet().addRow(c),d.addDataStore(e),Qa=d;for(var f=0;f<Na.length;f++)Qa.addParameter(Na[f],Na[f]);a.ude.util.confirm(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.deletePageObject_confirm")+"\uff1f",A)}else{var b=a("input[name='check']:checked");if(!(b.length>0))return void showMessage(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.deletePageObject_showMessage"),null,"error");a(b).each(function(){Na.push(this.value)});for(var g=a("#pageObjectTable").udeTable().fnGetData(),h=0;h<g.length;h++)a.inArray(g[h].id,Na)!=-1&&(g[h].syncInfo="2");a("#pageObjectTable").udeTable().fnRedraw(g),a("#pageObjectTable").udeTable().fnResize()}}function A(){a.ude.rpc.pageObject.deletePageObject(Qa,B)}function B(b){if(b&&"0"===b.getCode()){for(var c=b.getDataStore(sa).getRowSet().getData(),d=new Array,e=new Array,f=0;f<c.length;f++)"auto"==c[f].analyseKind?e.push(c[f]):d.push(c[f]);a("#pageObjectTableM").udeTable().fnRedraw(d),showMessage(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.deletePageObjectComplete"),null,"info");
}else{var g=b.getDetail();showMessage(g,null,"error")}}function C(){var b=a.ude.page.config.projectStructure.main.treeAttribution(),c=b.pageType,d=b.menuId;"-1"===d||"listMenu"===c?showMessage(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.addPageObject_showMessage")+"\uff01",null,"error"):(a("#pageObjectDialog").prop("add",!0),D(),a.ude.dialog.open("pageObjectDialog",{title:a.i18n.prop("ude.page.config.pageObject.pageObjectJs.addPageObject_title"),width:"500px"}))}function D(){a("#elementName").attr("value",""),a("#description").attr("value","")}function E(){a.ude.rpc.pageObject.getInitData(null,F)}function F(b){if(b&&"0"===b.getCode()){var c=b.getDataStore("elementTypeList").getRowSet().getData();Oa=a("#elementType").udeSelect({}),Oa.setData(c)}}function G(){var b=a("#elementType").val();if(!b||""===b)return showMessage(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.checkAvailability_elementType")+"\uff01",a("#pageObjectDialog"),"error"),a("#elementType").focus(),!1;var c=a.trim(a("#elementName").val());return c&&""!==c?!(c.indexOf('"')>0)||void showMessage("\u63a7\u4ef6\u6807\u8bc6\u4e2d\u4e0d\u80fd\u5b58\u5728\u53cc\u5f15\u53f7",a("#pageObjectDialog"),"error"):(showMessage(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.checkAvailability_elementName"),a("#pageObjectDialog"),"error"),void a("#elementName").focus())}function H(){var b=G();if(b){var c=(new DataCenter,a("#elementType").val()),d=a.trim(a("#elementName").val()),e=a.trim(a("#description").val()),f=null;if(a("#pageObjectDialog").prop("add")){var g={};g.elementType=c,g.name=d,g.belongFrame="",g.description=e,g.analyseKind="manual",f=new DataStore(sa),f.setRowSetName(sa),f.getRowSet().addRow(g)}else Pa.elementType=c,Pa.name=d,Pa.belongFrame="",Pa.description=e,Pa.analyseKind="manual",f=new DataStore(sa),f.setRowSetName(sa),f.getRowSet().addRow(Pa);var h=new DataStore(ra);h.setRowSetName(ra);var i=a.ude.page.config.projectStructure.main.treeAttribution();h.getRowSet().addRow(i),a.ude.rpc.pageObject.savePageObject(f,h,function(b){"0"==b.header.code?J(b):showMessage(a.i18n.prop(b.header.message.detail),null,"error")})}}function I(){if(Pa=a("#pageObjectTableM").udeTable().fnGetSelectedRowData(),null==Pa)return void showMessage(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.editPageObject_showMessage"),null,"error");D();var b=Pa.elementType,c=Pa.name;Oa.udeSelect().setValue(b);b.toLowerCase();a("#elementName").val(c),a("#description").val(Pa.description),a("#pageObjectDialog").prop("add",!1),a.ude.dialog.open("pageObjectDialog",{title:a.i18n.prop("ude.page.config.pageObject.pageObjectJs.editPageObject_title"),width:"500px"})}function J(b){a.ude.dialog.close(),showMessage("\u64cd\u4f5c\u6210\u529f\u3002",null,"info");for(var c=b.getDataStore(sa).getRowSet().getData(),d=new Array,e=new Array,f=0;f<c.length;f++)"auto"==c[f].analyseKind?e.push(c[f]):d.push(c[f]);a("#pageObjectTableM").udeTable().fnRedraw(d)}function K(){var b=function(b){a("#pageObjectTable").udeTable().dataTable().fnClearTable();for(var c=b.getDataStore(sa).getRowSet().getData(),d=new Array,e=new Array,f=0;f<c.length;f++)"auto"==c[f].analyseKind?e.push(c[f]):d.push(c[f]);for(var g=a.ude.page.config.projectStructure.main.treeAttribution(),h=g.menuId,i={},j={},k=0;k<Ja.length;k++){var l="(//"+Ja[k].clazz+")["+(parseInt(Ja[k].instance)+1)+"]";Ja[k].indexInWebView!=-1&&"android.view.View"==Ja[k].clazz&&(l="(//android.webkit.WebView[@instance=0]//*)["+Ja[k].indexInWebView+"]");var m=Ja[k].resourceId+"::"+Ja[k].text+"::"+Ja[k].contentDesc+"::"+l;j.hasOwnProperty(m)||(j[m]=k)}for(var n=0;n<e.length;n++)if(e[n].elementXpath){var m=e[n].resourceId+"::"+e[n].text+"::"+e[n].contentDesc+"::"+e[n].elementXpath;i.hasOwnProperty(m)||(i[m]=n),j.hasOwnProperty(m)||"auto"!=e[n].analyseKind||(e[n].syncInfo="2")}else e[n].syncInfo="";for(var f=0;f<Ja.length;f++){var l="(//"+Ja[f].clazz+")["+(parseInt(Ja[f].instance)+1)+"]";Ja[f].indexInWebView!=-1&&"android.view.View"==Ja[f].clazz&&(l="(//android.webkit.WebView[@instance=0]//*)["+Ja[f].indexInWebView+"]");var m=Ja[f].resourceId+"::"+Ja[f].text+"::"+Ja[f].contentDesc+"::"+l;if(!i.hasOwnProperty(m)){var o="Native";Ja[f].isWebview="0",1==Ja[f].webviewNode&&(o="Webview",Ja[f].isWebview="1");var p={type:o,"resource-id":Ja[f].resourceId,text:Ja[f].text,"content-desc":Ja[f].contentDesc,xpath:l,dp:"",bounds:Ja[f].bounds,resolution:"["+Ga+","+Fa+"]",density:Ra},q=JSON.stringify(p);Ja[f].id="syncAdd"+Ka,Ka+=1,Ja[f].name=q,Ja[f].menuId=h,Ja[f].elementType="custom",Ja[f].elementLable=q,Ja[f].analyseKind="auto",Ja[f].isEnabled="T",Ja[f].elementXpath=l,Ja[f].syncInfo="1",e.push(Ja[f])}}a("#pageObjectTable").udeTable().fnRedraw(e),a("#pageObjectTable").udeTable().fnResize()};h(b)}function L(b){var c=function(c){if(c&&"0"===c.getCode()){var e=c.getParameter("appiumSessionId");a.ude.rpc.testcaseRpc.refreshImage(e,d)}else b||showMessage("\u8bf7\u5148\u70b9\u51fb\u5b89\u88c5\u5e94\u7528\u6309\u94ae\uff0c\u5b89\u88c5\u5e94\u7528\uff01",null,"info")},d=function(b){if(b&&"0"===b.getCode()){var c=b.getParameter("imageStream"),d=b.getParameter("domXml");Fa=b.getParameter("height"),Ga=b.getParameter("width"),Ra=b.getParameter("density");var e=Fa*Ua/Ga;a("#appImageHidden").val(c),a("#appDomXmlHidden").val(d),a("#appImage").attr("src","data:image/png;base64,"+c),a("#appImage").height(e),a("#appImage").width(Ua);var f=b.getDataStore("targetHotSpotNodes");Ja=f.getRowSet().getData(),a("#hotspot-container").html(""),f.getRowSet().forEach(function(b){var c=b.getItemValue("bounds"),d=b.getItemValue("nodeId"),f=c.replace("][",",").replace("[","").replace("]",""),g=f.split(","),h=Ua*g[0]/Ga,i=e*g[1]/Fa,j=(g[2]-g[0])*Ua/Ga,k=(g[3]-g[1])*e/Fa,l="top:"+i+"px;left:"+h+"px;height:"+k+"px;width:"+j+"px;",m="<li><a href='javascript:void(0)'><span class='hotspot' style='"+l+"' id='"+d+"'></span></a></li>";a("#hotspot-container").append(m)})}else{var g=b.getDetail();showMessage(g,null,"error")}};a.ude.rpc.testcaseRpc.getAppiumSession(c)}function M(b){a("#pageObjectTable").udeTable({data:b,columns:[{sTitle:"",mData:"id",sWidth:"5%",bSort:!1,mRender:Q},{sTitle:"\u6587\u672c",mData:"text",sWidth:"28%",mRender:T},{sTitle:"\u63a7\u4ef6ID",mData:"resourceId",sWidth:"19%"},{sTitle:"\u8def\u5f84",mData:"elementXpath",sWidth:"19%"},{sTitle:"\u5750\u6807",mData:"bounds",sWidth:"19%"},{sTitle:"\u540c\u6b65\u72b6\u6001",mData:"syncInfo",sWidth:"10%",mRender:S}],dblClick:P,onClick:O,oScroller:{displayBuffer:100,rowHeight:26}}),a("#pageObjectTable").udeTable().fnSetCheckbox("pageObjectTable"),La=!1,a("input[name='pageObjectTable_chk_all']").unbind("click"),a("input[name='pageObjectTable_chk_all']").bind("click",function(){f()})}function N(b){a("#pageObjectTableM").udeTable({data:b,columns:[{sTitle:"",mData:"id",sWidth:"5%",bSort:!1,mRender:R},{sTitle:a.i18n.prop("ude.page.config.pageObject.pageObjectJs.setData_elementType"),mData:"elementType",sWidth:"20%"},{sTitle:a.i18n.prop("ude.page.config.pageObject.pageObjectJs.setData_name"),mData:"name",sWidth:"25%"},{sTitle:a.i18n.prop("ude.page.config.pageObject.pageObjectJs.setData_description"),mData:"description",sWidth:"50%"}],dblClick:s}),a("#pageObjectTableM").udeTable().fnSetCheckbox("pageObjectTableM"),Ma=!1,a("input[name='pageObjectTableM_chk_all']").unbind("click"),a("input[name='pageObjectTableM_chk_all']").bind("click",function(){g()})}function O(b){var c=b.resourceId?b.resourceId:"",d=b.text?b.text:"";d||(d=b.contentDesc?b.contentDesc:"");var e=b.elementXpath?b.elementXpath:"",f=c+"::"+d+"::"+e;a("#savedImage").parent().hasClass("active")&&(f="saved::"+f),a(".hotspot").removeClass("showborder");var g=document.getElementById(f);a(g).addClass("showborder")}function P(a){t(a)}function Q(b,c,d){var e,f=a("<div class='cell-widget' align='center'/>");if(!d.syncInfo||"1"!=d.syncInfo&&"2"!=d.syncInfo)var e=a("<input type='checkbox' name='check' value='"+b+"'/> ");else var e=a("<input type='checkbox' name='check' value='"+b+"' checked/> ");return f.append(e),a("<div/>").append(f).html()}function R(b,c,d){var e=a("<div class='cell-widget' align='center'/>"),f=a("<input type='checkbox' name='checkM' value='"+b+"'/> ");return e.append(f),a("<div/>").append(e).html()}function S(a,b,c){return a&&"1"==a?"\u65b0\u589e":a&&"2"==a?"\u5220\u9664":"\u5df2\u5b58\u5728"}function T(a,b,c){return c.text&&""!=c.text?c.text:c.contentDesc}function U(){a("#caserefresh").hide(),a("#caserefreshDIV").hide(),a("#caseName").prop("maxlength",40),a("#defaultInclude").prop("maxlength",20),a("#url").prop("maxlength",100),a("#descInfo").prop("maxlength",200),a("#caseSaveId").click(function(){V()&&W()})}function V(){var b=a.trim(a("#caseName").val());return!(!b||""===b)||(showMessage(a.i18n.prop("testcase.casejs.checkAvailability.caseName"),a("#caseDialog"),"error"),a("#caseName").focus(),!1)}function W(){var b=a.trim(a("#caseName").val()),c=function(b){if(b&&"0"===b.getCode()){var c=b.getParameter("caseName");"0"===c?aa():(showMessage(a.i18n.prop("testcase.casejs.testCaseRepeat.caseName"),a("#caseDialog"),"error"),a("#caseName").focus())}else{var d=b.getDetail();showMessage(d,a("#caseDialog"),"error")}};xa!==b?a.ude.rpc.testcaseRpc.testCaseRepeat(b,c):aa()}function X(b){a("#caseTable").udeTable().dataTable().fnClearTable();for(var c=null,d=0;d<b.length;d++)a("#caseTable").udeTable().fnAddRow(b[d]),Da===b[d].caseId&&(c=b[d],Da=null);if(c){a("#caseList").hide(),a("#caseEdit").show(),a.ude.page.testcase.scenedesign.main.getSceneByCaseId(c.caseId);var e=ja(c.parentCaseId),f=pa(c.parentCaseId);a.ude.page.testcase.caseDesign.methodjs.initMethod(c,f,e)}else{var g=a("#caseTable").udeTable().fnGetSelectedRowData();a.ude.page.testcase.scenedesign.main.getSceneByCaseId(g.caseId)}}function Y(b){a("#caseTable").udeTable({data:b,columns:[{sTitle:a.i18n.prop("testcase.casejs.initTable.caseName"),mData:"caseName",sWidth:"20%",mRender:ga},{sTitle:a.i18n.prop("testcase.casejs.initTable.belongpage"),mData:"parentCaseId",sWidth:"43%",mRender:oa},{sTitle:a.i18n.prop("testcase.casejs.initTable.status"),mData:"status",sWidth:"7%",mRender:ia},{sTitle:"URL",mData:"url",sWidth:"0%",bVisible:!1},{sTitle:a.i18n.prop("testcase.casejs.initTable.uICompare"),mData:"uICompare",sWidth:"0%",mRender:ia,bVisible:!1},{sTitle:a.i18n.prop("testcase.casejs.initTable.descInfo"),mData:"descInfo",sWidth:"30%"},{sTitle:a.i18n.prop("testcase.casejs.initTable.refresh"),mData:"refresh",sWidth:"0%",mRender:ia,bVisible:!1}],dblClick:function(b){_(),a.ude.page.testcase.scenedesign.main.getSceneByCaseId(b.caseId)}})}function Z(){wa={},a("#caseName").val(""),a("#casestatus").attr("checked",!0),a("#defaultInclude").val(""),a("#url").val(""),a("#caserefresh").attr("checked",!1),a("#caseUICompare").attr("checked",!1),a("#descInfo").val("")}function $(){Z(),a("#caseDialog").prop("add",!0),a.ude.dialog.open("caseDialog",{title:a.i18n.prop("testcase.casejs.newUser.caseDialog"),width:"500px"})}function _(){var b=a("#caseTable").udeTable().fnGetSelectedRowData();return null==b?void showMessage(a.i18n.prop("testcase.casejs.initUser.operPrompt"),null,"error"):(va=b.id,xa=b.caseName,wa=b,a("#caseName").val(b.caseName),"1"===b.status?a("#casestatus").attr("checked",!0):a("#casestatus").attr("checked",!1),a("#defaultInclude").val(b.defaultInclude),a("#url").val(b.url),"1"===b.refresh?a("#caserefresh").attr("checked",!0):a("#caserefresh").attr("checked",!1),"1"===b.uICompare?a("#caseUICompare").attr("checked",!0):a("#caseUICompare").attr("checked",!1),a("#descInfo").val(b.descInfo),a("#caseDialog").prop("add",!1),void a.ude.dialog.open("caseDialog",{title:a.i18n.prop("testcase.casejs.editUser.caseDialog"),width:"500px"}))}function aa(){var b=wa;b.caseName=a.trim(a("#caseName").val()),b.status=a("#casestatus").is(":checked")===!0?"1":"0",b.defaultInclude=a.trim(a("#defaultInclude").val()),b.url=a.trim(a("#url").val()),b.refresh=a("#caserefresh").is(":checked")===!0?"1":"0",b.uICompare=a("#caseUICompare").is(":checked")===!0?"1":"0",b.descInfo=a.trim(a("#descInfo").val()),a("#caseDialog").prop("add")&&(b.parentCaseId=za),"childPage"===ya.pageType?b.belongpage=ya.menuName:b.belongpage=null;var c=new DataCenter,d=new DataStore(qa);d.setRowSetName(qa),d.getRowSet().addRow(b),c.addDataStore(d),a("#caseDialog").prop("add")?ba(c):(b.id=va,ca(c))}function ba(b){var c=b.getSingleDataStore(),d=c.getRowSet().getRow(0).data,e=function(b){if(b&&"0"===b.getCode()){var c=b.getSingleDataStore();d=c.getRowSet().getRow(0).data,a("#caseTable").udeTable().fnAddRow(d),a.ude.dialog.close()}else{var e=b.getDetail();showMessage(e,a("#caseDialog"),"error")}};a.ude.rpc.testcaseRpc.addUser(b,e)}function ca(b){var c=b.getSingleDataStore(),d=c.getRowSet().getRow(0).data,e=function(b){if(b&&"0"===b.getCode())a("#caseTable").udeTable().fnUpdateRow(d),a.ude.dialog.close();else{var c=b.getDetail();showMessage(c,a("#caseDialog"),"error")}};a.ude.rpc.testcaseRpc.editUser(b,e)}function da(){var b=a("#caseTable").udeTable().fnGetSelectedRowData();return b?void a.ude.util.confirm(a.i18n.prop("testcase.casejs.deleteUser.caseDialogQ"),ea):void showMessage(a.i18n.prop("testcase.casejs.deleteUser.caseDialog"),null,"error")}function ea(){var b=a("#caseTable").udeTable().fnGetSelectedRowData();a.ude.rpc.testcaseRpc.deleteUser(b.caseId,fa)}function fa(b){if(b&&"0"===b.getCode())a("#caseTable").udeTable().fnDeleteRow();else{var c=b.getDetail();showMessage(c,null,"error")}}function ga(b,c){var d=a("<div class='cell'></div>"),e=a("<a href='#' style='text-decoration:underline;' onclick='$.ude.page.testcase.caseDesign.main.caseNameOnclick(event)'>"+b+"</a>");return d.append(e),d.html()}function ha(b){a("#caseList").hide(),a("#caseEdit").show(),a.ude.page.testcase.scenedesign.main.clearnCurrentNode();var c=a("#caseTable").udeTable().fnGetSelectedRowData();a.ude.page.testcase.scenedesign.main.getSceneByCaseId(c.caseId);var d=ja(c.parentCaseId),e=pa(c.parentCaseId);a.ude.page.testcase.caseDesign.methodjs.initMethod(c,e,d,Ea),na(ya.ismenu,c.parentCaseId)}function ia(b,c){return b="1"===b?a.i18n.prop("testcase.casejs.renderYorN.yes"):a.i18n.prop("testcase.casejs.renderYorN.no")}function ja(b){var c="";"1"===ya.ismenu?c=a("#menuTree").udeTree().getNodeByMenuId(b):"2"===ya.ismenu&&(c=a("#notMenuTree").udeTree().getNodeByMenuId(b));var d="",e="",f="";return"pageMenu"===c.pageType||"childPage"===c.pageType?(d=c.menuId,f="'"+d+"'"+ka(c,e)):(d="",f=ka(c,e).substring(1)),f}function ka(a,b){if(a.isParent){var c=a.children;if(c)for(var d=0;d<c.length;d++)"childPage"===c[d].pageType&&(b+=",'"+c[d].menuId+"'"),b=ka(c[d],b)}return b}function la(a,b){if(a.isParent){var c=a.children;if(c)for(var d=0;d<c.length;d++)"pageMenu"!==c[d].pageType&&"childPage"!==c[d].pageType||(b+=",'"+c[d].menuId+"'"),b=la(c[d],b)}return b}function ma(b,c,d){a.ude.page.config.projectStructure.main.caseClickSelectNode(d),Da=b}function na(b,c){var d=a("1"===b?"#menuTree":"#notMenuTree"),e=a("#caseList").find(".common-content-top").width()-a("#caseLoadeTitle_caseL").prev().width()-a("#caseList").find(".common-right").width(),f=a("#caseEditMethod").find(".common-content-top").width()-a("#caseLoadeTitle_caseM").prev().width()-a("#caseEditMethod").find(".common-right").width(),g=0!==e?e:f;a("div[id*='caseLoadeOut']").css("width",g-190),a("div[id*='caseLoadeTitle']").children().remove(),a(".caseloadeoutMoveR").remove(),a(".caseloadeoutMoveL").remove(),a("div[id*='caseLoadeTitle']").css("margin-left","0px"),a("div[id*='caseLoadeTitle']").css("width","auto");var h=[];h=c&&c.length>0?d.udeTree().getNodeByMenuId(c):d.udeTree().getSelectedNode();for(var i=!1;h.parentTId&&"-1"!==h.parentMenuId;){var j=h.name,k=h.menuId;i?a("div[id*='caseLoadeTitle']").prepend("<div></div>"):i=!0;var l=a("<span id='"+k+"'>"+j+"</span>").bind("click",function(a){});a("div[id*='caseLoadeTitle']").prepend(l),h=d.udeTree().getNodeByTId(h.parentTId)}i?a("div[id*='caseLoadeTitle']").prepend("<label><strong>\u3010</strong></label>"):"",i?a("div[id*='caseLoadeTitle']").append("<label><strong>\u3011</strong></label>"):"";var m=a(a("div[id*='caseLoadeTitle']")[0]).width()-a(a("div[id*='caseLoadeOut']")[0]).width(),n=a(a("div[id*='caseLoadeTitle']")[1]).width()-a(a("div[id*='caseLoadeOut']")[1]).width(),o=0===a("#caseList").find(".common-content-top").width()?n:m;o>=0&&(a("div[id*='caseLoadeTitle']").css("width",a("div[id*='caseLoadeOut']").width()+1e3),a("div[id*='caseLoadeOut']").prev().after(a("<div class='caseloadeoutMoveL'></div>").bind("click",function(){var b=a("div[id*='caseLoadeTitle']").css("margin-left"),c=parseInt(b.substring(0,b.length-2));c<0&&a("div[id*='caseLoadeTitle']").css("margin-left",c+80+"px")})),a("div[id*='caseLoadeOut']").after(a("<div class='caseloadeoutMoveR'></div>").bind("click",function(b){var c=a("div[id*='caseLoadeTitle']").css("margin-left"),d=parseInt(c.substring(0,c.length-2)),e=a(a(".caseloadeoutMoveR")[0]),f=a(a(".caseloadeoutMoveR")[1]),g=e.offset().left-e.prev().children().find("label:last").offset().left,h=f.offset().left-f.prev().children().find("label:last").offset().left,i=0!==g?g:h;i<30&&a("div[id*='caseLoadeTitle']").css("margin-left",d-80+"px")})))}function oa(b){var c;c=a(a("#t1").is(":hidden")?"#notMenuTree":"#menuTree");for(var d=c.udeTree().getNodeByMenuId(b),e=d.name;d.parentTId&&"-1"!==d.parentMenuId;){d.menuId;if(d=c.udeTree().getNodeByTId(d.parentTId),"-1"==d.parentMenuId)break;e=d.name+"."+e}return e}function pa(b){var c;c=a(a("#t1").is(":hidden")?"#notMenuTree":"#menuTree");var d=c.udeTree().getNodeByMenuId(b),e="";for("childPage"!=d.pageType&&(e=d.name);d.parentTId&&"-1"!==d.parentMenuId;){d.menuId;if(d=c.udeTree().getNodeByTId(d.parentTId),"-1"==d.parentMenuId)break;"childPage"!=d.pageType&&(e=""==e?d.name:d.name+"."+e)}return e}a.ude.page.testcase.caseDesign.main={init:b,initAppPage:l,caseNameOnclick:ha,treeClick:c,initResizeHandler:d,caseNameOnclickByScene:ma,refreshImage:L,setData:M,setDataM:N};var qa="com.neusoft.utf.portal.common.entity.TestcaseLevel",ra="com.neusoft.utf.portal.config.projectstructure.entity.UtfProjectAnalyseResult",sa="com.neusoft.utf.portal.config.pageobject.entity.UtfPageAnalyseResult",ta="com.neusoft.utf.portal.config.pageobject.entity.UtfPageAnalyseResultForApp",ua="com.neusoft.utf.portal.common.entity.TestcaseEvent",va=null,wa={},xa=null,ya=null,za="",Aa=null,Ba="",Ca=1,Da=null,Ea=null,Fa=480,Ga=270,Ha=480,Ia=270,Ja={},Ka=0,La=!1,Ma=!1,Na=new Array,Oa=null,Pa=null,Qa=null,Ra="",Sa=null,Ta=null,Ua=270;a.ude.page.testcase.caseDesign}(jQuery),function(a){function b(){a("#addAppMenuTreeBtn").click(j),a("#delAppMenuTreeBtn").click(k),a("#editAppMenuTreeBtn").click(n),a("#saveAppMenuTreeBtn").click(u),a("#cancelEditMenuTreeBtn").click(i),h(),g(),c(),a.ude.page.testcase.caseDesign.main.setData(null),a.ude.page.testcase.caseDesign.main.setDataM(null),a.ude.page.testcase.caseDesign.eventjs.initEventGrid(),a("#menuId").parentsUntil(".container").hide(),a("#caseLoadeOut_caseM").hide(),a("#setValueType").hide()}function c(){var b="<div id='runMethod' class='common-buttons-item opt-runscript' title='\u8fd0\u884c\u65b9\u6cd5'></div>",c="<div id='runEvent' class='common-buttons-item opt-runscript' title='\u8fd0\u884c\u6b65\u9aa4'></div>";a("#caseEditEvent .common-right").append(c),a("#caseEditMethod .common-right").append(b),a(document).off("click","#runMethod"),a(document).off("click","#runEvent"),a(document).on("click","#runMethod",function(a){d()}),a(document).on("click","#runEvent",function(a){e()}),a("#addEventBtn").hide()}function d(){var b=a("#methodTable").udeTable().fnGetSelectedRowData();if(null==b)return void showMessage("\u8bf7\u9009\u62e9\u8981\u6267\u884c\u7684\u65b9\u6cd5",null,"error");for(var c=[],d=a("#eventTable").udeTable().fnGetData(),e=0;e<d.length;e++){var g=d[e],h={},i=g.name,j=g.operActionId,k=g.varValue,l=g.wait;if(k||(k=""),i)try{var m=JSON.parse(g.name.replace(/'/g,'"'));h.selector=m.xpath,h.action=j,h.scriptValue=k,h.waitTime=l,c.push(h)}catch(a){return void showMessage("\u6240\u9009\u62e9\u7684\u65b9\u6cd5\u5305\u542b\u65e0\u6cd5\u5355\u6b65\u6267\u884c\u7684\u6b65\u9aa4\uff0c\u8bf7\u68c0\u67e5\u76ee\u6807\u63a7\u4ef6\u7684\u6807\u8bc6",null,"error")}else h.selector="",h.action=j,h.scriptValue=k,h.waitTime=l,c.push(h)}f(c)}function e(){var b=[],c=a("#eventTable").udeTable().fnGetSelectedRowData();if(null==c)return void showMessage("\u8bf7\u9009\u62e9\u8981\u6267\u884c\u7684\u6b65\u9aa4",null,"error");var d={},e=c.name,g=c.operActionId,h=c.varValue,i=c.wait;if(h||(h=""),e)try{var j=JSON.parse(c.name.replace(/'/g,'"'));d.selector=j.xpath,d.action=g,d.scriptValue=h,d.waitTime=i,b.push(d)}catch(a){return void showMessage("\u6240\u9009\u62e9\u7684\u6b65\u9aa4\u65e0\u6cd5\u5355\u6b65\u6267\u884c\uff0c\u8bf7\u68c0\u67e5\u76ee\u6807\u63a7\u4ef6\u7684\u6807\u8bc6",null,"error")}else d.selector="",d.action=g,d.scriptValue=h,d.waitTime=i,b.push(d);f(b)}function f(b){var c="",d=function(d){if(c=d.getParameter("appiumSessionId"),!c)return void showMessage("\u8bf7\u8fde\u63a5\u6d4b\u8bd5\u8bbe\u5907\uff01",null,"error");var f=b.splice(0,1);a.ude.rpc.testcaseRpc.execScript(c,f[0].selector,f[0].action,f[0].scriptValue,f[0].waitTime,e)},e=function(d){if(0==b.length)a.ude.page.testcase.caseDesign.main.refreshImage();else{var f=b.splice(0,1);a.ude.rpc.testcaseRpc.execScript(c,f[0].selector,f[0].action,f[0].scriptValue,f[0].waitTime,e)}};a.ude.rpc.testcaseRpc.getAppiumSession(d)}function g(){a.ude.pageResizeHandler=function(){a.ude.util.pageResize(),a("#caseTable").udeTable().fnResize(),a("#mainContentArea").css("height","100%"),a("#caseEditMethodDown").css("height",a("#caseEditMethod").height()-a(".common-content-top").outerHeight()-4),a("#caseEditEventDown").css("height",a("#caseEditEvent").height()-a(".common-content-top").outerHeight()-4),a("#page_object_container").css("height",a("#pageObjectDiv").height()-a(".common-content-top").outerHeight()-8),a(".table_container").css("height",a("#pageObjectDiv").height()-a(".common-content-top").outerHeight()-60),a("#case_container").css("height",a("#caseTableDiv").height()-a(".common-content-top").outerHeight()-8)}}function h(){a("#mainContentArea").css("height","100%"),a("#caseEditMethodDown").css("height",a("#caseEditMethod").height()-a(".common-content-top").outerHeight()-4),a("#caseEditEventDown").css("height",a("#caseEditEvent").height()-a(".common-content-top").outerHeight()-4),a("#page_object_container").css("height",a("#pageObjectDiv").height()-a(".common-content-top").outerHeight()-8),a(".table_container").css("height",a("#pageObjectDiv").height()-a(".common-content-top").outerHeight()-60),a("#case_container").css("height",a("#caseTableDiv").height()-a(".common-content-top").outerHeight()-8)}function i(){a.ude.dialog.close()}function j(){var b=s();if(!b)return void showMessage("\u8bf7\u9009\u62e9\u7236\u8282\u70b9\u3002",null,"error");var c=p(b);if(0==c)return void showMessage("\u4e0d\u80fd\u5728\u6839\u8282\u70b9\u4e0a\u6dfb\u52a0\u5b50\u8282\u70b9\u3002",null,"error");b.pageType;A=b.menuId,a("#menuPageName").val(""),a("#desc").val(""),a("#menuPageName").focus(),y="add",a.ude.dialog.open("appMenuTreeDialog",{title:"\u65b0\u589e\u83dc\u5355",width:"700px"})}function k(){var b=s();if(!b)return void showMessage("\u8bf7\u9009\u62e9\u8981\u5220\u9664\u7684\u8282\u70b9\uff01",null,"error");var c=q(b);return 0==c?void showMessage("\u8be5\u8282\u70b9\u4e0d\u80fd\u5220\u9664\uff01",null,"error"):void a.ude.util.confirm(a.i18n.prop("ude.page.config.projectStructure.projectStructureJs.delMenuTree_confirm")+"\uff1f",l)}function l(){if("menu"===x){var b=a("#menuTree").udeTree().getSelectedNode();a("#menuTree").udeTree().removeNode(b);var c=b.menuId;a.ude.rpc.projectStructure.delTreeNode(m,c)}else{var b=a("#notMenuTree").udeTree().getSelectedNode();a("#notMenuTree").udeTree().removeNode(b);var c=b.menuId;a.ude.rpc.projectStructure.delTreeNode(m,c)}}function m(b){a("#menuTree").udeTree().selectNode("-1"),showMessage(a.i18n.prop("ude.page.config.projectStructure.projectStructureJs.delTreeNodeSuccess_showMessage"),null,"info")}function n(){var b=s();if(!b)return void showMessage("\u8bf7\u9009\u62e9\u8981\u7f16\u8f91\u7684\u8282\u70b9\uff01",null,"error");var c=r(b);return 0==c?void showMessage("\u6240\u9009\u62e9\u7684\u8282\u70b9\u4e0d\u80fd\u8fdb\u884c\u7f16\u8f91\uff01",null,"error"):("menu"===x?pageType=1:pageType=2,z=b.id,A=b.menuId,B=b.parentMenuId,a.ude.rpc.projectStructure.getQueryMenuTreeNode(o,z,A,pageType),y="update",void a.ude.dialog.open("appMenuTreeDialog",{title:"\u7f16\u8f91\u83dc\u5355",width:"700px"}))}function o(b){var c=b.getDataStore("menuTreeNodeStore");a("#menuPageName").val(c.getRowSet().getRow(0).data.menuName),a("#desc").val(c.getRowSet().getRow(0).data.description)}function p(a){var b=a.menuId,c=a.parentMenuId;return"-1"!==b&&"-1"!==c}function q(a){var b=a.parentMenuId,c=a.menuId;if("-1"===c||"-1"===b)return!1;var d=t(b);if(!d)return!1;var e=d.parentMenuId;return"-1"!==e}function r(a){var b=a.parentMenuId,c=a.menuId;return"-1"!==c&&"-1"!==b}function s(){var b,c=a("#menuId").parent().hasClass("active");return x=c?"menu":"notMenu","menu"==x?b=a("#menuTree").udeTree().getSelectedNode():"notMenu"==x&&(b=a("#notMenuTree").udeTree().getSelectedNode()),b}function t(b){var c,d=a("#menuId").parent().hasClass("active");return x=d?"menu":"notMenu","menu"==x?c=a("#menuTree").udeTree().getNodeByMenuId(b):"notMenu"==x&&(c=a("#notMenuTree").udeTree().getNodeByMenuId(b)),c}function u(){var b=s(),c=w();if(c){var d={};if("add"==y){var e=(new Date).getTime();d.menuId=String(e),d.parentMenuId=A}else"update"===y&&(d.id=z,d.menuId=A,d.parentMenuId=B);d.leaf="1",d.menuName=a("#menuPageName").val(),d.nodeUrl="",d.pageType=b.pageType,d.isEnabled="T",d.analyseKind="manual",d.description=a.trim(a("#desc").val()),"menu"===x?d.ismenu="1":d.ismenu="2";var f="com.neusoft.utf.portal.config.projectstructure.entity.UtfProjectAnalyseResult",g=new DataCenter,h=new DataStore(f);h.setRowSetName(f),h.getRowSet().addRow(d),g.addDataStore(h),pageDC=g,a.ude.rpc.projectStructure.saveMenuTreeData(v,g)}}function v(b){var c=null;c="menu"===x?a("#menuTree").udeTree().getSelectedNode():a("#notMenuTree").udeTree().getSelectedNode();var d=b.getDataStore("utfProjectAnalyseResultList"),e=d.getRowSet().getRowCount();d.getRowSet().getRow(0).setItemValue("name",d.getRowSet().getRow(0).getItemValue("menuName"));var f=d.getRowSet().getRow(0).getData();if(e>0)if("add"===y)if("menu"===x){a("#menuTree").udeTree().addNode(c,f);var g=a("#menuTree").udeTree().getSelectedNode().tId;a("#"+g+" a").click()}else{a("#notMenuTree").udeTree().addNode(c,f);var g=a("#notMenuTree").udeTree().getSelectedNode().tId;a("#"+g+" a").click()}else"update"===y&&("menu"===x?(c.name=d.getRowSet().getRow(0).getData().name,c.nodeUrl=d.getRowSet().getRow(0).getData().nodeUrl,c.pageType=d.getRowSet().getRow(0).getData().pageType,c.isEnabled=d.getRowSet().getRow(0).getData().isEnabled,c.analyseKind=d.getRowSet().getRow(0).getData().analyseKind,c.description=d.getRowSet().getRow(0).getData().description,a("#menuTree").udeTree().updateNode(c)):(c.name=d.getRowSet().getRow(0).getData().name,c.nodeUrl=d.getRowSet().getRow(0).getData().nodeUrl,c.pageType=d.getRowSet().getRow(0).getData().pageType,c.isEnabled=d.getRowSet().getRow(0).getData().isEnabled,c.analyseKind=d.getRowSet().getRow(0).getData().analyseKind,c.description=d.getRowSet().getRow(0).getData().description,a("#notMenuTree").udeTree().updateNode(c)));return y="update",b?("0"===b.getCode()?(showMessage(a.i18n.prop("ude.page.config.projectStructure.projectStructureJs.saveMenuTreeDataSuccess_success"),null,"info"),projectAnalyseDC=b):showMessage(b.getDetail(),null,"error"),void a.ude.dialog.close()):void showMessage(a.i18n.prop("ude.page.config.projectStructure.projectStructureJs.saveMenuTreeDataSuccess_fail"),null,"error")}function w(){var b=a("#menuPageName").val();return!(!b||""===b)||(showMessage(a.i18n.prop("ude.page.config.projectStructure.projectStructureJs.checkAvailability_menuPageName")+"\uff01",null,"error"),a("#menuPageName").focus(),!1)}a.ude.page.testcase.appCaseDesign.main={init:b};var x="menu",y="",z="",A="",B=""}(jQuery),function(a){a.execute={testConn:function(a,b){var c=new DataCenter;c.addParameter("url",b);var d={};d.url=appPath+"/utf/execute/testConnection.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},ifExistReport:function(a,b){var c=new DataCenter;c.addParameter("projectId",a),c.addParameter("projectName",b);var d={};d.url=appPath+"/utf/execute/ifExistReport.action",d.sync=!0,$.maf.action.requestData(d,c,!1)},initExecResult:function(a,b,c){var d=new DataCenter;d.addParameter("projectId",b),d.addParameter("projectName",c);var e={};e.url=appPath+"/utf/execute/getExecResult.action",e.sync=!1,e.load=a,$.maf.action.requestData(e,d,!1)},getSceneByProject:function(a,b){var c=new DataCenter;c.addParameter("projectId",b);var d={};d.url=appPath+"/utf/execute/getScene.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},getSceneByProjectNoSceneCase:function(a,b){var c=new DataCenter;c.addParameter("projectId",b);var d={};d.url=appPath+"/utf/execute/getSceneByProjectNoSceneCase.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},getMoreConfig:function(a,b){var c=new DataCenter;c.addParameter("projectId",b);var d={};d.url=appPath+"/utf/execute/getMore.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},execScene:function(a,b,c,d,e){a.addParameter("mark",d),a.addParameter("projectName",b),a.addParameter("recordId",c),a.addParameter("executeTime",e);var f={};f.url=appPath+"/utf/execute/execScene.action",f.sync=!1,$.maf.action.requestData(f,a)},saveExecConfig:function(a,b){var c={};c.url=appPath+"/utf/execute/saveExecConfig.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},createXML:function(a,b,c,d){var e={};b.addParameter("projectName",c),b.addParameter("flag",d),e.url=appPath+"/utf/execute/createXML.action",e.sync=!1,e.load=a,$.maf.action.requestData(e,b)},createAppAndExe:function(a,b,c,d){var e={};b.addParameter("projectName",c),b.addParameter("executeTime",d),e.url=appPath+"/utf/execute/createAppAndExecuteFile.action",e.sync=!1,e.load=a,$.maf.action.requestData(e,b)},createDataExcel:function(a,b,c,d){var e={};b.addParameter("projectName",c),b.addParameter("executeTime",d),e.url=appPath+"/utf/execute/createDataExcel.action",e.sync=!1,e.load=a,$.maf.action.requestData(e,b)},createPtScript:function(a,b,c,d,e,f){var g=new DataCenter;g.addParameter("webroot",b),g.addParameter("ifV4Flag",c),g.addParameter("projectName",d),g.addParameter("projectId",e),g.addParameter("flag",f);var h={};h.url=appPath+"/utf/execute/createPtScript.action",h.sync=!1,h.load=a,$.maf.action.requestData(h,g)},getIfV4:function(a){var b=new DataCenter,c={};c.url=appPath+"/utf/execute/getIfV4.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},packageDownload:function(a,b,c,d){var e=new DataCenter;e.addParameter("projectId",b),e.addParameter("projectName",c),e.addParameter("executeTime",d);var f={};f.url=appPath+"/utf/execute/packageDownload.action",f.sync=!1,f.load=a,$.maf.action.requestData(f,e)},lookReportOnLine:function(a,b,c,d){var e=new DataCenter;e.addParameter("fileName",b),e.addParameter("startTime",c),e.addParameter("projectName",d);var f={};f.url=appPath+"/utf/execute/lookReportOnLine.action",f.sync=!1,f.load=a,$.maf.action.requestData(f,e)},downLoadReport:function(a,b,c){var d=new DataCenter;d.addParameter("startTime",b),d.addParameter("projectName",c);var e={};e.url=appPath+"/utf/execute/downLoadReport.action",e.sync=!1,e.load=a,$.maf.action.requestData(e,d)},deleteRecord:function(a,b){var c=new DataCenter;c.addParameter("id",b);var d={};d.url=appPath+"/utf/execute/deleteRecord.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},getCurrentProject:function(a){var b=new DataCenter,c={};c.url=appPath+"/utf/execute/getCurrentProject.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},getSingleResult:function(a,b,c){var d=new DataCenter;d.addParameter("projectId",b),d.addParameter("recordId",c);var e={};e.url=appPath+"/utf/execute/getSingleResult.action",e.sync=!1,e.load=a,$.maf.action.requestData(e,d);
},getExecuteProgress:function(a,b,c){var d=new DataCenter;d.addParameter("projectId",b),d.addParameter("recordId",c);var e={};e.url=appPath+"/utf/execute/getExecuteProgress.action",e.sync=!1,e.load=a,$.maf.action.requestData(e,d)},updateEndTime:function(a){var b=new DataCenter;b.addParameter("id",a);var c={};c.url=appPath+"/utf/execute/updateEndTime.action",c.sync=!0,$.maf.action.requestData(c,b)},getUrl:function(a){var b=new DataCenter,c={};c.url=appPath+"/utf/execute/getUrl.action",c.sync=!0,c.load=a,$.maf.action.requestData(c,b)},initBrowserType:function(a){var b=new DataCenter,c={};c.url=appPath+"/utf/execute/initBrowserType.action",c.sync=!0,c.load=a,$.maf.action.requestData(c,b)},getIpListByBrowserType:function(a,b){var c=new DataCenter;c.addParameter("browserType",a);var d={};d.url=appPath+"/utf/execute/getIpListByBrowserType.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},checkDataIntegrity:function(a,b){var c={};c.url=appPath+"/utf/execute/checkDataIntegrity.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},getParamGroupBySceneId:function(a,b){var c=new DataCenter;c.addParameter("sceneId",a);var d={};d.url=appPath+"/utf/execute/getParamGroupBySceneId.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},addSceneAndMethod:function(a,b){var c={};c.url=appPath+"/utf/testcase/caseDesign/caseMobile/addSceneAndMethod.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},createXMLForAPP:function(a,b,c,d,e){var f={};b.addParameter("projectName",c),b.addParameter("flag",d),b.addParameter("paramGroup",e),f.url=appPath+"/utf/execute/createXMLForAPP.action",f.sync=!1,f.load=a,$.maf.action.requestData(f,b)},saveExecResult:function(a,b){var c={};c.url=appPath+"/utf/execute/saveExecResult.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},saveExecResultBasicInfo:function(a,b){var c={};c.url=appPath+"/utf/execute/saveExecResultBasicInfo.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},updateMobileExecInfo:function(a,b,c){var d=new DataCenter,e={};e.url=appPath+"/utf/execute/updateMobileExecInfo.action",e.sync=!1,e.load=c,d.addParameter("eventResultIds",a),d.addParameter("results",b),$.maf.action.requestData(e,d)}}}($.ude.rpc),function(a){function b(){i(),j(),a("#addMethodToSceneBtnExec").bind("click",function(){n(),a("#sceneMethodsTbodyExec").append("<tr class='tr' align='center'><td class='td'><input type='checkbox' name='' value='methodSeclect'/></td><td class='td'><input style='width:340px;'  type='text' ></input></td></tr>");var b=a("#sceneMethodsTbodyExec").find("td:last-child").find("input").last();b.udeSelect().setData(p)}),a("#deletMethodToSceneBtnExec").bind("click",function(){var b=o();for(var c in b)b[c]&&a(b[c]).remove();n("del")}),a("#moveupMethodBtnExec").bind("click",function(){var b=o();1!==b.length?showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.initBindFunction_moveMethod_showMessage"),a("#sceneChooseDialog"),"error"):a(b[0]).prev()[0]?a(b[0]).insertBefore(a(b[0]).prev()):showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.initBindFunction_moveupMethodBtn"),a("#sceneChooseDialog"),"error")}),a("#movedownMethodBtnExec").bind("click",function(){var b=o();1!==b.length?showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.initBindFunction_moveMethod_showMessage"),a("#sceneChooseDialog"),"error"):a(b[0]).next()[0]?a(b[0]).insertAfter(a(b[0]).next()):showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.initBindFunction_movedownMethodBtn"),a("#sceneChooseDialog"),"error")}),a("#downloadSceneBtn").bind("click",function(){c()})}function c(){q="",r="";for(var b=document.getElementById("sceneMethodsTbodyExec").innerHTML,c=b.split("select2-chosen"),e=1;e<c.length;e++){var h="",i=c[e].substring(0,1);h='"'==i?c[e].substring(2,c[e].length):c[e].substring(1,c[e].length);var j=h.indexOf("</span>");if(j==-1&&(j=h.indexOf("</SPAN>")),h=h.substring(0,j),""!=h){for(var k=0;k<p.length;k++)p[k].name===h&&(q+=p[k].id+",");r+=h+","}}""!=r&&(r=r.substring(0,r.length-1)),""!=q&&(q=q.substring(0,q.length-1)),f()&&(g(),a.ude.rpc.execute.checkDataIntegrity(d,w))}function d(b){if(b){var c=b.getParameter("checkMessage");""!=c?(c=c.replace(new RegExp(";;","gm"),"<br/>"),a.ude.util.confirm(a.i18n.prop("ude.page.execute.isContinue")+"<br/>"+c,e)):(e(),a.ude.dialog.close())}}function e(b){var c,d=function(b){var c=b.getParameter("executeTime");a.ude.rpc.execute.createDataExcel(e,w,t,c)},e=function(b){var c=b.getParameter("executeTime");a.ude.rpc.execute.createAppAndExe(f,w,t,c)},f=function(b){var d=b.getParameter("executeTime");a.ude.rpc.execute.packageDownload(c,s,t,d)};c=function(a){window.location.href="/utf"+a.getParameter("filePath")},a.ude.rpc.execute.createXML(d,w,t,"downLoad")}function f(){return!(!r||""===r)||(showMessage(a.i18n.prop("ude.page.execute.checkAvailability_sceneStr")+"\uff01",null,"error"),!1)}function g(){u.url="",u.browserType="",u.sceneId=h(),u.testKind="1",u.projId=s,u.assignIpAddr="",u.moreConfig="",x.setRowSetName(v),x.getRowSet().addRow(u),w.addDataStore(x)}function h(){for(var a=r,b=a.split(","),c=q.split(","),d=r.split(","),e="",f=!0,g=0;g<b.length;g++){var h=d.indexOf(b[g]);h!=-1&&(f?(e+=c[h],f=!1):e=e+","+c[h])}return e}function i(){var b=function(a){if(a){var b=a.getParameter("project");s=b[0],t=b[1]}};a.ude.rpc.execute.getCurrentProject(b)}function j(){var b="<div title='\u4e0b\u8f7d\u573a\u666f' class='common-buttons-item opt-export' id='downloadScene'></div>";a("#sceneContent .common-content-top .common-right").append(b),a(document).off("click","#downloadScene"),a(document).on("click","#downloadScene",function(a){k()})}function k(){a("#sceneMethodsTbodyExec").html(""),a("#Dialog_sceneMethodsDivExec").css("height","auto"),a.ude.dialog.open("sceneChooseDialog",{title:a.i18n.prop("ude.page.execute.chooseScene_title"),width:"490px"}),a.ude.rpc.execute.getSceneByProject(l,s)}function l(a){var b=a.getDataStore("testCase"),c=b.parameters.data;m(c)}function m(b){if(p=b,""!=q){for(var c=q.split(","),d=0;d<c.length;d++)for(var e=0;e<p.length;e++)if(c[d]==p[e].id){n(),a("#sceneMethodsTbodyExec").append("<tr class='tr' align='center'><td class='td'><input type='checkbox' name='' value='methodSeclect'/></td><td class='td'><input style='width:340px;'  type='text' ></input></td></tr>");var f=a("#sceneMethodsTbodyExec").find("td:last-child").find("input").last();f.udeSelect().setData(p),f.udeSelect().setValue(p[e].id)}}else a("#addMethodToSceneBtnExec").click()}function n(b){var c=a("#sceneChooseDialog").parent().offset().top,d=a("#sceneChooseDialog").parent().height(),e=document.body.clientHeight,f=e-d-c,g=a("#Dialog_sceneMethodsDivExec")[0].scrollHeight,h=a("#Dialog_sceneMethodsDivExec")[0].clientHeight,i=g>h;f<30&&("del"!==b||i)?a("#Dialog_sceneMethodsDivExec").css("height",a("#Dialog_sceneMethodsDivExec").height()):a("#Dialog_sceneMethodsDivExec").css("height","auto")}function o(){var b=a("#sceneMethodsTbodyExec").children(),c=[],d=0,e=0;for(e=0;b[e];e++)a(b[e]).find("input")[0].checked===!0&&(c[d++]=b[e]);return c}a.ude.page.testcase.appSceneExec.main={init:b};var p=null,q="",r="",s="",t="",u={},v="com.neusoft.utf.portal.execute.entity.UtfTestExecutionT",w=new DataCenter,x=new DataStore(v),q="",r=""}(jQuery),function(a){function b(){a.ude.page.config.projectStructure.main.getIfCheckFlag(!1),a.ude.page.config.projectStructure.main.init(),f(),a.ude.page.config.projectStructure.main.udeTreeClick(function(){var b=new DataCenter,c=new DataStore(B);c.setRowSetName(B);var d=a.ude.page.config.projectStructure.main.treeAttribution(),e=d.menuId,f=d.ismenu;b.addParameter("caseId",e),b.addParameter("pageType",f),c.getRowSet().addRow(d),b.addDataStore(c),C=b,a.ude.rpc.pageObject.getPageElement(b,r)}),d(),a.ude.rpc.testcaseRpc.getIncludeFrame(c)}function c(b){if(b){var c=b.getDataStore("utfProjectInfoTResult"),d=c.getRowSet().getRow(0).data;"1"===d.perserve01?(a("#belongFrameTr").hide(),I=!1):(a("#belongFrameTr").show(),I=!0),p(null)}}function d(){a.ude.rpc.pageObject.getInitData(null,e)}function e(b){if(b&&"0"===b.getCode()){var c=b.getDataStore("elementTypeList").getRowSet().getData();G=a("#elementType").udeSelect({onChange:function(){var b=a("#elementType").udeSelect().getNameValue().toLowerCase();"gridcell"===b||"gridrow"===b||"treenode"===b?(a("#textTr").hide(),a("#gridTr").show(),"gridcell"===b?(a("#gridIdTitleId").show(),a("#rowIdTitleId").show(),a("#treeIdTitleId").hide(),a("#treeNodeIdTitleId").hide(),a("#columnIdTitleTd").show(),a("#columnIdTextTd").show()):"gridrow"===b?(a("#gridIdTitleId").show(),a("#rowIdTitleId").show(),a("#treeIdTitleId").hide(),a("#treeNodeIdTitleId").hide(),a("#columnIdTitleTd").hide(),a("#columnIdTextTd").hide()):(a("#gridIdTitleId").hide(),a("#rowIdTitleId").hide(),a("#treeIdTitleId").show(),a("#treeNodeIdTitleId").show(),a("#columnIdTitleTd").hide(),a("#columnIdTextTd").hide())):(a("#textTr").show(),a("#gridTr").hide())}}),G.setData(c)}}function f(){a("#deletePageObject").bind("click",function(){m()}),a("#addPageObject").bind("click",function(){h()}),a("#savePageObject").bind("click",function(){j()}),a("#downloadMetaXML").bind("click",function(){v()}),a("#objectTabs a[href='#singleObjDiv']").click(function(b){b.preventDefault(),a(this).tab("show"),a("#addPageObject").show(),a("#deletePageObject").show(),a("#saveMultiObject").hide(),a("#pageObjectTable").udeTable().fnResize()}),a("#objectTabs a[href='#multiObjDiv']").click(function(b){b.preventDefault(),a(this).tab("show"),a("#addPageObject").hide(),a("#deletePageObject").hide(),a("#saveMultiObject").show()}),a("#saveMultiObject").bind("click",function(){y()})}function g(){a("#elementName").attr("value",""),a("#belongFrame").attr("value",""),a("#analyseKind").attr("value",""),a("#description").attr("value",""),a("#girdId").attr("value",""),a("#rowId").attr("value",""),a("#columnId").attr("value","")}function h(){var b=a.ude.page.config.projectStructure.main.treeAttribution(),c=b.pageType,d=b.menuId;"-1"===d||"listMenu"===c?showMessage(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.addPageObject_showMessage")+"\uff01",null,"error"):(a("#pageObjectDialog").prop("add",!0),g(),a.ude.dialog.open("pageObjectDialog",{title:a.i18n.prop("ude.page.config.pageObject.pageObjectJs.addPageObject_title"),width:"500px"}))}function i(){var b=a("#elementType").val();if(!b||""===b)return showMessage(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.checkAvailability_elementType")+"\uff01",a("#pageObjectDialog"),"error"),a("#elementType").focus(),!1;var c="";if("gridcell"===b.toLowerCase()){var d=a("#rowId").val(),e=a("#columnId").val();if(!d||""===d||!e||""===e)return showMessage(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.checkAvailability_elementName"),a("#pageObjectDialog"),"error"),void a("#girdId").focus();c=a.trim(a("#girdId").val())+","+a.trim(a("#rowId").val())+","+a.trim(a("#columnId").val())}else if("gridrow"===b.toLowerCase()||"treenode"===b.toLowerCase()){var d=a("#rowId").val();if(!d||""===d)return showMessage(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.checkAvailability_elementName"),a("#pageObjectDialog"),"error"),void a("#girdId").focus();c=a.trim(a("#girdId").val())+","+a.trim(a("#rowId").val())}else if(c=a.trim(a("#elementName").val()),!c||""===c)return showMessage(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.checkAvailability_elementName"),a("#pageObjectDialog"),"error"),void a("#elementName").focus();return!(c.indexOf('"')>0)||void showMessage("\u63a7\u4ef6\u6807\u793a\u4e2d\u4e0d\u80fd\u5b58\u5728\u53cc\u5f15\u53f7",a("#pageObjectDialog"),"error")}function j(){var b=i();if(b){var c=(new DataCenter,a("#elementType").val()),d=a.trim(a("#belongFrame").val()),e=a.trim(a("#analyseKind").val()),f=a.trim(a("#description").val()),g="";if(g="gridcell"===c.toLowerCase()?a.trim(a("#girdId").val())+","+a.trim(a("#rowId").val())+","+a.trim(a("#columnId").val()):"gridrow"===c.toLowerCase()||"treenode"===c.toLowerCase()?a.trim(a("#girdId").val())+","+a.trim(a("#rowId").val()):a.trim(a("#elementName").val()),a("#pageObjectDialog").prop("add")){var h={};h.elementType=c,h.name=g,h.belongFrame=d,h.analyseKind=e,h.description=f,h.analyseKind="manual",ds=new DataStore(D),ds.setRowSetName(D),ds.getRowSet().addRow(h)}else H.elementType=c,H.name=g,H.belongFrame=d,H.description=f,H.analyseKind="manual",ds=new DataStore(D),ds.setRowSetName(D),ds.getRowSet().addRow(H);var j=new DataStore(B);j.setRowSetName(B);var l=a.ude.page.config.projectStructure.main.treeAttribution();j.getRowSet().addRow(l),a.ude.rpc.pageObject.savePageObject(ds,j,function(b){"0"==b.header.code?k(b):showMessage(a.i18n.prop(b.header.message.detail),null,"error")})}}function k(b){a.ude.dialog.close(),showMessage("\u64cd\u4f5c\u6210\u529f\u3002",null,"info");var c=b.getDataStore(D).getRowSet().getData();a("#pageObjectTable").udeTable().fnRedraw(c)}function l(){if(H=a("#pageObjectTable").udeTable().fnGetSelectedRowData(),null==H)return void showMessage(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.editPageObject_showMessage"),null,"error");g();var b=H.elementType,c=H.name;G.udeSelect().setValue(b);var d=b.toLowerCase();if("gridcell"===d||"gridrow"===d||"treenode"===d?(a("#textTr").hide(),a("#gridTr").show(),"gridcell"===d?(a("#gridIdTitleId").show(),a("#rowIdTitleId").show(),a("#treeIdTitleId").hide(),a("#treeNodeIdTitleId").hide(),a("#columnIdTitleTd").show(),a("#columnIdTextTd").show()):"gridrow"===d?(a("#gridIdTitleId").show(),a("#rowIdTitleId").show(),a("#treeIdTitleId").hide(),a("#treeNodeIdTitleId").hide(),a("#columnIdTitleTd").hide(),a("#columnIdTextTd").hide()):(a("#gridIdTitleId").hide(),a("#rowIdTitleId").hide(),a("#treeIdTitleId").show(),a("#treeNodeIdTitleId").show(),a("#columnIdTitleTd").hide(),a("#columnIdTextTd").hide())):(a("#textTr").show(),a("#gridTr").hide()),"gridcell"===d){var e=c.split(",");3==e.length?(a("#girdId").val(e[0]),a("#rowId").val(e[1]),a("#columnId").val(e[2])):(a("#girdId").val(""),a("#rowId").val(""),a("#columnId").val(""))}else if("gridrow"===d||"treenode"===d){var e=c.split(",");2==e.length?(a("#girdId").val(e[0]),a("#rowId").val(e[1])):(a("#girdId").val(""),a("#rowId").val(""))}else a("#elementName").val(c);a("#belongFrame").val(H.belongFrame),a("#description").val(H.description),a("#pageObjectDialog").prop("add",!1),a.ude.dialog.open("pageObjectDialog",{title:a.i18n.prop("ude.page.config.pageObject.pageObjectJs.editPageObject_title"),width:"500px"})}function m(){var b=a("input[name='check']:checked");if(!(b.length>0))return void showMessage(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.deletePageObject_showMessage"),null,"error");a(b).each(function(){F.push(this.value)});for(var c=0;c<F.length;c++)C.addParameter(F[c],F[c]);a.ude.util.confirm(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.deletePageObject_confirm")+"\uff1f",n)}function n(){a.ude.rpc.pageObject.deletePageObject(C,o)}function o(b){if(b&&"0"===b.getCode()){var c=b.getDataStore(D).getRowSet().getData();a("#pageObjectTable").udeTable().fnRedraw(c),showMessage(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.deletePageObjectComplete"),null,"info")}else{var d=b.getDetail();showMessage(d,null,"error")}}function p(b){a("#pageObjectTable").udeTable({data:b,columns:[{sTitle:"",mData:"id",sWidth:"5%",bSort:!1,mRender:u},{sTitle:a.i18n.prop("ude.page.config.pageObject.pageObjectJs.setData_elementType"),mData:"elementType",sWidth:"15%"},{sTitle:a.i18n.prop("ude.page.config.pageObject.pageObjectJs.setData_name"),mData:"name",sWidth:"20%"},{sTitle:a.i18n.prop("ude.page.config.pageObject.pageObjectJs.setData_belongFrame"),mData:"belongFrame",sWidth:"20%",bVisible:!1},{sTitle:a.i18n.prop("ude.page.config.pageObject.pageObjectJs.setData_analyseKind"),mData:"analyseKind",sWidth:"15%",mRender:q},{sTitle:a.i18n.prop("ude.page.config.pageObject.pageObjectJs.setData_description"),mData:"description",sWidth:"45%"}],dblClick:function(a){l()}}),a("#pageObjectTable").udeTable().fnSetCheckbox("pageObjectTable")}function q(b,c){var d=a("<div style='text-align: left;'></div>");return"auto"===b?d.text(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.renderAnalyseKind_auto")):d.text(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.renderAnalyseKind_manual")),a("<div>").append(d).html()}function r(b){var c=b.getDataStore(D).getRowSet().getData();a("#pageObjectTable").udeTable().fnRedraw(c),a("#pageObjectTable").udeTable().fnResize();var d=new Array;s(d),a("input[name='pageObjectTable_chk_all']").attr("checked",!1),a("input[name='check']").attr("checked",!1),E=!1,a("input[name='pageObjectTable_chk_all']").unbind("click"),a("input[name='pageObjectTable_chk_all']").bind("click",function(){t()})}function s(b){for(var c=0;c<b.length;c++)b[c].editedName="["+b[c].elementType+"]"+b[c].name,null==b[c].description&&(b[c].description="");var d=a("#multiObjDiv");d.handsontable("destroy"),w(d,b)}function t(){E?(a("input[name='check']").attr("checked",!1),E=!1):(a("input[name='check']").attr("checked",!0),E=!0)}function u(b,c){var d=a("<div class='cell-widget' align='center'/>"),e=a("<input type='checkbox' name='check' value='"+b+"'/> ");return d.append(e),a("<div/>").append(d).html()}function v(){var b=new DataCenter,c=function(){a.ude.rpc.pageObject.downLoadMetaXML(b,d)},d=function(a){var b=a.getParameter("downLoadPath");window.location.href="/utf"+b};a.ude.rpc.pageObject.createMetaXML(b,c)}function w(b,c){var d=new Array;d.push(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.setData_name")),d.push(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.setData_description"));var e=new Array;e.push(450),e.push(450);var f=new Array;f.push({data:"editedName"}),f.push({data:"description"}),b.handsontable({data:c,minSpareRows:1,colHeaders:d,colWidths:e,manualColumnResize:!0,manualRowResize:!0,columnSorting:!0,rowHeaders:!0,contextMenu:{items:{row_above:{name:a.i18n.prop("testcase.paramjs.init.row_above")},row_below:{name:a.i18n.prop("testcase.paramjs.init.row_below")},remove_row:{name:a.i18n.prop("testcase.paramjs.init.remove_row")}}},columns:f,afterChange:function(a,b){"loadData"!==b&&x()},afterRemoveRow:function(a,b){"loadData"!==b&&x()},afterCreateRow:function(a,b){"loadData"!==b&&x()}})}function x(){}function y(){var b=a.ude.page.config.projectStructure.main.treeAttribution(),c=b.pageType,d=b.menuId;"-1"===d||"listMenu"===c?showMessage(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.addPageObject_showMessage")+"\uff01",null,"error"):a.ude.util.confirm(a.i18n.prop("ude.page.config.pageObject.pageObjectJs.isSaveMultiObject"),z)}function z(){var b=a.ude.page.config.projectStructure.main.treeAttribution(),c=b.menuId,d=JSON.stringify(a("#multiObjDiv").handsontable("getData"));a.ude.rpc.pageObject.saveMultiObject(d,c,A)}function A(b){if(b&&"0"==b.getCode()){showMessage("\u64cd\u4f5c\u6210\u529f\u3002",null,"info");var c=b.getDataStore(D).getRowSet().getData();a("#pageObjectTable").udeTable().fnRedraw(c),a("#pageObjectTable").udeTable().fnResize();var d=new Array;s(d),a("#objectTabs a[href='#singleObjDiv']").click()}else{var e=b.getDetail();showMessage(e,null,"error")}}var B="com.neusoft.utf.portal.config.projectstructure.entity.UtfProjectAnalyseResult",C=(new DataStore(B),new DataCenter),D="com.neusoft.utf.portal.config.pageobject.entity.UtfPageAnalyseResult",E=(new DataStore(D),new DataCenter,!1),F=new Array,G=null,H=null,I=!0;a.ude.page.config.pageObject.main={init:b}}(jQuery),function(a){a.pageObject={getInitData:function(a,b){var c={};c.url=appPath+"/utf/config/pageobject/getInitData.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},getPageElement:function(a,b){var c={};c.url=appPath+"/utf/config/pageobject/getPageElement.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},savePageObject:function(a,b,c){var d=new DataCenter;d.addDataStore(a),d.addDataStore(b);var e={};e.url=appPath+"/utf/config/pageobject/savePageObject.action",e.sync=!1,e.load=c,$.maf.action.requestData(e,d)},deletePageObject:function(a,b){var c={};c.url=appPath+"/utf/config/pageobject/deletePageObject.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},createMetaXML:function(a,b){var c={};c.url=appPath+"/utf/config/pageobject/createMetaXML.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},downLoadMetaXML:function(a,b){var c={};c.url=appPath+"/utf/config/pageobject/downLoadMetaXML.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},saveMultiObject:function(a,b,c){var d=new DataCenter;d.addParameter("multiObjectJson",a),d.addParameter("menuId",b);var e={};e.url=appPath+"/utf/config/pageobject/saveMultiObject.action",e.sync=!1,e.load=c,$.maf.action.requestData(e,d)}}}($.ude.rpc);