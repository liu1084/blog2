/* All right reserved by Neusoft Co. Ltd. 2016-10-14 10:10:41 */
!function(a){function b(){i(),h(),c(),e(),p()}function c(){a("#closeDialog").click(function(){f()}),a("#savePageReDetail").click(function(){g()}),a("#deleteRedetectBtn").click(function(){d()}),a("#closeCaseDialog").click(function(){a.ude.dialog.close()})}function d(){var b=a("#pageRedetectTable").udeTable().fnGetSelectedRowData();if(!b)return void showMessage(a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.deletePageReDetail_showMessage"),null,"error");var c=function(b){if(b&&"0"===b.getCode())showMessage(a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.deletePageReDetail_success"),null,"info"),a("#pageRedetectTable").udeTable().fnDeleteRow();else{var c=b.getDetail();showMessage(c,null,"error")}},d=function(){var d=b.id;a.ude.rpc.pageReDetect.deletePageReDetect(c,d)};a.ude.util.confirm(a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.deletePageReDetail_confirm")+"\uff1f",d)}function e(){a("#pageRedetectDetailTable").udeTable({data:null,columns:[{sTitle:a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.initReDetectDetailTable_menuId"),mData:"menuName",sWidth:"30%"},{sTitle:a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.initReDetectDetailTable_detectType"),mData:"detectType",mRender:m,sWidth:"10%"},{sTitle:a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.initReDetectDetailTable_elementName"),mData:"elementName",sWidth:"50%"},{sTitle:a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.initReDetectDetailTable_elementId"),mData:"elementId",sWidth:"10%",mRender:n}]})}function f(){a.ude.dialog.close()}function g(){var b=a("#pageRedetectDetailTable").udeTable().fnGetData(),c=a("#pageRedetectTable").udeTable().fnGetSelectedRowDataIndex(),d=a("#pageRedetectTable").udeTable().fnGetSelectedRowData(),e=b[0].redetectId,f=function(b){if(b&&"0"===b.getCode())a("#savePageReDetail").attr("disabled",!0),d.syncFlag="1",a("#pageRedetectTable").udeTable().fnUpdateRowByIndex(c,d),showMessage(a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.savePageReDetail"),null,"info");else{var e=b.getDetail();showMessage(e,null,"error")}};a.ude.rpc.pageReDetect.savePageReDetectDetail(f,e)}function h(){a(".common-content-down").css("height",a(".common-content").height()-a(".common-content-top").outerHeight())}function i(){var b=function(a){if(a&&"0"===a.getCode()){var b=a.getSingleDataStore();j(b.getRowSet().getData())}else{var c=a.getDetail();showMessage(c,null,"error")}};a.ude.rpc.pageReDetect.initPage(b)}function j(b){a("#pageRedetectTable").udeTable({data:b,columns:[{sTitle:a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.initPageReDetectLogTable_description"),mData:"description",sWidth:"50%"},{sTitle:a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.initPageReDetectLogTable_redetectPerson"),mData:"redetectPerson",sWidth:"25%"},{sTitle:a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.initPageReDetectLogTable_redetectDate"),mData:"redetectDate",sWidth:"25%"}],dblClick:function(a){k(a)}})}function k(b){var c=a("#pageRedetectTable").udeTable().fnGetSelectedRowDataIndex(),d=b.syncFlag;if("1"===d||c>0?a("#pageReDetectDetailDialog").prop("sync",!0):a("#pageReDetectDetailDialog").prop("sync",!1),!b)return!1;var e=b.id,f=function(a){if(a&&"0"===a.getCode()){var b=a.getSingleDataStore();l(b.getRowSet().getData())}else{var c=a.getDetail();showMessage(c,null,"error")}};a.ude.rpc.pageReDetect.getPageReDetectDetail(f,e)}function l(b){a.ude.dialog.open("pageReDetectDetailDialog",{title:a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.setPageReDetectDetailTable"),width:"1000px"}),a("#pageReDetectDetailDialog").prop("sync")?a("#savePageReDetail").attr("disabled",!0):a("#savePageReDetail").attr("disabled",!1),a("#pageRedetectDetailTable").udeTable().fnRedraw(b),a("[name = configGroup]:checkbox").bind("click",function(){a("#pageRedetectDetailTable").udeTable().dataTable().fnClearTable();for(var c=a("[name = configGroup]:checkbox").filter(":checked"),d=0;d<c.length;d++)for(var e=c[d].value,f=0;f<b.length;f++)b[f].detectType===e&&a("#pageRedetectDetailTable").udeTable().fnAddRow(b[f])})}function m(b){return"add"===b?a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.detectType_add"):a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.detectType_del")}function n(b){var c=jQuery.parseJSON(b),d=new Array,e=0;for(var f in c)a.inArray(c[f][4],d)===-1&&(d[e++]=c[f][4]);return b="<a href='#' onClick=$.ude.page.config.pageReDetect.main.casedialog() style='color:blue'>"+d.length+"</a>"}function o(){var b=a("#pageRedetectDetailTable").udeTable().fnGetSelectedRowData(),c=jQuery.parseJSON(b.elementId),d=new Array,e=0;for(var f in c)d[e++]=c[f];a.ude.dialog.open("pageReDetectCaseDialog",{title:a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.casedialog_title"),width:"400px"}),a("#pageReDetectCaseDialogTable").udeTable().fnRedraw(d)}function p(){a("#pageReDetectCaseDialogTable").udeTable({data:null,columns:[{sTitle:a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.pageReDetectCaseDialogTable_casename"),mData:"0",sWidth:"50%"},{sTitle:a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.pageReDetectCaseDialogTable_methodname"),mData:"1",sWidth:"20%"},{sTitle:a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.pageReDetectCaseDialogTable_eventname"),mData:"2",sWidth:"20%"},{sTitle:a.i18n.prop("ude.page.config.pageReDetect.pageReDetectJs.pageReDetectCaseDialogTable_eventorder"),mData:"3",sWidth:"10%"}]})}a.ude.page.config.pageReDetect.main={init:b,casedialog:o}}(jQuery),function(a){a.pageReDetect={initPage:function(a){var b={};b.url=appPath+"/utf/config/pageReDetect/getPageReDetectLog.action",b.sync=!1,b.load=a,$.maf.action.requestData(b)},getPageReDetectDetail:function(a,b){var c=new DataCenter;c.setParameter("logId",b);var d={};d.url=appPath+"/utf/config/pageReDetect/getPageReDetectDetail.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},deletePageReDetect:function(a,b){var c=new DataCenter;c.setParameter("id",b);var d={};d.url=appPath+"/utf/config/pageReDetect/deletePageReDetect.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},savePageReDetectDetail:function(a,b){var c=new DataCenter;c.setParameter("id",b);var d={};d.url=appPath+"/utf/config/pageReDetect/savePageReDetectDetail.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)}}}($.ude.rpc);