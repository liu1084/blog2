/* All right reserved by Neusoft Co. Ltd. 2016-10-14 09:10:53 */
!function(a){function b(){return a("<div/>")}var c=Math.abs,d=Math.max,e=Math.min,f=Math.round;a.imgAreaSelect=function(g,h){function i(a){return a+qa.left-ra.left}function j(a){return a+qa.top-ra.top}function k(a){return a-qa.left+ra.left}function l(a){return a-qa.top+ra.top}function m(a){return a.pageX-ra.left}function n(a){return a.pageY-ra.top}function o(a){var b=a||S,c=a||T;return{x1:f(ua.x1*b),y1:f(ua.y1*c),x2:f(ua.x2*b),y2:f(ua.y2*c),width:f(ua.x2*b)-f(ua.x1*b),height:f(ua.y2*c)-f(ua.y1*c)}}function p(a,b,c,d,e){var g=e||S,h=e||T;ua={x1:f(a/g||0),y1:f(b/h||0),x2:f(c/g||0),y2:f(d/h||0)},ua.width=ua.x2-ua.x1,ua.height=ua.y2-ua.y1}function q(){J&&ka.width()&&(qa={left:f(ka.offset().left),top:f(ka.offset().top)},N=ka.innerWidth(),O=ka.innerHeight(),qa.top+=ka.outerHeight()-O>>1,qa.left+=ka.outerWidth()-N>>1,V=f(h.minWidth/S)||0,W=f(h.minHeight/T)||0,X=f(e(h.maxWidth/S||1<<24,N)),Y=f(e(h.maxHeight/T||1<<24,O)),"1.3.2"!=a().jquery||"fixed"!=ta||va.getBoundingClientRect||(qa.top+=d(document.body.scrollTop,va.scrollTop),qa.left+=d(document.body.scrollLeft,va.scrollLeft)),ra=/absolute|relative/.test(P.css("position"))?{left:f(P.offset().left)-P.scrollLeft(),top:f(P.offset().top)-P.scrollTop()}:"fixed"==ta?{left:a(document).scrollLeft(),top:a(document).scrollTop()}:{left:0,top:0},L=i(0),M=j(0),(ua.x2>N||ua.y2>O)&&y())}function r(b){if($){switch(la.css({left:i(ua.x1),top:j(ua.y1)}).add(ma).width(ha=ua.width).height(ia=ua.height),ma.add(na).add(pa).css({left:0,top:0}),na.width(d(ha-na.outerWidth()+na.innerWidth(),0)).height(d(ia-na.outerHeight()+na.innerHeight(),0)),a(oa[0]).css({left:L,top:M,width:ua.x1,height:O}),a(oa[1]).css({left:L+ua.x1,top:M,width:ha,height:ua.y1}),a(oa[2]).css({left:L+ua.x2,top:M,width:N-ua.x2,height:O}),a(oa[3]).css({left:L+ua.x1,top:M+ua.y2,width:ha,height:O-ua.y2}),ha-=pa.outerWidth(),ia-=pa.outerHeight(),pa.length){case 8:a(pa[4]).css({left:ha>>1}),a(pa[5]).css({left:ha,top:ia>>1}),a(pa[6]).css({left:ha>>1,top:ia}),a(pa[7]).css({top:ia>>1});case 4:pa.slice(1,3).css({left:ha}),pa.slice(2,4).css({top:ia})}b!==!1&&(a.imgAreaSelect.onKeyPress!=xa&&a(document).unbind(a.imgAreaSelect.keyPress,a.imgAreaSelect.onKeyPress),h.keys&&a(document)[a.imgAreaSelect.keyPress](a.imgAreaSelect.onKeyPress=xa)),ya&&na.outerWidth()-na.innerWidth()==2&&(na.css("margin",0),setTimeout(function(){na.css("margin","auto")},0))}}function s(a){q(),r(a),_=i(ua.x1),aa=j(ua.y1),ba=i(ua.x2),ca=j(ua.y2)}function t(a,b){h.fadeSpeed?a.fadeOut(h.fadeSpeed,b):a.hide()}function u(a){var b=k(m(a))-ua.x1,c=l(n(a))-ua.y1;ja||(q(),ja=!0,la.one("mouseout",function(){ja=!1})),U="",h.resizable&&(c<=h.resizeMargin?U="n":c>=ua.height-h.resizeMargin&&(U="s"),b<=h.resizeMargin?U+="w":b>=ua.width-h.resizeMargin&&(U+="e")),la.css("cursor",U?U+"-resize":h.movable?"move":""),K&&K.toggle()}function v(b){a("body").css("cursor",""),(h.autoHide||ua.width*ua.height==0)&&t(la.add(oa),function(){a(this).hide()}),a(document).unbind("mousemove",z),la.mousemove(u),h.onSelectEnd(g,o())}function w(b){return 1==b.which&&(q(),U?(a("body").css("cursor",U+"-resize"),_=i(ua[/w/.test(U)?"x2":"x1"]),aa=j(ua[/n/.test(U)?"y2":"y1"]),a(document).mousemove(z).one("mouseup",v),la.unbind("mousemove",u)):h.movable?(Q=L+ua.x1-m(b),R=M+ua.y1-n(b),la.unbind("mousemove",u),a(document).mousemove(B).one("mouseup",function(){h.onSelectEnd(g,o()),a(document).unbind("mousemove",B),la.mousemove(u)})):ka.mousedown(b),!1)}function x(a){Z&&(a?(ba=d(L,e(L+N,_+c(ca-aa)*Z*(ba>_||-1))),ca=f(d(M,e(M+O,aa+c(ba-_)/Z*(ca>aa||-1)))),ba=f(ba)):(ca=d(M,e(M+O,aa+c(ba-_)/Z*(ca>aa||-1))),ba=f(d(L,e(L+N,_+c(ca-aa)*Z*(ba>_||-1)))),ca=f(ca)))}function y(){_=e(_,L+N),aa=e(aa,M+O),c(ba-_)<V&&(ba=_-V*(ba<_||-1),ba<L?_=L+V:ba>L+N&&(_=L+N-V)),c(ca-aa)<W&&(ca=aa-W*(ca<aa||-1),ca<M?aa=M+W:ca>M+O&&(aa=M+O-W)),ba=d(L,e(ba,L+N)),ca=d(M,e(ca,M+O)),x(c(ba-_)<c(ca-aa)*Z),c(ba-_)>X&&(ba=_-X*(ba<_||-1),x()),c(ca-aa)>Y&&(ca=aa-Y*(ca<aa||-1),x(!0)),ua={x1:k(e(_,ba)),x2:k(d(_,ba)),y1:l(e(aa,ca)),y2:l(d(aa,ca)),width:c(ba-_),height:c(ca-aa)},r(),h.onSelectChange(g,o())}function z(a){return ba=/w|e|^$/.test(U)||Z?m(a):i(ua.x2),ca=/n|s|^$/.test(U)||Z?n(a):j(ua.y2),y(),!1}function A(b,c){ba=(_=b)+ua.width,ca=(aa=c)+ua.height,a.extend(ua,{x1:k(_),y1:l(aa),x2:k(ba),y2:l(ca)}),r(),h.onSelectChange(g,o())}function B(a){return _=d(L,e(Q+m(a),L+N-ua.width)),aa=d(M,e(R+n(a),M+O-ua.height)),A(_,aa),a.preventDefault(),!1}function C(){a(document).unbind("mousemove",C),q(),ba=_,ca=aa,y(),U="",oa.is(":visible")||la.add(oa).hide().fadeIn(h.fadeSpeed||0),$=!0,a(document).unbind("mouseup",D).mousemove(z).one("mouseup",v),la.unbind("mousemove",u),h.onSelectStart(g,o())}function D(){a(document).unbind("mousemove",C).unbind("mouseup",D),t(la.add(oa)),p(k(_),l(aa),k(_),l(aa)),this instanceof a.imgAreaSelect||(h.onSelectChange(g,o()),h.onSelectEnd(g,o()))}function E(b){return 1==b.which&&!oa.is(":animated")&&(q(),Q=_=m(b),R=aa=n(b),a(document).mousemove(C).mouseup(D),!1)}function F(){s(!1)}function G(){J=!0,I(h=a.extend({classPrefix:"imgareaselect",movable:!0,parent:"body",resizable:!0,resizeMargin:10,onInit:function(){},onSelectStart:function(){},onSelectChange:function(){},onSelectEnd:function(){}},h)),la.add(oa).css({visibility:""}),h.show&&($=!0,q(),r(),la.add(oa).hide().fadeIn(h.fadeSpeed||0)),setTimeout(function(){h.onInit(g,o())},0)}function H(a,b){for(var c in b)void 0!==h[c]&&a.css(b[c],h[c])}function I(c){if(c.parent&&(P=a(c.parent)).append(la.add(oa)),a.extend(h,c),q(),null!=c.handles){for(pa.remove(),pa=a([]),fa=c.handles?"corners"==c.handles?4:8:0;fa--;)pa=pa.add(b());pa.addClass(h.classPrefix+"-handle").css({position:"absolute",fontSize:0,zIndex:sa+1||1}),!parseInt(pa.css("width"))>=0&&pa.width(5).height(5),(ga=h.borderWidth)&&pa.css({borderWidth:ga,borderStyle:"solid"}),H(pa,{borderColor1:"border-color",borderColor2:"background-color",borderOpacity:"opacity"})}for(S=h.imageWidth/N||1,T=h.imageHeight/O||1,null!=c.x1&&(p(c.x1,c.y1,c.x2,c.y2),c.show=!c.hide),c.keys&&(h.keys=a.extend({shift:1,ctrl:"resize"},c.keys)),oa.addClass(h.classPrefix+"-outer"),ma.addClass(h.classPrefix+"-selection"),fa=0;fa++<4;)a(na[fa-1]).addClass(h.classPrefix+"-border"+fa);H(ma,{selectionColor:"background-color",selectionOpacity:"opacity"}),H(na,{borderOpacity:"opacity",borderWidth:"border-width"}),H(oa,{outerColor:"background-color",outerOpacity:"opacity"}),(ga=h.borderColor1)&&a(na[0]).css({borderStyle:"solid",borderColor:ga}),(ga=h.borderColor2)&&a(na[1]).css({borderStyle:"dashed",borderColor:ga}),la.append(ma.add(na).add(K)).append(pa),ya&&((ga=(oa.css("filter")||"").match(/opacity=(\d+)/))&&oa.css("opacity",ga[1]/100),(ga=(na.css("filter")||"").match(/opacity=(\d+)/))&&na.css("opacity",ga[1]/100)),c.hide?t(la.add(oa)):c.show&&J&&($=!0,la.add(oa).fadeIn(h.fadeSpeed||0),s()),Z=(ea=(h.aspectRatio||"").split(/:/))[0]/ea[1],ka.add(oa).unbind("mousedown",E),h.disable||h.enable===!1?(la.unbind("mousemove",u).unbind("mousedown",w),a(window).unbind("resize",F)):((h.enable||h.disable===!1)&&((h.resizable||h.movable)&&la.mousemove(u).mousedown(w),a(window).resize(F)),h.persistent||ka.add(oa).mousedown(E)),h.enable=h.disable=void 0}var J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka=a(g),la=b(),ma=b(),na=b().add(b()).add(b()).add(b()),oa=b().add(b()).add(b()).add(b()),pa=a([]),qa={left:0,top:0},ra={left:0,top:0},sa=0,ta="absolute",ua={x1:0,y1:0,x2:0,y2:0,width:0,height:0},va=document.documentElement,wa=navigator.userAgent,xa=function(a){var b,c,f=h.keys,g=a.keyCode;if(b=isNaN(f.alt)||!a.altKey&&!a.originalEvent.altKey?!isNaN(f.ctrl)&&a.ctrlKey?f.ctrl:!isNaN(f.shift)&&a.shiftKey?f.shift:isNaN(f.arrows)?10:f.arrows:f.alt,"resize"==f.arrows||"resize"==f.shift&&a.shiftKey||"resize"==f.ctrl&&a.ctrlKey||"resize"==f.alt&&(a.altKey||a.originalEvent.altKey)){switch(g){case 37:b=-b;case 39:c=d(_,ba),_=e(_,ba),ba=d(c+b,_),x();break;case 38:b=-b;case 40:c=d(aa,ca),aa=e(aa,ca),ca=d(c+b,aa),x(!0);break;default:return}y()}else switch(_=e(_,ba),aa=e(aa,ca),g){case 37:A(d(_-b,L),aa);break;case 38:A(_,d(aa-b,M));break;case 39:A(_+e(b,N-k(ba)),aa);break;case 40:A(_,aa+e(b,O-l(ca)));break;default:return}return!1};this.remove=function(){I({disable:!0}),la.add(oa).remove()},this.getOptions=function(){return h},this.setOptions=I,this.getSelection=o,this.setSelection=p,this.cancelSelection=D,this.update=s;var ya=(/msie ([\w.]+)/i.exec(wa)||[])[1],za=/opera/i.test(wa),Aa=/webkit/i.test(wa)&&!/chrome/i.test(wa);for(da=ka;da.length;)sa=d(sa,isNaN(da.css("z-index"))?sa:da.css("z-index")),"fixed"==da.css("position")&&(ta="fixed"),da=da.parent(":not(body)");sa=h.zIndex||sa,ya&&ka.attr("unselectable","on"),a.imgAreaSelect.keyPress=ya||Aa?"keydown":"keypress",za&&(K=b().css({width:"100%",height:"100%",position:"absolute",zIndex:sa+2||2})),la.add(oa).css({visibility:"hidden",position:ta,overflow:"hidden",zIndex:sa||"0"}),la.css({zIndex:sa+2||2}),ma.add(na).css({position:"absolute",fontSize:0}),g.complete||"complete"==g.readyState||!ka.is("img")?G():ka.one("load",G),!J&&ya&&ya>=7&&(g.src=g.src)},a.fn.imgAreaSelect=function(b){return b=b||{},this.each(function(){a(this).data("imgAreaSelect")?b.remove?(a(this).data("imgAreaSelect").remove(),a(this).removeData("imgAreaSelect")):a(this).data("imgAreaSelect").setOptions(b):b.remove||(void 0===b.enable&&void 0===b.disable&&(b.enable=!0),a(this).data("imgAreaSelect",new a.imgAreaSelect(this,b)))}),b.instance?a(this).data("imgAreaSelect"):this}}(jQuery),function(a){a.testcaseRpc={initResourcesForMobile:function(a){var b=new DataCenter,c={};c.url=appPath+"/utf/testcase/caseDesign/caseMobile/initUserPageForMobile.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},saveMenuTreeNode:function(a,b){var c={};c.url=appPath+"/utf/testcase/caseDesign/caseMobile/saveMenuTreeNode.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},addSceneAndMethod:function(a,b){var c={};c.url=appPath+"/utf/testcase/caseDesign/caseMobile/addSceneAndMethod.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},getEditSceneByProject:function(a,b){var c=new DataCenter;c.addParameter("sceneId",b);var d={};d.url=appPath+"/utf/testcase/caseDesign/caseMobile/getEditSceneByProject.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},addUserAndMethodScene:function(a,b){var c={};c.url=appPath+"/utf/testcase/caseDesign/caseMobile/addCaseWithSceneAndMethod.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},editTestCaseForMobile:function(a,b){var c={};c.url=appPath+"/utf/testcase/caseDesign/caseMobile/editTestCaseForMobile.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},deleteTestCaseForMobile:function(a,b){var c=new DataCenter;c.addParameter("id",a);var d={};d.url=appPath+"/utf/testcase/caseDesign/caseMobile/deleteTestCaseForMobile.action",d.load=b,$.maf.action.requestData(d,c)},testCaseRepeat:function(a,b){var c=new DataCenter;c.addParameter("id",a);var d={};d.url=appPath+"/utf/testcase/caseDesign/caseGrid/testCaseRepeat.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},getIncludeFrame:function(a){var b=new DataCenter,c={};c.url=appPath+"/utf/testcase/caseDesign/caseGrid/getIncludeFrame.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},getAppiumSession:function(a,b){var c=new DataCenter,d={};d.url=appPath+"/utf/testcase/caseDesign/mobileExec/getAppiumSession.action",d.sync=!1,c.addParameter("udid",b),d.load=a,$.maf.action.requestData(d,c,!1)},getServiceInitState:function(a,b){var c=new DataCenter,d={};d.url=appPath+"/utf/testcase/caseDesign/mobileExec/getServiceInitState.action",d.sync=!1,d.load=a,c.addParameter("udid",b),$.maf.action.requestData(d,c,!1)},refreshImage:function(a,b,c,d){var e=new DataCenter;e.addParameter("appiumSessionId",a),e.addParameter("withImage",b),e.addParameter("udid",c);var f={};f.url=appPath+"/utf/testcase/caseDesign/mobileExec/refreshImage.action",f.sync=!1,f.load=d,$.maf.action.requestData(f,e,!1)},installApp:function(a,b,c){var d=new DataCenter;d.addParameter("host",a),d.addParameter("udid",b);var e={};e.url=appPath+"/utf/testcase/caseDesign/mobileExec/installApp.action",e.sync=!1,e.load=c,$.maf.action.requestData(e,d)},saveObject:function(a,b){var c={};c.url=appPath+"/utf/testcase/caseDesign/caseMobile/saveObject.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},saveImage:function(a,b,c,d){var e=new DataCenter;e.addParameter("menuId",a),e.addParameter("appImageHidden",b),e.addParameter("appDomXmlHidden",c),e.addParameter("density",density),e.addParameter("physicalSize",physicalSize);var f={};f.url=appPath+"/utf/testcase/caseDesign/mobileExec/saveImage.action",f.sync=!1,f.load=d,$.maf.action.requestData(f,e)},getSavedImage:function(a,b){var c=new DataCenter;c.addParameter("menuId",a);var d={};d.url=appPath+"/utf/testcase/caseDesign/mobileExec/getSavedImage.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},execScript:function(a,b,c,d,e,f,g,h){var i=new DataCenter;i.addParameter("appiumSessionId",a),h||(h=""),i.addParameter("eventId",h.toString()),i.addParameter("id",b.id),i.addParameter("action",b.action),i.addParameter("waitTime",b.waitTime),i.addParameter("scriptValue",b.scriptValue),i.addParameter("controlType",b.controlType),i.addParameter("name",b.name),i.addParameter("caseId",b.caseId),i.addParameter("sceneId",b.sceneId),i.addParameter("varGroup",b.varGroup),i.addParameter("varId",b.varId),i.addParameter("varType",b.varType),i.addParameter("varLevel",b.varLevel),i.addParameter("methodId",b.methodId),i.addParameter("paramOperations",b.paramOperations),i.addParameter("imageParam",e),i.addParameter("projId",$.ude.page.testcase.caseDesign.main.getCurrentProjId()),i.addParameter("udid",f),g||(g=""),i.addParameter("execId",g);var j={};j.url=appPath+"/utf/testcase/caseDesign/mobileExec/execScript.action",j.sync=!1,j.load=c,$.maf.action.requestData(j,i,d)},getEventsInScene:function(a,b,c){var d=new DataCenter;d.addParameter("sceneId",a),d.addParameter("paramGroup",b);var e={};e.url=appPath+"/utf/testcase/caseDesign/caseMobile/getEventsInScene.action",e.sync=!1,e.load=c,$.maf.action.requestData(e,d)},checkDevice:function(a,b){var c=new DataCenter,d={};d.url=appPath+"/utf/testcase/caseDesign/mobileExec/checkDevice.action",d.sync=!1,d.load=a,c.addParameter("udid",b),$.maf.action.requestData(d,c)},startAgent:function(a,b){var c=new DataCenter,d={};d.url=appPath+"/utf/testcase/caseDesign/mobileExec/startAgent.action",d.sync=!1,d.load=a,c.addParameter("udid",b),$.maf.action.requestData(d,c)},startApp:function(a,b,c){var d=new DataCenter;d.addParameter("host",a);var e={};e.url=appPath+"/utf/testcase/caseDesign/mobileExec/startApp.action",e.sync=!1,e.load=b,d.addParameter("udid",c),$.maf.action.requestData(e,d)},getCachedImage:function(a,b,c){var d=new DataCenter;d.addParameter("eventId",a.toString()),c||(c=""),d.addParameter("execId",c);var e={};e.url=appPath+"/utf/testcase/caseDesign/mobileExec/getCachedImage.action",e.sync=!1,e.load=b,$.maf.action.requestData(e,d)},clearCachedImage:function(a){var b=new DataCenter,c={};c.url=appPath+"/utf/testcase/caseDesign/mobileExec/clearCachedImage.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},updateParamGroupBySceneId:function(a,b){var c=new DataCenter;c.addParameter("sceneId",a),c.addParameter("paramGroup",b);var d={};d.url=appPath+"/utf/testcase/caseDesign/caseMobile/updateParamGroupBySceneId.action",d.sync=!1,$.maf.action.requestData(d,c)},getParamGroupBySceneId:function(a,b){var c=new DataCenter;c.addParameter("sceneId",a);var d={};d.url=appPath+"/utf/testcase/caseDesign/caseMobile/getParamGroupBySceneId.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},installIOSApp:function(a,b){var c=new DataCenter;c.addParameter("host",a);var d={};d.url=appPath+"/utf/testcase/caseDesign/mobileExec/installIOSApp.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},checkIOSDevice:function(a){var b=new DataCenter,c={};c.url=appPath+"/utf/testcase/caseDesign/mobileExec/checkIOSDevice.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},startIOSApp:function(a,b,c,d,e){var f=new DataCenter;f.addParameter("deviceName",b),f.addParameter("osVersion",c),f.addParameter("udid",d),f.addParameter("host",a);var g={};g.url=appPath+"/utf/testcase/caseDesign/mobileExec/startIOSApp.action",g.sync=!1,g.load=e,$.maf.action.requestData(g,f)},startAgentAndInstallIOSApp:function(a,b,c,d){var e=new DataCenter;e.addParameter("deviceName",b),e.addParameter("osVersion",c),e.addParameter("host",a);var f={};f.url=appPath+"/utf/testcase/caseDesign/mobileExec/startAgentAndInstallIOSApp.action",f.sync=!1,f.load=d,$.maf.action.requestData(f,e)},disconnectSession:function(a,b){var c=new DataCenter;if(b)for(var d=0;d<b.length;d++)c.addParameter(b[d],b[d]);var e={};e.url=appPath+"/utf/testcase/caseDesign/mobileExec/disconnectSession.action",e.sync=!1,e.load=a,$.maf.action.requestData(e,c)},determineIOSTargetHost:function(a,b){var c=new DataCenter,d={};c.addParameter("clientPlatform",a),d.url=appPath+"/utf/testcase/caseDesign/mobileExec/determineIOSTargetHost.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},getDynamicParams:function(a){var b=new DataCenter,c={};c.url=appPath+"/utf/testcase/caseDesign/mobileExec/getDynamicParams.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},getMacEnvInfo:function(a){var b=new DataCenter,c={};c.url=appPath+"/utf/testcase/caseDesign/mobileExec/getMacEnvInfo.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},getParamOperatorActions:function(a){var b=new DataCenter,c={};c.url=appPath+"/utf/testcase/caseDesign/caseMobile/getParamOperatorActions.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},calculateParamValue:function(a,b,c,d){var e=new DataCenter;e.addParameter("initValue",a),e.addParameter("operators",b),e.addParameter("udid",d);var f={};f.url=appPath+"/utf/testcase/caseDesign/mobileExec/calculateParamValue.action",f.sync=!1,f.load=c,$.maf.action.requestData(f,e)}}}($.ude.rpc),function(a){function b(){a.ude.util.pageResize(),qa=null,V(),R(),a.ude.rpc.testcaseRpc.initResourcesForMobile(m),l(),r(),a.ude.page.testcase.caseDesign.methodjs.initMethodTableForgetIncludeFrame(!1),a("#addCaseBtn").attr("title",a.i18n.prop("testcase.casejs.init.addCaseBtnT"))}function c(){return Ea}function d(){return Oa}function e(){return Pa}function f(a){Pa=a}function g(a){Oa=a}function h(){return Oa}function i(a){Qa=a}function j(){return Qa}function k(){return Ra}function l(){a.ude.pageResizeHandler=function(){a.ude.util.pageResize(),a("#caseTable").udeTable().fnResize(),a("#caseEditMethodDown").css("height",a("#caseEditMethod").height()-a(".common-content-top").outerHeight()-4),a("#caseEditEventDown").css("height",a("#caseEditEvent").height()-a(".common-content-top").outerHeight()-1)}}function m(b){if(!b)return void showMessage("\u521d\u59cb\u5316\u5931\u8d25\u3002",null,"error");if("1"===b.getCode())return void showMessage(b.getDetail(),null,"error");var c=b.getDataStore("caseStore");Ua=b.getParameter("caseId"),Ea=b.getParameter("osType"),"iOS"==Ea?(a("#showConnectInfo").show(),a("#disconnect").show(),a("#androidDeviceSelect").hide()):(v(),a("#showConnectInfo").hide(),a("#disconnect").hide(),a("#androidDeviceSelect").show()),U(c.getRowSet().getData())}function n(a,b){Na=a,p(b)}function o(){return Na}function p(b){if(b){var c=Na;Ta=b,c&&a.ude.rpc.testcaseRpc.getSavedImage(c,q)}else a("#savedAppImage").attr("src",""),a("#savedhotspot-container").html("")}function q(b){if(b&&"0"===b.getCode()){var c=b.getParameter("imageStream");b.getParameter("domXml");ta=b.getParameter("height"),ua=b.getParameter("width"),za=b.getParameter("density"),Aa=b.getParameter("physicalSize");var d=ta*Ma/ua;c&&""!=c?a("#savedAppImage").attr("src","data:image/png;base64,"+c):a("#savedAppImage").attr("src",""),a("#savedAppImage").height(d),a("#savedAppImage").width(Ma);var e=b.getDataStore("targetHotSpotNodes");if(a("#savedhotspot-container").html(""),La=e.getRowSet().getData(),e.getRowSet().forEach(function(b){var c=b.getItemValue("bounds"),e=b.getItemValue("nodeId"),f=b.getIndex();e="saved::"+e;var g=c.replace("][",",").replace("[","").replace("]",""),h=g.split(","),i=Ma*h[0]/ua,j=d*h[1]/ta,k=(h[2]-h[0])*Ma/ua,l=(h[3]-h[1])*d/ta,m="top:"+j+"px;left:"+i+"px;height:"+l+"px;width:"+k+"px;",n="<li><span class='hotspot' style='"+m+"' id='"+e+"' data-index='"+f+"'></span></li>";a("#savedhotspot-container").append(n)}),Ta){var f=Ta.name;try{var g=JSON.parse(f.replace(/'/g,'"')),h=g["resource-id"]?g["resource-id"]:"",i=g.text?g.text:"";i||(i=g["content-desc"]?g["content-desc"]:"");var j=g.xpath?g.xpath:"",k=h+"::"+i+"::"+j;k="saved::"+k,a(".hotspot").removeClass("showborder");var l=document.getElementById(k);a(l).addClass("showborder"),a("#savedImage").trigger("click")}catch(b){a("#savedImage").trigger("click")}}}else{var m=b.getDetail();showMessage(m,null,"error")}}function r(){a("#addCaseBtn").bind("click",function(b){a("#addCaseBtn")[0].className.indexOf("-unavailable")<0&&X()}),a("#editCaseBtn").bind("click",function(b){a("#editCaseBtn")[0].className.indexOf("-unavailable")<0&&Y()}),a("#deleteCaseBtn").bind("click",function(b){a("#deleteCaseBtn")[0].className.indexOf("-unavailable")<0&&aa()}),a(".common-buttons-item").unbind("setDisableT"),a(".common-buttons-item").unbind("setDisableF"),a(".common-buttons-item").bind("setDisableT",function(b){var c=b.currentTarget.className;b.currentTarget.className=c.indexOf("-unavailable")<0?c+"-unavailable":c,a(b.currentTarget).attr("disabled","disabled")}),a(".common-buttons-item").bind("setDisableF",function(b){var c=b.currentTarget.className;b.currentTarget.className=c.replace("-unavailable",""),a(b.currentTarget).removeAttr("disabled")})}function s(){a("#refreshImage").bind("click",function(b){a("#refreshImage")[0].className.indexOf("-unavailable")<0&&(Q(),a("#currentImage").click())}),a("#installApp").bind("click",function(b){a("#installApp")[0].className.indexOf("-unavailable")<0&&("iOS"==Ea?H():(a("#currentImage").click(),J()))}),a("#disconnect").bind("click",function(b){a("#disconnect")[0].className.indexOf("-unavailable")<0&&x()}),a("#addParameterValueBtn").bind("click",function(){E()}),a("#paramText").bind("keyup",function(a){13==a.which&&E()}),a(document).off("dblclick",".hotspot"),a(document).on("dblclick",".hotspot",function(b){var c="";if(a(this).hasClass("showborder")?(c=a(this).attr("id"),index=a(this).data("index")):a(this).parent().parent().find("span").each(function(){a(this).hasClass("showborder")&&(c=a(this).attr("id"),index=a(this).data("index"))}),c){var d=C(c,index);D(d)}}),a(document).off("mouseover mousemove",".hotspot"),a(document).on("mouseover mousemove",".hotspot",function(b){a(".hotspot").removeClass("showborder");var c=b.pageX,d=b.pageY,e=a(this).attr("id"),f=e.split("::");"saved"==f[0]?y(c,d,!1):y(c,d,!0)}),a(document).keydown(function(b){if(8==b.which||46==b.which){var c=b.target.nodeName;if("INPUT"!=c.toUpperCase()&&"TEXTAREA"!=c.toUpperCase()){var d=a(".showborder");d.removeClass("showborder"),d.removeClass("hotspot"),b.preventDefault()}}}),Ba=a("#appImage").imgAreaSelect({handles:!0,instance:!0,onSelectEnd:function(a,b){A(b,!1)}}),Da=a("#canvas").imgAreaSelect({handles:!0,instance:!0,onSelectEnd:function(a,b){A(b,!1)}}),a("#saveControlBtn").bind("click",function(){B()}),a(document).on("click",function(b){var c=a(b.target);a(b.target).parents(".ui-dialog").length>0||c.hasClass("ui-widget-overlay")||c.hasClass("imgareaselect-border4")||(null!=Ba&&Ba.cancelSelection(),Ca&&Ca.cancelSelection(),null!=Da&&Da.cancelSelection())}),a("#paramGroupSelect").udeSelect({}),a("#s2id_paramGroupSelect").css("marginTop","-3px"),a("#deviceSelect").udeSelect({onChange:function(){w();var b=a("#deviceSelect").udeSelect().getSelectData().id,c=function(b){if(b&&"0"===b.getCode()){var c=b.getParameter("refresh");null!==b.getParameter("minicapPort")&&void 0!==b.getParameter("minicapPort")&&(Ga=parseInt(b.getParameter("minicapPort"),10)),0!=Ga?(Ha=b.getParameter("remoteHost"),P()):(a("#canvas").hide(),a("#appImage").attr("src",""),a("#appImage").show()),"yes"==c&&Q(!0)}};a.ude.rpc.testcaseRpc.getServiceInitState(c,b)}}),a("#canvas").bind("destroyed",function(){w()}),a(window).unload(function(){w()})}function t(){return Fa}function v(){if("iOS"==Ea)Q(!0);else{var b=function(b){if(b){var c=b.getDataStore("androidDevices");Fa=[];var d=null;c.getRowSet().forEach(function(a){Fa.push({id:a.getItemValue("id"),name:a.getItemValue("model")}),d||(d=a.getItemValue("id"))}),a("#deviceSelect").udeSelect().setData(Fa);var e=b.getParameter("currentDevice");e?a("#deviceSelect").udeSelect().setValue(e):a("#deviceSelect").udeSelect().setValue(d);var f=b.getParameter("refresh");b.getParameter("minicapPort")&&(Ga=parseInt(b.getParameter("minicapPort"),10)),0!=Ga&&(Ha=b.getParameter("remoteHost"),P()),"yes"==f&&Q(!0)}};a.ude.rpc.testcaseRpc.getServiceInitState(b)}}function w(){Ja&&(Ja.close(),Ja=null)}function x(){var b=function(a){showMessage("\u5f53\u524d\u8fde\u63a5\u5df2\u7ecf\u5173\u95ed",null,"info")};a.ude.rpc.testcaseRpc.disconnectSession(b)}function y(b,c,d){var e=null;e=a(d?"#hotspot-container .hotspot":"#savedhotspot-container .hotspot");var f=[];e&&e.each(function(){var d=a(this).offset(),e=d.left,g=d.top,h=a(this).outerWidth(),i=a(this).outerHeight();b>=e&&b<=e+h&&c>=g&&c<=g+i&&f.push({elem:a(this),coord:{left:e,top:g,width:h,height:i}})}),f.length>0&&(1==f.length?f[0].elem.addClass("showborder"):z(f).elem.addClass("showborder"))}function z(a){for(var b=[],c=0;c<a.length;c++)for(var d=!1,e=(a[c].elem,a[c].coord),f=0;f<a.length;f++)if(c!=f){var g=a[f].coord;g.top==e.top&&g.left==e.left&&g.top+g.height==e.top+e.height&&g.left+g.width==e.left+e.width||g.top<=e.top&&g.left<=e.left&&g.top+g.height>=e.top+e.height&&g.left+g.width>=e.left+e.width&&(d||(b.push(a[c]),d=!0))}return 0==b.length?a[0]:1==b.length?b[0]:z(b)}function A(b,c){if(0!=b.width&&0!=b.height){var d=0,e=0,f=0,g=0,h=a("#appImage").attr("src");if(!h&&a("#appImage").is(":visible"))return void showMessage("\u5c1a\u672a\u83b7\u53d6\u5f53\u524d\u56fe\u50cf\uff01",null,"error");d=ra,e=sa,f=a("#appImage").height(),g=a("#appImage").width();var i=b.x1,j=b.y1,k=b.x2,l=b.y2,m=parseInt(i*e/g,10),n=parseInt(j*d/f,10),o=parseInt(k*e/g,10),p=parseInt(l*d/f,10),q="["+m+","+n+"]["+o+","+p+"]";a("#controlInfo").html("\u9009\u62e9\u8303\u56f4\u5728\u5bf9\u5e94\u8bbe\u5907\u4e0a\u7684\u8fb9\u754c\u662f"+q),a("#controlBounds").val(q),a("#resolution").val("["+e+","+d+"]"),a("#controlText").val(""),a.ude.dialog.open("addControlDialog",{title:"\u65b0\u589e\u63a7\u4ef6",width:"500px"})}}function B(){var b=a("#controlText").val(),c=a("#controlBounds").val(),d=a("#resolution").val(),e={};e.elementType="custom",e.path="",e.webviewNode=!1,e.resourceId="",e.resolution=d,e.density=xa,e.bounds=c,e.contentDesc="",e.text=b,e.locationFirst=!0,F(e)}function C(a,b){var c=a.split("::");if("saved"==c[0]){showMessage("\u8bf7\u5728\u5f53\u524d\u8bbe\u5907\u56fe\u50cf\u4e2d\u6dfb\u52a0\u6d4b\u8bd5\u6b65\u9aa4\uff01",null,"info");La[b];return null}var d=Ka[b];return JSON.parse(JSON.stringify(d))}function D(b){if(b){var c=a("#caseTable").udeTable().fnGetSelectedRowData(),d=a("#methodTable").udeTable().fnGetSelectedRowData();if(!c||!d)return void showMessage("\u589e\u52a0\u6d4b\u8bd5\u6b65\u9aa4\u524d\uff0c\u8bf7\u5148\u6307\u5b9a\u6d4b\u8bd5\u7528\u4f8b\uff01",null,"error");var e=b.clazz;"android.widget.EditText"==e?(Sa=b,a("#paramText").val(""),a.ude.dialog.open("addParameterValueDialog",{title:"\u8bbe\u7f6e\u8f93\u5165\u503c",width:"500px"})):F(b)}}function E(){var b=a.trim(a("#paramText").val()),c=a("#caseTable").udeTable().fnGetSelectedRowData(),d=c.caseId;if(!b)return void F(Sa);var e=function(a){var b=a.getSingleDataStore(),c=b.getRowSet().getRow(0).data,d=c.varName;F(Sa,d)},f=(new Date).getTime(),g={};g.varName=String(f),g.varType="1",g.varGroup="",g.varValue=b,g.varLevel="3",g.caseId=d,g.sceneId="";var h="",i="",j=new DataCenter,k=new DataStore("com.neusoft.utf.portal.common.entity.TestcaseArgDefine");k.setRowSetName("com.neusoft.utf.portal.common.entity.TestcaseArgDefine"),k.getRowSet().addRow(g),j.addDataStore(k),a.ude.rpc.param.addUser(j,h,i,e)}function F(b,c){if(b){var d=!1;b.locationFirst&&(d=!0);var e=a("#caseTable").udeTable().fnGetSelectedRowData(),f=a("#methodTable").udeTable().fnGetSelectedRowData();if(!e||!f)return void showMessage("\u8bf7\u6307\u5b9a\u6d4b\u8bd5\u7528\u4f8b\uff01",null,"error");var g={},h=(new Date).getTime();g.menuId=String(h),g.parentMenuId="-1",g.leaf="1",g.menuName=String(h),g.nodeUrl="",g.pageType="childPage",g.isEnabled="T",g.analyseKind="manual",g.description="",g.ismenu="1",g.density=xa,g.physicalSize=ya;var i=null;if(a("#appImageHidden").val())i=a("#appImageHidden").val();else{var j=document.getElementById("canvas").toDataURL("image/png");i=j.replace(/^data:image\/(png|jpg);base64,/,"")}var k=a("#appDomXmlHidden").val(),l="com.neusoft.utf.portal.config.projectstructure.entity.UtfProjectAnalyseResult",m=new DataCenter,n=new DataStore(l);m.addParameter("appImageHidden",i),m.addParameter("appDomXmlHidden",k),n.setRowSetName(l),n.getRowSet().addRow(g),m.addDataStore(n);var o=function(d){var g=d.getDataStore(ka),h=g.getRowSet().getRow(0).getData(),i=h.id,j=h.name,k={},l=e.caseId,m=f.methodId;k.caseId=l,k.methodId=m,k.controlType=b.elementType,k.controlId=i,c?k.varId=c:k.varId="",j&&j.indexOf("android.widget.EditText")!=-1?k.operActionId="setValue":k.operActionId="click",k.wait="1",k.eventDesc="",k.interactiveObject="pageObj",k.interactiveType="operType";var d=new DataCenter,n=new DataStore(la);n.setRowSetName(la),n.getRowSet().addRow(k),d.addDataStore(n),a.ude.page.testcase.caseDesign.eventjs.doAddEvent(d),p()},q=function(c){var e=c.getDataStore("utfProjectAnalyseResultList"),f=e.getRowSet().getRow(0).getItemValue("menuId");Na=f;var g="Native";b.isWebview="0",1==b.webviewNode&&(g="Webview",b.isWebview="1");var h={type:g,"resource-id":b.resourceId,text:b.text,"content-desc":b.contentDesc,xpath:b.path,name:b.name,dp:"",bounds:b.bounds,resolution:"["+sa+","+ra+"]",density:xa};d&&(h.priority="location");var i=JSON.stringify(h);b.id="syncAdd"+wa,wa+=1,b.name=i,b.menuId=f,b.elementType="custom",b.elementLable=i,b.analyseKind="auto",b.isEnabled="T",b.elementXpath=b.path,b.syncInfo="1";var j=new DataCenter,k=new DataStore(ka);k.setRowSetName(ka),k.getRowSet().addRow(b),j.addDataStore(k),a.ude.rpc.testcaseRpc.saveObject(j,o)};a.ude.rpc.testcaseRpc.saveMenuTreeNode(q,m)}}function G(b){var c={},d=(new Date).getTime();c.menuId=String(d),c.parentMenuId="-1",c.leaf="1",c.menuName=String(d),c.nodeUrl="",c.pageType="childPage",c.isEnabled="T",c.analyseKind="manual",c.description="",c.ismenu="1",c.density=xa,c.physicalSize=ya;var e=a("#appImageHidden").val(),f=a("#appDomXmlHidden").val(),g="com.neusoft.utf.portal.config.projectstructure.entity.UtfProjectAnalyseResult",h=new DataCenter,i=new DataStore(g);h.addParameter("appImageHidden",e),h.addParameter("appDomXmlHidden",f),i.setRowSetName(g),i.getRowSet().addRow(c),h.addDataStore(i),a.ude.rpc.testcaseRpc.saveMenuTreeNode(b,h)}function H(){var b="Mac68K"==navigator.platform||"MacPPC"==navigator.platform||"Macintosh"==navigator.platform||"MacIntel"==navigator.platform,c="other";b&&(c="mac");var d=function(b){if(b&&"0"===b.getCode()){var c=b.getParameter("utfHost");c?a.ude.util.confirm("\u5c06\u4f7f\u7528IP\u4e3a"+c+"\u7684\u673a\u5668\u8fdb\u884c\u6d4b\u8bd5\uff0c\u8bf7\u786e\u4fdd\u8be5\u673a\u5668\u5df2\u7ecf\u6253\u5f00UTF\u5ba2\u6237\u7aef\uff0c\u5e76\u4e14\u8bbe\u5907\u5df2\u8f6c\u53d1\u5230\u8be5\u673a\u5668\u4e0a",J):showMessage("\u6ca1\u6709\u627e\u5230\u7a7a\u95f2\u7684\u673a\u5668",null,"error")}else showMessage("\u6ca1\u6709\u627e\u5230\u7a7a\u95f2\u7684\u673a\u5668",null,"error")};a.ude.rpc.testcaseRpc.determineIOSTargetHost(c,d)}function I(){var b="";if("iOS"==Ea)b="";else{var c=a("#deviceSelect").udeSelect().getSelectData();c&&(b=c.id)}return b}function J(){var b=I();if("Android"==Ea&&!b)return void showMessage("\u8bf7\u9009\u62e9\u8981\u4f7f\u7528\u7684\u8bbe\u5907\uff01",null,"error");var c=function(b){b&&"0"===b.getCode()?a.ude.util.confirm("\u5df2\u6709\u5e94\u7528\u88ab\u542f\u52a8,\u662f\u5426\u91cd\u65b0\u542f\u52a8\u5e94\u7528?",O):a.ude.util.confirm("\u662f\u5426\u542f\u52a8\u5e94\u7528?",O);
};a.ude.rpc.testcaseRpc.getAppiumSession(c,b)}function K(b){a("#iosSimTbodyExec").html(""),a("#dialog_sceneMethodsDiv").css("height","auto"),a.ude.dialog.open("iosSimChooseDialog",{title:"\u9009\u62e9\u8981\u6d4b\u8bd5\u7684\u6a21\u62df\u5668",width:"400px"}),a("#iosSimTbodyExec").append("<tr class='tr' align='center'><td class='td'></td><td class='td'>\u53ef\u7528\u6a21\u62df\u5668:&nbsp;<input id='iosSelect' style='width:140px;' type='text' ></input></td></tr>");var c=a("#iosSelect");c.udeSelect({}),c.udeSelect().setData(b)}function L(){var b=window.location.host,c=function(a){if(a&&"0"===a.getCode())Q();else{var b=a.getDetail();showMessage(b,null,"error")}},d=a("#iosSelect").udeSelect().getSelectData();if(d){var e=d.id;a.ude.dialog.close();var f=e.split(",");a.ude.rpc.testcaseRpc.startAgentAndInstallIOSApp(b,f[0],f[1],c)}else showMessage("\u8bf7\u9009\u62e9\u6a21\u62df\u5668",null,"warn")}function M(){}function N(){var b=window.location.host,c=function(b){if(b&&"0"===b.getCode()){var c=b.getParameter("selectSim");if(c){for(var d=b.getParameter("simulatorList"),e=d.split(";"),f=[],g=0;g<e.length;g++){var h=e[g];f[g]={id:h,name:h}}a(document).off("click","#selectSim"),a(document).on("click","#selectSim",function(a){L()}),a(document).off("click","#cancelSelectSim"),a(document).on("click","#cancelSelectSim",function(a){M()}),K(f)}else Q()}else{var i=b.getDetail();showMessage(i,null,"error")}};a.ude.rpc.testcaseRpc.installIOSApp(b,c)}function O(){var b=function(a){if(a&&"0"===a.getCode()){var b=a.getParameter("websocketPushPort");"0"===b?Ga=0:(Ga=parseInt(b,10),Ha=a.getParameter("clientIP"),ra=a.getParameter("height"),sa=a.getParameter("width"),xa=a.getParameter("density"),ya=a.getParameter("physicalSize"),P()),Q()}else{var c=a.getDetail();showMessage(c,null,"error")}},c=window.location.host;if("iOS"==Ea)N();else{var d=I();a.ude.rpc.testcaseRpc.installApp(c,d,b)}}function P(){a("#appImage").hide();var b=ra*Ma/sa;a("#canvas").show(),a("#canvas").height(b),a("#canvas").width(Ma),Ja&&(Ja.close(),Ja=null);var c="ws://"+Ha+":"+Ga,d=document.getElementById("canvas"),e=d.getContext("2d");Ja=new WebSocket(c,"minicap"),Ja.binaryType="blob",Ja.onclose=function(){console.log("onclose",arguments)},Ja.onerror=function(){console.log("onerror",arguments)},Ja.onmessage=function(a){var c=new Blob([a.data],{type:"image/jpeg"}),g=window.URL||window.webkitURL,h=new Image;h.onload=function(){d.width=Ma,d.height=b,e.drawImage(h,0,0,Ma,b),h.onload=null,h.src=Ia,h=null,u=null,c=null,f=!0,g.revokeObjectURL(i),i=null};var i=g.createObjectURL(c);h.src=i};var f=!0;setInterval(function(){f&&ia&&(Q(),f=!1)},2e3);Ja.onopen=function(){console.log("onopen",arguments),Ja.send(ra+"x"+sa+"/0")}}function Q(b){var c=I();if("Android"==Ea&&!c)return 0==a("#deviceSelect").length?void 0:void showMessage("\u8bf7\u9009\u62e9\u8981\u4f7f\u7528\u7684\u8bbe\u5907\uff01",null,"error");var d=function(d){if(d&&"0"===d.getCode()){var f=d.getParameter("appiumSessionId"),g=!1;"iOS"==Ea?g=!0:Ga||(g=!0),ia=!1,a.ude.rpc.testcaseRpc.refreshImage(f,g,c,e)}else b||showMessage("\u8bf7\u5148\u70b9\u51fb\u542f\u52a8\u5e94\u7528\u6309\u94ae\uff0c\u542f\u52a8\u5e94\u7528\uff01",null,"info")},e=function(b){if(b&&"0"===b.getCode()){var c=b.getParameter("imageStream"),d=b.getParameter("domXml");ra=b.getParameter("height"),sa=b.getParameter("width"),xa=b.getParameter("density"),ya=b.getParameter("physicalSize");var e=ra*Ma/sa;c&&(a("#appImageHidden").val(c),a("#appImage").attr("src","data:image/png;base64,"+c),a("#appImage").height(e),a("#appImage").width(Ma)),a("#appDomXmlHidden").val(d);var f=b.getDataStore("targetHotSpotNodes");va=f.getRowSet().getData(),Ka=f.getRowSet().getData(),a("#hotspot-container").html(""),f.getRowSet().forEach(function(b){var c=b.getIndex(),d=b.getItemValue("bounds"),f=b.getItemValue("nodeId"),g=d.replace("][",",").replace("[","").replace("]",""),h=g.split(",");parseInt(h[0],10)>sa&&(h[0]=h[0]-sa),parseInt(h[2],10)>sa&&(h[2]=h[2]-sa);var i=Ma*h[0]/sa,j=e*h[1]/ra,k=(h[2]-h[0])*Ma/sa,l=(h[3]-h[1])*e/ra,m="top:"+j+"px;left:"+i+"px;height:"+l+"px;width:"+k+"px;",n="<li><span class='hotspot' style='"+m+"' id='"+f+"' data-index='"+c+"'></span></li>";a("#hotspot-container").append(n)}),ia=!0}else{var g=b.getDetail();showMessage(g,null,"error")}};a.ude.rpc.testcaseRpc.getAppiumSession(d,c)}function R(){a("#caserefresh").hide(),a("#caserefreshDIV").hide(),a("#caseName").prop("maxlength",40),a("#defaultInclude").prop("maxlength",20),a("#url").prop("maxlength",100),a("#descInfo").prop("maxlength",200),a("#caseSaveId").click(function(){S()&&T()})}function S(){var b=a.trim(a("#caseName").val());return!(!b||""===b)||(showMessage(a.i18n.prop("testcase.casejs.checkAvailability.caseName"),a("#caseDialog"),"error"),a("#caseName").focus(),!1)}function T(){var b=a.trim(a("#caseName").val()),c=function(b){if(b&&"0"===b.getCode()){var c=b.getParameter("caseName");"0"===c?Z():(showMessage(a.i18n.prop("testcase.casejs.testCaseRepeat.caseName"),a("#caseDialog"),"error"),a("#caseName").focus())}else{var d=b.getDetail();showMessage(d,a("#caseDialog"),"error")}};oa!==b?a.ude.rpc.testcaseRpc.testCaseRepeat(b,c):Z()}function U(b){a("#caseTable").udeTable().dataTable().fnClearTable(),a("#caseTable").udeTable().fnRedraw(b);for(var c=-1,d=0;d<b.length;d++)b[d].caseId==Ua&&(c=d);if(b.length>0){c!=-1&&(a("#caseTable").udeTable().fnSelectRowByIndex(c),a("#caseTable").udeTable().fnScrollToSelectedRow());var b=a("#caseTable").udeTable().fnGetSelectedRowData(),e=a("#caseTable").udeTable().data("onClick");e(b)}}function V(b){a("#caseTable").udeTable({data:b,columns:[{sTitle:a.i18n.prop("testcase.casejs.initTable.caseName"),mData:"caseName",sWidth:"30%"},{sTitle:a.i18n.prop("testcase.casejs.initTable.status"),mData:"status",sWidth:"0%",mRender:ga,bVisible:!1},{sTitle:"URL",mData:"url",sWidth:"0%",bVisible:!1},{sTitle:a.i18n.prop("testcase.casejs.initTable.uICompare"),mData:"uICompare",sWidth:"0%",mRender:ga,bVisible:!1},{sTitle:a.i18n.prop("testcase.casejs.initTable.descInfo"),mData:"descInfo",sWidth:"30%"},{sTitle:a.i18n.prop("testcase.casejs.initTable.refresh"),mData:"refresh",sWidth:"0%",mRender:ga,bVisible:!1}],dblClick:function(b){Y(),a.ude.page.testcase.scenedesign.main.getSceneByCaseId(b.caseId)},onClick:function(a){da()}})}function W(){na={},a("#caseName").val(""),a("#casestatus").attr("checked",!0),a("#defaultInclude").val(""),a("#url").val(""),a("#caserefresh").attr("checked",!1),a("#caseUICompare").attr("checked",!1),a("#descInfo").val("")}function X(){W(),a("#caseDialog").prop("add",!0),a.ude.dialog.open("caseDialog",{title:a.i18n.prop("testcase.casejs.newUser.caseDialog"),width:"500px"})}function Y(){var b=a("#caseTable").udeTable().fnGetSelectedRowData();return null==b?void showMessage(a.i18n.prop("testcase.casejs.initUser.operPrompt"),null,"error"):(ma=b.id,oa=b.caseName,na=b,a("#caseName").val(b.caseName),"1"===b.status?a("#casestatus").attr("checked",!0):a("#casestatus").attr("checked",!1),a("#defaultInclude").val(b.defaultInclude),a("#url").val(b.url),"1"===b.refresh?a("#caserefresh").attr("checked",!0):a("#caserefresh").attr("checked",!1),"1"===b.uICompare?a("#caseUICompare").attr("checked",!0):a("#caseUICompare").attr("checked",!1),a("#descInfo").val(b.descInfo),a("#caseDialog").prop("add",!1),void a.ude.dialog.open("caseDialog",{title:a.i18n.prop("testcase.casejs.editUser.caseDialog"),width:"500px"}))}function Z(){var b=na;b.caseName=a.trim(a("#caseName").val()),b.status=a("#casestatus").is(":checked")===!0?"1":"0",b.defaultInclude=a.trim(a("#defaultInclude").val()),b.url=a.trim(a("#url").val()),b.refresh=a("#caserefresh").is(":checked")===!0?"1":"0",b.uICompare=a("#caseUICompare").is(":checked")===!0?"1":"0",b.descInfo=a.trim(a("#descInfo").val());var c=new DataCenter,d=new DataStore(ja);d.setRowSetName(ja),d.getRowSet().addRow(b),c.addDataStore(d),a("#caseDialog").prop("add")?$(c):(b.id=ma,_(c))}function $(b){var c=b.getSingleDataStore(),d=c.getRowSet().getRow(0).data,e=function(b){if(b&&"0"===b.getCode()){var c=b.getSingleDataStore();d=c.getRowSet().getRow(0).data,a("#caseTable").udeTable().fnAddRow(d),da(),a.ude.dialog.close()}else{var e=b.getDetail();showMessage(e,a("#caseDialog"),"error")}};a.ude.rpc.testcaseRpc.addUserAndMethodScene(b,e)}function _(b){var c=b.getSingleDataStore(),d=c.getRowSet().getRow(0).data,e=function(b){if(b&&"0"===b.getCode())a("#caseTable").udeTable().fnUpdateRow(d),a.ude.dialog.close();else{var c=b.getDetail();showMessage(c,a("#caseDialog"),"error")}};a.ude.rpc.testcaseRpc.editTestCaseForMobile(b,e)}function aa(){var b=a("#caseTable").udeTable().fnGetSelectedRowData();return b?void a.ude.util.confirm(a.i18n.prop("testcase.casejs.deleteUser.caseDialogQ"),ba):void showMessage(a.i18n.prop("testcase.casejs.deleteUser.caseDialog"),null,"error")}function ba(){var b=a("#caseTable").udeTable().fnGetSelectedRowData();a.ude.rpc.testcaseRpc.deleteTestCaseForMobile(b.caseId,ca)}function ca(b){if(b&&"0"===b.getCode())a("#caseTable").udeTable().fnDeleteRow();else{var c=b.getDetail();showMessage(c,null,"error")}}function da(){a("#currentImage").click(),a.ude.page.testcase.caseDesign.eventjs.setInitEventFlag(!0);var b=a("#caseTable").udeTable().fnGetSelectedRowData(),c=function(c){if("1"===c.header.code)return void showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.getSceneByCaseIdSuccess"),null,"error");if(Oa=null,Ra=null,c&&c.getDataStore("SceneLevel")){var d=c.getDataStore("SceneLevel").getRowSet().getData();if(d.length>0){Oa=d[0].sceneId;var e=function(a){a&&(Ra=a.getParameter("paramGroup"),ea(b))};a.ude.rpc.testcaseRpc.getParamGroupBySceneId(Oa,e)}}a.ude.page.testcase.caseDesign.methodjs.initMethod(b,"","","")};a.ude.rpc.scene.getSceneByCaseId(b.caseId,c)}function ea(b){var c="utf_testcase_arg_define_t5",d=b.caseId+";;"+Oa,e={widgetId:"Dialog_paramFileGrop",widgetType:"dropdownbox",tableName:c,objectName:"",objectValue:"",expandStr:"",condition:d},f=new DataCenter,g=new DataStore("commonDs");g.setRowSetName("commonDs"),g.getRowSet().addRow(e),f.addDataStore(g),a.ude.rpc.scene.getComboBoxDataCommon(f,fa)}function fa(b){if("1"===b.header.code)return void showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.getComboBoxDataCommonSuccess"),null,"error");for(var c in b.getDataStores())if(b.getDataStores()[c]){var d=b.getDataStores()[c],e=d.parameters.data,f=new Object;f.CODEVALUE="",f.CODENAME="",f.id="",f.name="",e.splice(0,0,f),a("#paramGroupSelect").udeSelect({onChange:function(){var b=a("#paramGroupSelect").udeSelect().getSelectData();if(b){Ra=b.name;var c=a("#methodTable").udeTable().fnGetSelectedRowData();a.ude.rpc.testcaseRpc.updateParamGroupBySceneId(Oa,Ra),a.ude.rpc.testcaseeditrpc.getEventByMethodId(a.ude.page.testcase.caseDesign.eventjs.getEventByMethodIdSuccess,c.methodId,Oa,Ra)}}});for(var g=!1,h=0;h<e.length;h++)if(e[h].name==Ra){g=!0;break}if(a("#paramGroupSelect").udeSelect().setData(e),g)a("#paramGroupSelect").udeSelect().setValue(Ra);else{Ra="",a("#paramGroupSelect").udeSelect().setValue(Ra),a.ude.rpc.testcaseRpc.updateParamGroupBySceneId(Oa,Ra);var i=a("#methodTable").udeTable().fnGetSelectedRowData();a.ude.rpc.testcaseeditrpc.getEventByMethodId(a.ude.page.testcase.caseDesign.eventjs.getEventByMethodIdSuccess,i.methodId,Oa,Ra)}a("#s2id_paramGroupSelect").css("marginTop","-3px")}}function ga(b,c){return b="1"===b?a.i18n.prop("testcase.casejs.renderYorN.yes"):a.i18n.prop("testcase.casejs.renderYorN.no")}function ha(b,c,d){a.ude.page.config.projectStructure.main.caseClickSelectNode(d),pa=b}a.ude.page.testcase.caseDesign.main={init:b,initAppPage:s,caseNameOnclick:da,initResizeHandler:l,caseNameOnclickByScene:ha,refreshImage:Q,setCurrentMenu:n,getCurrentScene:d,getCurrentParamGroup:k,addMenuTree:G,getCurrentMenu:o,getProjectOSType:c,showSelectIOSSimDialog:K,disconnectSession:x,getSelectedDevice:I,getCurrentAvailableDevices:t,initServiceState:v,setCurrentExecId:f,getCurrentExecId:e,setCurrentSceneId:g,getCurrentSceneId:h,getCurrentProjId:j,setCurrentProjId:i};var ia=!0,ja="com.neusoft.utf.portal.common.entity.TestcaseLevel",ka="com.neusoft.utf.portal.config.pageobject.entity.UtfPageAnalyseResultForApp",la="com.neusoft.utf.portal.common.entity.TestcaseEvent",ma=null,na={},oa=null,pa=null,qa=null,ra=480,sa=270,ta=480,ua=270,va={},wa=0,xa=(new Array,""),ya="",za="",Aa="",Ba=null,Ca=null,Da=null,Ea="",Fa=[],Ga=0,Ha=null,Ia="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",Ja=null,Ka=[],La=[],Ma=270,Na=(a.ude.page.testcase.caseDesign,null),Oa=null,Pa=null,Qa=null,Ra=null,Sa=null,Ta=null,Ua=null}(jQuery),function(a){function b(){r=!1,q(),p(),j(),a.ude.page.testcase.caseDesign.eventjs.initEventGrid(),a("#caseLoadeOut_caseM").hide(),a("#setValueType").hide(),a(".right-collapse-menu").toggle(fadeOutFn=function(){a(".right-menu").hide(),a(".right-nav").animate({width:"10px"}),a("#commonContentDiv").animate({width:"99%"}),a.browser.msie&&a(".placeHolderLayer").animate({"margin-right":"0px"}),a(".right-collapse-menu").animate({"margin-right":"0px"},function(){a(".in-collapse").addClass("out-expand")})},fadeInFn=function(){a(".right-nav").animate({width:"15%"}),a("#commonContentDiv").animate({width:"85%"}),a.browser.msie&&a(".placeHolderLayer").animate({"margin-right":"10px"}),a(".right-collapse-menu").animate({"margin-right":"10px"},function(){a(".in-collapse").removeClass("out-expand"),a(".right-menu").show()})}),a("#showConnectInfo").bind("click",function(a){f()}),a("#disconnectSelect").bind("click",function(a){c()}),a("#resetConnect").bind("click",function(a){d()})}function c(){var b=new Array,c=a("#macList_container input[name='check']:checked");return c.length>0?(a(c).each(function(){b.push(this.value)}),void e(b)):void showMessage("\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u4e2a\u8981\u65ad\u5f00\u7684\u4e3b\u673a",null,"error")}function d(){var b=new Array,c=a("#macList_container input[name='check']");return c.length>0?(a(c).each(function(){b.push(this.value)}),void e(b)):void showMessage("\u76ee\u524d\u6ca1\u6709\u53ef\u7528\u7684\u4e3b\u673a",null,"error")}function e(b){var c=function(b){if(b&&"0"===b.getCode()){var c=b.getDataStore("macHosts").getRowSet().getData();a("#macEnvTable").udeTable().dataTable().fnClearTable(),a("#macEnvTable").udeTable().fnRedraw(c)}else showMessage("\u65ad\u5f00\u8fde\u63a5\u5931\u8d25",null,"error")};a.ude.rpc.testcaseRpc.disconnectSession(c,b)}function f(){a.ude.dialog.open("macEnvDialog",{title:"Mac\u73af\u5883\u5217\u8868",width:"500px"}),r||(g(),r=!0);var b=function(b){if(b&&"0"===b.getCode()){var c=b.getDataStore("macHosts").getRowSet().getData();a("#macEnvTable").udeTable().dataTable().fnClearTable(),a("#macEnvTable").udeTable().fnRedraw(c)}else showMessage("\u83b7\u53d6Mac\u8bbe\u5907\u4fe1\u606f\u5931\u8d25",null,"error")};a.ude.rpc.testcaseRpc.getMacEnvInfo(b)}function g(){a("#macList_container").css("height",a("#macEnvList").height()-a(".common-content-top").outerHeight()-8);var b=[];a("#macEnvTable").udeTable({data:b,bSort:!1,columns:[{sTitle:"",mData:"macHost",sWidth:"10%",mRender:i,fnClickCallback:function(){s=!0}},{sTitle:"\u4e3b\u673a\u5730\u5740",mData:"macHost",sWidth:"30%"},{sTitle:"\u5360\u6709\u8005IP",mData:"userHost",sWidth:"30%"},{sTitle:"\u5360\u6709\u8005\u767b\u5f55\u8d26\u53f7",mData:"userName",sWidth:"30%"}],onClick:function(b){s||(a("#eventTable_chk_all").attr("checked",!1),a("#macList_container input[name='check']").attr("checked",!1),t=!1),s=!1;var c=b.macHost,d=a("input[value='"+c+"']");d.is(":checked")?d.prop("checked",!1):d.prop("checked",!0)}}),a("#macEnvTable").udeTable().fnSetCheckbox("macEnvTable"),a("#macEnvTable_chk_all").bind("click",function(a){h()}),a("#macEnvTable").udeTable().fnResize()}function h(){t?(a("#macList_container input[name='check']").attr("checked",!1),t=!1):(a("#macList_container input[name='check']").attr("checked",!0),t=!0)}function i(b,c){var d=a("<div class='cell-widget' align='center'/>"),e=a("<input type='checkbox' name='check' value='"+b+"'/>");return d.append(e),a("<div/>").append(d).html()}function j(){var b="<div id='runEvent' class='common-buttons-item opt-runscript' title='\u8fd0\u884c\u6b65\u9aa4'></div>";a("#addEventBtn").before(b),a(document).off("click","#runEvent"),a(document).on("click","#runEvent",function(b){a("#currentImage").click();var c=a("input[name='check']:checked");return 0==c.length?(showMessage("\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u4e2a\u8981\u6267\u884c\u7684\u6b65\u9aa4",null,"error"),!1):void(c.length>1?a.ude.util.confirm("\u60a8\u9009\u4e2d\u4e86\u591a\u4e2a\u6d4b\u8bd5\u6b65\u9aa4\uff0c\u662f\u5426\u786e\u5b9a\u6267\u884c\uff1f",l,k):1==c.length&&l())})}function k(){var b=a("input[name='check']:checked");b.length>0&&a(b).each(function(){b.attr("checked",!1)}),a("#eventTable_chk_all").attr("checked",!1)}function l(){var b=[],c=a("input[name='check']:checked");c.length>0&&a(c).each(function(){b.push(this.value)});for(var d=a("#eventTable").udeTable().fnGetData(),e=[],f=0;f<b.length;f++)for(var g=0;g<d.length;g++)if(b[f]===d[g].id){e.push(d[g]);break}var h=e.length,i=0,j=a.ude.page.testcase.caseDesign.main.getSelectedDevice(),k=a.ude.page.testcase.caseDesign.main.getProjectOSType();if("Android"==k&&!j)return showMessage("\u8bf7\u9009\u62e9\u8981\u4f7f\u7528\u7684\u8bbe\u5907\uff01",null,"error"),!1;var l=function(b){i++,i<h?(a("input[value='"+e[i-1].id+"']").prop("checked",!1),m(e[i],l,e[i].wait,!0,3,j)):i==h&&(a("input[value='"+e[i-1].id+"']").prop("checked",!1),a.ude.page.testcase.caseDesign.main.refreshImage(),a("#currentImage").click())};m(e[0],l,e[0].wait,!0,3,j)}function m(a,b,c,d,e,f,g,h){return a?(e||(e=1),void o(n(a),b,d,e,f,g,h)):(showMessage("\u8bf7\u9009\u62e9\u8981\u6267\u884c\u7684\u6b65\u9aa4",null,"error"),!1)}function n(a){var b={},c=1,d=a.varValue;return d||(d=""),b.id=a.id,b.action=a.operActionId,b.scriptValue=d,c?b.waitTime=c:b.waitTime=a.wait,b.controlType=a.controlType,b.name=a.name,b.caseId=a.caseId,b.sceneId=a.sceneId,b.varGroup=a.varGroup,b.varId=a.varId,b.varType=a.varType,b.varLevel=a.varLevel,b.paramOperations=a.paramOperations,b.methodId=a.methodId,b}function o(b,c,d,e,f,g,h){var i="",j=function(j){return(i=j.getParameter("appiumSessionId"))?void a.ude.rpc.testcaseRpc.execScript(i,b,c,d,e,f,g,h):void showMessage("\u8bf7\u8fde\u63a5\u6d4b\u8bd5\u8bbe\u5907\uff01",null,"error")},k=a.ude.page.testcase.caseDesign.main.getProjectOSType();return"Android"!=k||f?void a.ude.rpc.testcaseRpc.getAppiumSession(j,f):void showMessage("\u8bf7\u9009\u62e9\u8981\u4f7f\u7528\u7684\u8bbe\u5907\uff01",null,"error")}function p(){a.ude.pageResizeHandler=function(){a.ude.util.pageResize(),a("#caseTable").udeTable().fnResize(),a("#mainContentArea").css("height","100%"),a("#caseEditEventDown").css("height",a("#caseEditEvent").height()-a(".common-content-top").outerHeight()-4),a("#case_container").css("height",a("#caseList").height()-a(".common-content-top").outerHeight()-8)}}function q(){a("#mainContentArea").css("height","100%"),a("#caseEditEventDown").css("height",a("#caseEditEvent").height()-a(".common-content-top").outerHeight()-4),a("#case_container").css("height",a("#caseList").height()-a(".common-content-top").outerHeight()-8)}a.ude.page.testcase.appCaseDesign.main={init:b,runTestEvent:m};var r=!1,s=!1,t=!1}(jQuery),function(a){a.execute={testConn:function(a,b){var c=new DataCenter;c.addParameter("url",b);var d={};d.url=appPath+"/utf/execute/testConnection.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},ifExistReport:function(a,b){var c=new DataCenter;c.addParameter("projectId",a),c.addParameter("projectName",b);var d={};d.url=appPath+"/utf/execute/ifExistReport.action",d.sync=!0,$.maf.action.requestData(d,c,!1)},initExecResult:function(a,b,c){var d=new DataCenter;d.addParameter("projectId",b),d.addParameter("projectName",c);var e={};e.url=appPath+"/utf/execute/getExecResult.action",e.sync=!1,e.load=a,$.maf.action.requestData(e,d,!1)},getSceneByProject:function(a,b){var c=new DataCenter;c.addParameter("projectId",b);var d={};d.url=appPath+"/utf/execute/getScene.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},getSceneByProjectNoSceneCase:function(a,b){var c=new DataCenter;c.addParameter("projectId",b);var d={};d.url=appPath+"/utf/execute/getSceneByProjectNoSceneCase.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},getMoreConfig:function(a,b){var c=new DataCenter;c.addParameter("projectId",b);var d={};d.url=appPath+"/utf/execute/getMore.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},execScene:function(a,b,c,d,e){a.addParameter("mark",d),a.addParameter("projectName",b),a.addParameter("recordId",c),a.addParameter("executeTime",e);var f={};f.url=appPath+"/utf/execute/execScene.action",f.sync=!1,$.maf.action.requestData(f,a)},saveExecConfig:function(a,b){var c={};c.url=appPath+"/utf/execute/saveExecConfig.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},createXML:function(a,b,c,d){var e={};b.addParameter("projectName",c),b.addParameter("flag",d),e.url=appPath+"/utf/execute/createXML.action",e.sync=!1,e.load=a,$.maf.action.requestData(e,b)},createAppAndExe:function(a,b,c,d){var e={};b.addParameter("projectName",c),b.addParameter("executeTime",d),e.url=appPath+"/utf/execute/createAppAndExecuteFile.action",e.sync=!1,e.load=a,$.maf.action.requestData(e,b)},createDataExcel:function(a,b,c,d){var e={};b.addParameter("projectName",c),b.addParameter("executeTime",d),e.url=appPath+"/utf/execute/createDataExcel.action",e.sync=!1,e.load=a,$.maf.action.requestData(e,b)},createPtScript:function(a,b,c,d,e,f){var g=new DataCenter;g.addParameter("webroot",b),g.addParameter("ifV4Flag",c),g.addParameter("projectName",d),g.addParameter("projectId",e),g.addParameter("flag",f);var h={};h.url=appPath+"/utf/execute/createPtScript.action",h.sync=!1,h.load=a,$.maf.action.requestData(h,g)},getIfV4:function(a){var b=new DataCenter,c={};c.url=appPath+"/utf/execute/getIfV4.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},packageDownload:function(a,b,c,d){var e=new DataCenter;e.addParameter("projectId",b),e.addParameter("projectName",c),e.addParameter("executeTime",d);var f={};f.url=appPath+"/utf/execute/packageDownload.action",f.sync=!1,f.load=a,$.maf.action.requestData(f,e)},lookReportOnLine:function(a,b,c,d){var e=new DataCenter;e.addParameter("fileName",b),e.addParameter("startTime",c),e.addParameter("projectName",d);var f={};f.url=appPath+"/utf/execute/lookReportOnLine.action",f.sync=!1,f.load=a,$.maf.action.requestData(f,e)},downLoadReport:function(a,b,c){var d=new DataCenter;d.addParameter("startTime",b),d.addParameter("projectName",c);var e={};e.url=appPath+"/utf/execute/downLoadReport.action",e.sync=!1,e.load=a,$.maf.action.requestData(e,d)},deleteRecord:function(a,b){var c=new DataCenter;c.addParameter("id",b);var d={};d.url=appPath+"/utf/execute/deleteRecord.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},getCurrentProject:function(a){var b=new DataCenter,c={};c.url=appPath+"/utf/execute/getCurrentProject.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},getSingleResult:function(a,b,c){var d=new DataCenter;d.addParameter("projectId",b),d.addParameter("recordId",c);var e={};e.url=appPath+"/utf/execute/getSingleResult.action",e.sync=!1,e.load=a,$.maf.action.requestData(e,d)},getExecuteProgress:function(a,b,c){var d=new DataCenter;d.addParameter("projectId",b),d.addParameter("recordId",c);var e={};e.url=appPath+"/utf/execute/getExecuteProgress.action",e.sync=!1,e.load=a,$.maf.action.requestData(e,d)},updateEndTime:function(a){var b=new DataCenter;b.addParameter("id",a);var c={};c.url=appPath+"/utf/execute/updateEndTime.action",c.sync=!0,$.maf.action.requestData(c,b)},getUrl:function(a){var b=new DataCenter,c={};c.url=appPath+"/utf/execute/getUrl.action",c.sync=!0,c.load=a,$.maf.action.requestData(c,b)},initBrowserType:function(a){var b=new DataCenter,c={};c.url=appPath+"/utf/execute/initBrowserType.action",c.sync=!0,c.load=a,$.maf.action.requestData(c,b)},getIpListByBrowserType:function(a,b){var c=new DataCenter;c.addParameter("browserType",a);var d={};d.url=appPath+"/utf/execute/getIpListByBrowserType.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},checkDataIntegrity:function(a,b){var c={};c.url=appPath+"/utf/execute/checkDataIntegrity.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},getParamGroupBySceneId:function(a,b){var c=new DataCenter;c.addParameter("sceneId",a);var d={};d.url=appPath+"/utf/execute/getParamGroupBySceneId.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},addSceneAndMethod:function(a,b){var c={};c.url=appPath+"/utf/testcase/caseDesign/caseMobile/addSceneAndMethod.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},createXMLForAPP:function(a,b,c,d,e){var f={};b.addParameter("projectName",c),b.addParameter("flag",d),b.addParameter("paramGroup",e),f.url=appPath+"/utf/execute/createXMLForAPP.action",f.sync=!1,f.load=a,$.maf.action.requestData(f,b)},saveExecResult:function(a,b){var c={};c.url=appPath+"/utf/execute/saveExecResult.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},saveExecResultBasicInfo:function(a,b){var c={};c.url=appPath+"/utf/execute/saveExecResultBasicInfo.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},updateMobileExecInfo:function(a,b,c){var d=new DataCenter,e={};e.url=appPath+"/utf/execute/updateMobileExecInfo.action",e.sync=!1,e.load=c,d.addParameter("eventResultIds",a),d.addParameter("results",b),$.maf.action.requestData(e,d)}}}($.ude.rpc),function(a){function b(){Ba=!1,t(),u(),a("#addMethodToSceneBtnExec").bind("click",function(){C()}),a("#deletMethodToSceneBtnExec").bind("click",function(){var b=G();for(var c in b)b[c]&&a(b[c]).remove();F("del")}),a("#moveupMethodBtnExec").bind("click",function(){var b=G();1!==b.length?showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.initBindFunction_moveMethod_showMessage"),a("#sceneChooseDialog"),"error"):a(b[0]).prev()[0]?a(b[0]).insertBefore(a(b[0]).prev()):showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.initBindFunction_moveupMethodBtn"),a("#sceneChooseDialog"),"error")}),a("#movedownMethodBtnExec").bind("click",function(){var b=G();1!==b.length?showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.initBindFunction_moveMethod_showMessage"),a("#sceneChooseDialog"),"error"):a(b[0]).next()[0]?a(b[0]).insertAfter(a(b[0]).next()):showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.initBindFunction_movedownMethodBtn"),a("#sceneChooseDialog"),"error")}),a("#addDeviceForAndroid").bind("click",function(){V()}),a("#deleteDeviceForAndroid").bind("click",function(){W()}),a("#selectDevices").bind("click",function(){X()}),a("#closeExecDialogForScenes").bind("click",function(){a.ude.dialog.close(),Oa=!0,a.ude.rpc.testcaseRpc.clearCachedImage(function(){})}),a("#executeAllScenes").bind("click",function(){Ka=0,La=0,da(),a("#downloadExecResultForScenes").attr("disabled","true")}),a("#downloadExecResultForScenes").bind("click",function(){c()}),a("#showException").bind("click",function(b){a.ude.dialog.open("exceptionDialog",{title:"\u5f02\u5e38\u4fe1\u606f",width:"490px"})}),a("#closeExecDialog").bind("click",function(b){a.ude.dialog.close(),Oa=!0,a.ude.rpc.testcaseRpc.clearCachedImage(function(){})}),a("#executeScene").bind("click",function(b){e(),Oa=!1,Pa=!1,Ma=-1,a("#stopExecuteScene").removeAttr("disabled"),a("#pauseExecuteScene").attr("disabled","true"),a("#pauseExecuteScene").val("\u6682\u505c"),a("#pauseExecuteScene").addClass("pause"),a("#pauseExecuteScene").removeClass("continue"),a("#executeScene").attr("disabled","true"),a("#saveExecResult").removeAttr("disabled"),Fa=a.ude.page.testcase.caseDesign.main.getProjectOSType(),"iOS"==Fa?g():i()}),a("#stopExecuteScene").bind("click",function(b){a("#executeScene").removeAttr("disabled"),a("#pauseExecuteScene").attr("disabled","true"),a("#pauseExecuteScene").val("\u6682\u505c"),a("#pauseExecuteScene").addClass("pause"),a("#pauseExecuteScene").removeClass("continue"),a("#stopExecuteScene").attr("disabled","true"),Oa=!0,e()}),a("#pauseExecuteScene").bind("click",function(b){if(a(this).hasClass("pause"))a(this).removeClass("pause"),a(this).addClass("continue"),Pa=!0,a("#pauseExecuteScene").val("\u7ee7\u7eed");else if(a(this).hasClass("continue")){var c=a(".cell-widget input[type='radio']:checked").length;if(0==c)a.ude.util.confirm("\u60a8\u6ca1\u6709\u9009\u62e9\u5f00\u59cb\u6b65\u9aa4\uff0c\u4ece\u5728\u7b2c\u4e00\u4e2a\u6b65\u9aa4\u5f00\u59cb\u6267\u884c\uff1f",function(){Ma=0,l(),a(this).removeClass("continue"),a(this).addClass("pause"),Pa=!1,a("#pauseExecuteScene").val("\u6682\u505c")});else{var d=a("#execEventTable").udeTable().fnGetSelectedRowDataIndex(),e=a(this);a.ude.util.confirm("\u5c06\u4ece\u7b2c"+(d+1)+"\u4e2a\u6b65\u9aa4\u5f00\u59cb\u6267\u884c\uff1f",function(){Ma=d,l(),e.removeClass("continue"),e.addClass("pause"),Pa=!1,a("#pauseExecuteScene").val("\u6682\u505c")})}}}),a("#saveExecResult").bind("click",function(a){saveExecResult()})}function c(){a.ude.util.confirmAdd("\u662f\u5426\u8981\u5c06\u56fe\u7247\u4e0b\u8f7d\u5230\u672c\u5730\uff1f",function(){a.ude.rpc.execute.mobileResult.getMobileResultDetailToReport(Qa.toString(),function(a){var b=a.getParameter("downLoadPath");window.location.href=appPath+b},"yes")},function(){a.ude.rpc.execute.mobileResult.getMobileResultDetailToReport(Qa.toString(),function(a){var b=a.getParameter("downLoadPath");window.location.href=appPath+b},"no")})}function d(b){var c=new DataCenter;c.addParameter("sceneIdStr",na),c.addParameter("sceneNameStr",oa),c.addParameter("caseNameStr",oa),c.addParameter("paramGroupStr",pa),c.addParameter("allSceneName",qa),c.addParameter("allSceneId",ra),c.addParameter("currentDevice",Ga);var d=a("#stateTable").udeTable().dataTable().fnGetData(),e=a("#execEventTable").udeTable().dataTable().fnGetData(),f=new DataStore("stateTable");f.setRowSetName(wa);for(var g=0;g<d.length;g++){var h=new Object;h.eventType="state",h.eventOrder=(g+1).toString(),h.objectText=d[g].taskName,h.resultState=d[g].state,f.getRowSet().addRow(h)}c.addDataStore(f);var i=new DataStore("execEventTable");i.setRowSetName(wa);for(var j=0;j<e.length;j++){var k=new Object;k.eventId=e[j].id,k.eventType="event",k.eventOrder=(j+1).toString();var l=e[j].name;k.objectName=l,k.objectType=a.ude.page.testcase.caseDesign.eventjs.displayType(e[j].controlType,"",e[j]),k.objectText=a.ude.page.testcase.caseDesign.eventjs.displayText(l),k.objectPath=a.ude.page.testcase.caseDesign.eventjs.displayPath(l),k.objectId=a.ude.page.testcase.caseDesign.eventjs.displayId(l),k.operAction=e[j].operActionId,k.operValue=e[j].varValue,k.objectPosition=a.ude.page.testcase.caseDesign.eventjs.displayBound(l),k.resultState=e[j].state,i.getRowSet().addRow(k)}c.addDataStore(i);var m=null;m=b?b:function(b){return b?"1"===b.getCode()?void showMessage(b.getDetail(),a("#executeProcess"),"error"):void showMessage("\u4fdd\u5b58\u6267\u884c\u7ed3\u679c\u6210\u529f",a("#executeProcess"),"info"):void showMessage("\u4fdd\u5b58\u6267\u884c\u7ed3\u679c\u5931\u8d25\u3002",a("#executeProcess"),"error")},a.ude.rpc.execute.saveExecResultBasicInfo(c,m)}function e(){var b=a("#stateTable").udeTable().dataTable().fnGetData();if(b&&b.length>0)for(var c=0;c<b.length;c++){var d=b[c];d.state="Waiting"}a("#stateTable").udeTable().dataTable().fnClearTable(),a("#stateTable").udeTable().fnRedraw(b);var e=a("#execEventTable").udeTable().dataTable().fnGetData();if(e&&e.length>0)for(var c=0;c<e.length;c++){var f=e[c];f.state="Waiting"}a("#execEventTable").udeTable().dataTable().fnClearTable(),a("#execEventTable").udeTable().fnRedraw(e)}function f(){var b={taskName:"\u68c0\u67e5\u8bbe\u5907",index:"1",state:"Waiting"};a("#stateTable").udeTable().dataTable().fnUpdateRowByIndex(0,b),a("#executeScene").removeAttr("disabled"),a("#stopExecuteScene").attr("disabled","true")}function g(){var b="Mac68K"==navigator.platform||"MacPPC"==navigator.platform||"Macintosh"==navigator.platform||"MacIntel"==navigator.platform,c="other";b&&(c="mac");var d=function(b){if(b&&"0"===b.getCode()){var c=b.getParameter("utfHost");c?a.ude.util.confirm("\u5c06\u4f7f\u7528IP\u4e3a"+c+"\u7684\u673a\u5668\u8fdb\u884c\u6d4b\u8bd5\uff0c\u8bf7\u786e\u4fdd\u8be5\u673a\u5668\u5df2\u7ecf\u6253\u5f00UTF\u5ba2\u6237\u7aef\uff0c\u5e76\u4e14\u8bbe\u5907\u5df2\u8f6c\u53d1\u5230\u8be5\u673a\u5668\u4e0a",i):showMessage("\u6ca1\u6709\u627e\u5230\u7a7a\u95f2\u7684\u673a\u5668",null,"error");
}else showMessage("\u6ca1\u6709\u627e\u5230\u7a7a\u95f2\u7684\u673a\u5668",null,"error")};a.ude.rpc.testcaseRpc.determineIOSTargetHost(c,d)}function h(){var b=(window.location.host,a("#iosSelect").udeSelect().getSelectData());if(b){var c=b.id;a.ude.dialog.close();var d=c.split(",");Ca=d[0],Da=d[1],Ea="";var e={taskName:"\u542f\u52a8\u5f15\u64ce",index:"2",state:"Running"};a("#stateTable").udeTable().dataTable().fnUpdateRowByIndex(1,e),j()}else showMessage("\u8bf7\u9009\u62e9\u6a21\u62df\u5668",null,"warn")}function i(){if(S(),Fa=a.ude.page.testcase.caseDesign.main.getProjectOSType(),Ga=a.ude.page.testcase.caseDesign.main.getSelectedDevice(),"Android"==Fa&&!Ga)return void showMessage("\u8bf7\u9009\u62e9\u8981\u4f7f\u7528\u7684\u8bbe\u5907\uff01",null,"error");var b=function(b){if(!Oa)if(b){var c=b.getParameter("successful"),d=b.getParameter("resultMessage");if(c){var e={taskName:"\u68c0\u67e5\u8bbe\u5907",index:"1",state:"Finished"};if(a("#stateTable").udeTable().dataTable().fnUpdateRowByIndex(0,e),"iOS"==Fa){var g=b.getParameter("selectSim");if(g){for(var i=b.getParameter("simulatorList"),k=i.split(";"),e=[],l=0;l<k.length;l++){var m=k[l];e[l]={id:m,name:m}}a(document).off("click","#selectSim"),a(document).on("click","#selectSim",function(a){h()}),a(document).off("click","#cancelSelectSim"),a(document).on("click","#cancelSelectSim",function(a){f()}),a.ude.page.testcase.caseDesign.main.showSelectIOSSimDialog(e)}else{var e={taskName:"\u542f\u52a8\u5f15\u64ce",index:"2",state:"Running"};a("#stateTable").udeTable().dataTable().fnUpdateRowByIndex(1,e),Ca=b.getParameter("deviceName"),Da=b.getParameter("osVersion"),Ea=b.getParameter("udid"),j()}}else{var e={taskName:"\u542f\u52a8\u5f15\u64ce",index:"2",state:"Running"};a("#stateTable").udeTable().dataTable().fnUpdateRowByIndex(1,e),j()}}else{var e={taskName:"\u68c0\u67e5\u8bbe\u5907",index:"1",state:"Error"};a("#stateTable").udeTable().dataTable().fnUpdateRowByIndex(0,e),showMessage(d,null,"error")}}else{var e={taskName:"\u68c0\u67e5\u8bbe\u5907",index:"1",state:"Error"};a("#stateTable").udeTable().dataTable().fnUpdateRowByIndex(0,e),showMessage("\u83b7\u53d6\u8bbe\u5907\u4fe1\u606f\u5931\u8d25",null,"error")}},c=function(){var c={taskName:"\u68c0\u67e5\u8bbe\u5907",index:"1",state:"Running"};a("#stateTable").udeTable().dataTable().fnUpdateRowByIndex(0,c),"iOS"==Fa?a.ude.rpc.testcaseRpc.checkIOSDevice(b):a.ude.rpc.testcaseRpc.checkDevice(b,Ga)};if("checked"==a("#isSaveTcReportAuto").attr("checked")){var e=function(b){if(!b||"0"!==b.getCode())return void showMessage("\u62a5\u544a\u6570\u636e\u4fdd\u5b58\u5931\u8d25\uff01",null,"error");var d=b.getParameter("detailIds");if(d){var e=d.split(",");if(e.length>=3){for(var f=a("#stateTable").udeTable().dataTable().fnGetData(),g=0;g<f.length;g++)f[g].execId=e[g];for(var h=a("#execEventTable").udeTable().dataTable().fnGetData(),g=0;g<h.length;g++)h[g].execId=e[g+3]}}c()};d(e)}else c()}function j(){var b=function(b){if(!Oa)if(b){var c=b.getParameter("successful"),d=b.getParameter("resultMessage");if(c){var e={taskName:"\u542f\u52a8\u5f15\u64ce",index:"2",state:"Finished"};a("#stateTable").udeTable().dataTable().fnUpdateRowByIndex(1,e);var e={taskName:"\u542f\u52a8\u5e94\u7528",index:"3",state:"Running"};a("#stateTable").udeTable().dataTable().fnUpdateRowByIndex(2,e),k()}else{var e={taskName:"\u542f\u52a8\u5f15\u64ce",index:"2",state:"Error"};a("#stateTable").udeTable().dataTable().fnUpdateRowByIndex(1,e),showMessage(d,null,"error")}}else{var e={taskName:"\u542f\u52a8\u5f15\u64ce",index:"2",state:"Error"};a("#stateTable").udeTable().dataTable().fnUpdateRowByIndex(1,e),showMessage("\u542f\u52a8\u5f15\u64ce\u5931\u8d25",null,"error")}};selectAll=!1,Fa=a.ude.page.testcase.caseDesign.main.getProjectOSType(),"iOS"==Fa?a.ude.rpc.testcaseRpc.startAgent(b,""):a.ude.rpc.testcaseRpc.startAgent(b,Ga)}function k(){var b=function(b){if(!Oa)if(b){var c=b.getParameter("successful"),d=b.getParameter("resultMessage");if(c){var e={taskName:"\u542f\u52a8\u5e94\u7528",index:"3",state:"Finished"};a("#stateTable").udeTable().dataTable().fnUpdateRowByIndex(2,e),l(),a("#pauseExecuteScene").removeAttr("disabled")}else{var e={taskName:"\u542f\u52a8\u5e94\u7528",index:"3",state:"Error"};a("#stateTable").udeTable().dataTable().fnUpdateRowByIndex(2,e),showMessage(d,null,"error")}}else{var e={taskName:"\u542f\u52a8\u5e94\u7528",index:"3",state:"Error"};a("#stateTable").udeTable().dataTable().fnUpdateRowByIndex(2,e),showMessage("\u542f\u52a8\u5e94\u7528\u5931\u8d25",null,"error")}},c=window.location.host;"iOS"==Fa?a.ude.rpc.testcaseRpc.startIOSApp(c,Ca,Da,Ea,b):a.ude.rpc.testcaseRpc.startApp(c,b,Ga)}function l(){var b=a("#execEventTable").udeTable().fnGetData(),c=parseInt(a("input[name=imageParam]:checked").val(),10),d=0,e=function(f){if(!Oa){var g=f.getParameter("execResult"),h="";h=g&&"success"==g?"Finished":"Error";var i=b[Ma];i.state=h,a("#execEventTable").udeTable().dataTable().fnUpdateRowByIndex(Ma,i);var j=230,k=f.getParameter("imageStream");if(k){var l=f.getParameter("height"),m=f.getParameter("width"),n=l*j/m;a("#eventResultAppImage").attr("src","data:image/png;base64,"+k),a("#eventResultAppImage").height(n),a("#eventResultAppImage").width(j)}var o=f.getParameter("errorMsg"),p=f.getParameter("exceptionMessage");if(o?(a("#errorTable").show(),a("#errorMsg").val(o),a("#errorMsgContent").val(o),a("#exceptionMsg").val(p)):a("#errorTable").hide(),S(),!Pa){if(Ma!=d-1){Ma+=1;var q=b[Ma];q.state="Running",a("#execEventTable").udeTable().dataTable().fnUpdateRowByIndex(Ma,q),Ma>=1&&a("#execEventTable").udeTable().dataTable().fnScrollToRow(Ma-1);var r=b[Ma].execId?b[Ma].execId:"",s=a.ude.page.testcase.caseDesign.main.getSelectedDevice();a.ude.page.testcase.appCaseDesign.main.runTestEvent(b[Ma],e,b[Ma].wait,!1,c,s,r,Ma)}if(Ma==d-1&&(a("#pauseExecuteScene").attr("disabled","true"),a("#stopExecuteScene").attr("disabled","true"),a("#executeScene").removeAttr("disabled"),"checked"==a("#isSaveTcReportAuto").attr("checked"))){for(var t=[],u=[],v=0;v<b.length;v++)t.push(b[v].execId),u.push(b[v].state);a.ude.rpc.execute.updateMobileExecInfo(t.toString(),u.toString(),function(){})}}}};if(b&&b.length>0){d=b.length,Ma==-1&&(Ma=0);var f=b[Ma];f.state="Running",a("#execEventTable").udeTable().dataTable().fnUpdateRowByIndex(Ma,f),a("#execEventTable").udeTable().dataTable().fnScrollToRow(Ma);var g=a.ude.page.testcase.caseDesign.main.getSelectedDevice(),h=b[Ma].execId?b[Ma].execId:"";a.ude.page.testcase.appCaseDesign.main.runTestEvent(b[Ma],e,b[Ma].wait,!1,c,g,h,Ma)}}function m(){na="",oa="",pa="",qa="",ra="";for(var b=a("#sceneMethodsTbodyExec").find(".select2-chosen"),c=!1,d=0;d<b.length;d++)if(c)c=!1;else if((d+1)%2==0){var e=a(b[d]),f=e.text();""==f&&(f="[defaultPG]"),pa+=f+","}else{var g=a(b[d]),h=g.text();if(""!=h){for(var i=0;i<ma.length;i++)ma[i].name===h&&(na+=ma[i].id+",");oa+=h+","}else c=!0}""!=oa&&(oa=oa.substring(0,oa.length-1)),""!=na&&(na=na.substring(0,na.length-1)),""!=pa&&(pa=pa.substring(0,pa.length-1))}function n(){m(),q()&&(r(),a.ude.rpc.execute.checkDataIntegrity(o,za))}function o(b){if(b){var c=b.getParameter("checkMessage");""!=c?(c=c.replace(new RegExp(";;","gm"),"<br/>"),a.ude.util.confirm(a.i18n.prop("ude.page.execute.isContinue")+"<br/>"+c,p),a.ude.dialog.close()):(p(),a.ude.dialog.close())}}function p(b){var c,d=function(b){var c=b.getParameter("executeTime");a.ude.rpc.execute.createDataExcel(e,za,ta,c)},e=function(b){var c=b.getParameter("executeTime");a.ude.rpc.execute.createAppAndExe(f,za,ta,c)},f=function(b){var d=b.getParameter("executeTime");a.ude.rpc.execute.packageDownload(c,sa,ta,d)};c=function(a){window.location.href="/utf"+a.getParameter("filePath")},a.ude.rpc.execute.createXMLForAPP(d,za,ta,"downLoad",pa)}function q(){return!(!oa||""===oa)||(showMessage("\u8bf7\u9009\u62e9\u6d4b\u8bd5\u7684\u7528\u4f8b\uff01",null,"error"),!1)}function r(){ua.url="",ua.browserType="",ua.sceneId=s(),ua.testKind="1",ua.projId=sa,ua.assignIpAddr="",ua.moreConfig="",Aa.setRowSetName(va),Aa.getRowSet().addRow(ua),za.addDataStore(Aa)}function s(){for(var a=oa,b=a.split(","),c=na.split(","),d=oa.split(","),e="",f=!0,g=0;g<b.length;g++){var h=d.indexOf(b[g]);h!=-1&&(f?(e+=c[h],f=!1):e=e+","+c[h])}return e}function t(){var b=function(a){if(a){var b=a.getParameter("project");sa=b[0],ta=b[1]}};a.ude.rpc.execute.getCurrentProject(b)}function u(){var b="<div title='\u4e0b\u8f7d\u7528\u4f8b' class='common-buttons-item opt-export' id='downloadScene'></div>";a("#caseList .common-content-top .common-right").append(b),a(document).off("click","#downloadScene"),a(document).on("click","#downloadScene",function(b){a(document).off("click","#downloadSceneBtn"),a(document).on("click","#downloadSceneBtn",function(a){n()}),y()});var c="<div id='runCases' class='common-buttons-item opt-runscript' title='\u8fd0\u884c\u7528\u4f8b'></div>";a("#caseList .common-right").prepend(c),a(document).off("click","#runCases"),a(document).on("click","#runCases",function(b){a(document).off("click","#downloadSceneBtn"),a(document).on("click","#downloadSceneBtn",function(a){H()}),y()})}function v(){return a(document).off("click","#downloadSceneBtn"),a(document).on("click","#downloadSceneBtn",function(a){H()}),sceneName=a.ude.page.testcase.appScenedesign.main.findSceneName(),sceneName.length>0?(sceneName=sceneName.substring(0,sceneName.length-3),sceneName.indexOf("','")!==-1?void showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.editScene_chooseshowMessage"),null,"error"):void x("edit")):void showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.chooseSceneshowMessage"),null,"error")}function w(){a(document).off("click","#downloadSceneBtn"),a(document).on("click","#downloadSceneBtn",function(a){H()}),ka={},la={},x()}function x(b){a("#Dialog_add_sceneName").val(""),a("#sceneMethodsTbodyExec").html(""),a("#sceneNameTalbe").show(),a("#Dialog_sceneMethodsDivExec").css("height","auto"),a.ude.dialog.open("sceneChooseDialog",{title:"\u9009\u62e9\u6d4b\u8bd5\u7528\u4f8b",width:"490px"}),"edit"==b?a.ude.rpc.execute.getSceneByProjectNoSceneCase(A,sa):a.ude.rpc.execute.getSceneByProjectNoSceneCase(D,sa)}function y(){a("#sceneMethodsTbodyExec").html(""),a("#sceneNameTalbe").hide(),a("#Dialog_sceneMethodsDivExec").css("height","auto"),a.ude.dialog.open("sceneChooseDialog",{title:"\u9009\u62e9\u6d4b\u8bd5\u7528\u4f8b",width:"490px"}),a.ude.rpc.execute.getSceneByProjectNoSceneCase(D,sa)}function z(b){var c=b.getDataStore("sceneLevel").getRowSet().getData();c.length>0&&(la=c[0]);var d=b.getDataStore("SceneFlowConfig"),e=d.getRowSet().getData();if(0==e.length)C(),a("#Dialog_add_sceneName").val(la.sceneName);else for(var f=0;f<e.length;f++)C(e[f].caseId,e[f].paramGroup),a("#Dialog_add_sceneName").val(e[f].createPerson)}function A(a){var b=a.getDataStore("testCase"),c=b.parameters.data;B(c)}function B(b){ma=b,a.ude.rpc.testcaseRpc.getEditSceneByProject(z,sceneName)}function C(b,c){F(),a("#sceneMethodsTbodyExec").append("<tr class='tr' align='center'><td class='td'><input type='checkbox' name='' value='methodSeclect'/></td><td class='td'>\u7528\u4f8b\u540d:&nbsp;<input style='width:140px;' type='text' />&nbsp;&nbsp;&nbsp;\u53c2\u6570\u7ec4:&nbsp;<input style='width:110px;' type='text' /></td></tr>");var d=a("#sceneMethodsTbodyExec").find("tr:last-child").find("input"),e=a(d[1]),f=a(d[2]);if(e.udeSelect({onChange:function(){var b=e.udeSelect().getSelectData();if(b){var c=b.id,d=function(b){if("1"===b.header.code)return void showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.getComboBoxDataCommonSuccess"),null,"error");for(var c in b.getDataStores())if(b.getDataStores()[c]){var d=b.getDataStores()[c],e=d.parameters.data,g=new Object;g.CODEVALUE="",g.CODENAME="",g.id="",g.name="",e.splice(0,0,g),f.udeSelect().setData(e)}};a.ude.rpc.execute.getParamGroupBySceneId(c,d)}}}),e.udeSelect().setData(ma),f.udeSelect({}),null!=b){e.udeSelect().setValue(b);var g=function(b){if("1"===b.header.code)return void showMessage(a.i18n.prop("testcase.scenedesign.sceneJs.getComboBoxDataCommonSuccess"),null,"error");for(var d in b.getDataStores())if(b.getDataStores()[d]){var e=b.getDataStores()[d],g=e.parameters.data,h=new Object;h.CODEVALUE="",h.CODENAME="",h.id="",h.name="",g.splice(0,0,h),f.udeSelect().setData(g),f.udeSelect().setValue(c)}};a.ude.rpc.execute.getParamGroupBySceneId(b,g)}}function D(a){var b=a.getDataStore("testCase"),c=b.parameters.data;E(c)}function E(b){ma=b,a("#addMethodToSceneBtnExec").click()}function F(b){var c=a("#sceneChooseDialog").parent().offset().top,d=a("#sceneChooseDialog").parent().height(),e=document.body.clientHeight,f=e-d-c,g=a("#Dialog_sceneMethodsDivExec")[0].scrollHeight,h=a("#Dialog_sceneMethodsDivExec")[0].clientHeight,i=g>h;f<30&&("del"!==b||i)?a("#Dialog_sceneMethodsDivExec").css("height",a("#Dialog_sceneMethodsDivExec").height()):a("#Dialog_sceneMethodsDivExec").css("height","auto")}function G(){var b=a("#sceneMethodsTbodyExec").children(),c=[],d=0,e=0;for(e=0;b[e];e++)a(b[e]).find("input")[0].checked===!0&&(c[d++]=b[e]);return c}function H(){if(m(),a("#sceneNameTalbe").is(":hidden")){if(!q())return;r(),a.ude.rpc.execute.checkDataIntegrity(L,za)}else J()}function I(){if(Fa=a.ude.page.testcase.caseDesign.main.getProjectOSType(),"Android"==Fa)return void T();if(sceneName=a.ude.page.testcase.appScenedesign.main.findSceneName(),!(sceneName.length>0))return void showMessage("\u8bf7\u9009\u62e9\u4e00\u4e2a\u573a\u666f\u8fdb\u884c\u6267\u884c",null,"error");if(sceneName=sceneName.substring(0,sceneName.length-3),sceneName.indexOf("','")!==-1)return void showMessage("\u8bf7\u9009\u62e9\u4e00\u4e2a\u573a\u666f\u8fdb\u884c\u6267\u884c",null,"error");var b=function(b){na="",oa="",pa="",qa="",la={},ra="";var c=b.getDataStore("sceneLevel").getRowSet().getData();c.length>0&&(la=c[0]),ra=la.sceneId;for(var d=b.getDataStore("SceneFlowConfig"),e=d.getRowSet().getData(),f=0;f<e.length;f++){var g=e[f].paramGroup,h=e[f].id;""==g&&(g="[defaultPG]"),pa+=g+",",na+=e[f].caseId+",",oa+=h+",",qa=e[f].createPerson}""!=oa&&(oa=oa.substring(0,oa.length-1)),""!=na&&(na=na.substring(0,na.length-1)),""!=pa&&(pa=pa.substring(0,pa.length-1)),q()&&(r(),a.ude.rpc.execute.checkDataIntegrity(M,za))};a.ude.rpc.testcaseRpc.getEditSceneByProject(b,sceneName)}function J(){var b=a.trim(a("#Dialog_add_sceneName").val());if(!b)return showMessage("\u573a\u666f\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\uff01",null,"error"),!1;r(),ka.xmlFile="",ka.paramFile="",la.sceneName=b,la.sceneDesc="";var c=new DataStore(xa);c.setRowSetName(xa),c.getRowSet().addRow(ka);var d=new DataStore(ya);d.setRowSetName(ya),d.getRowSet().addRow(la),za.addDataStore(c),za.addDataStore(d),za.addParameter("paramGroupStr",pa),K(za)}function K(b){var c=function(b){"0"==b.header.code?(ka={},la={},a("#Dialog_add_sceneName").val(""),a.ude.dialog.close("sceneDialog"),a.ude.page.testcase.appScenedesign.main.getComboBoxDataCommon()):showMessage(a.i18n.prop(b.header.message.detail),null,"error")};a.ude.rpc.testcaseRpc.addSceneAndMethod(b,c)}function L(b){if(b){var c=b.getParameter("checkMessage");""!=c?(c=c.replace(new RegExp(";;","gm"),"<br/>"),a.ude.util.confirm(a.i18n.prop("ude.page.execute.isContinue")+"<br/>"+c,N),a.ude.dialog.close()):(a.ude.dialog.close(),N())}}function M(b){if(b){var c=b.getParameter("checkMessage");""!=c?(c=c.replace(new RegExp(";;","gm"),"<br/>"),a.ude.util.confirm(a.i18n.prop("ude.page.execute.isContinue")+"<br/>"+c,N),a.ude.dialog.close()):N()}}function N(){function b(b){if(b||showMessage("\u83b7\u53d6\u6b65\u9aa4\u4fe1\u606f\u5931\u8d25\uff01",null,"error"),"1"===b.getCode())return void showMessage(b.getDetail(),null,"error");var c=function(c){if(!c)return void showMessage("\u83b7\u53d6\u52a8\u6001\u53c2\u6570\u5931\u8d25",null,"error");if("1"===c.getCode())return void showMessage(c.getDetail(),null,"error");for(var d=b.getDataStore("eventStore"),e=d.getRowSet().getData(),f=c.getDataStore("DynamicParams"),g=f.getRowSet().getData(),h=0;h<e.length;h++){var i=e[h];if(!i.operActionId||"setParam"!=i.operActionId){var j=i.varId;if(i&&i.varType&&"var"==i.varType)if(i.varLevel&&"3"==i.varLevel)for(var k=0;k<g.length;k++){var l=g[k];if(l&&l.paramName&&l.paramName==j&&l.level&&"3"==l.level){i.varValue=l.value;break}}else if(i.varLevel&&"2"==i.varLevel)for(var k=0;k<g.length;k++){var l=g[k];if(l&&l.paramName&&l.paramName==j&&l.level&&"2"==l.level){i.varValue=l.value;break}}else if(i.varLevel&&"1"==i.varLevel)for(var k=0;k<g.length;k++){var l=g[k];if(l&&l.paramName&&l.paramName==j&&l.level&&"1"==l.level){i.varValue=l.value;break}}}}a("#execEventTable").udeTable().dataTable().fnClearTable(),a("#execEventTable").udeTable().fnRedraw(e),a("#totalCount").text(a("#execEventTable").udeTable().fnGetData().length),a("#successCount").text(0),a("#failCount").text(0),a.ude.rpc.testcaseRpc.clearCachedImage(function(){})};a.ude.rpc.testcaseRpc.getDynamicParams(c)}a("#isSaveTcReportAuto").attr("checked","checked"),a.ude.dialog.open("executeProcess",{title:"\u7528\u4f8b\u6267\u884c\u8fc7\u7a0b",width:"1000px"}),Ba||(R(),Ba=!0),a("#errorTable").hide(),a("#eventResultAppImage").attr("src",""),a("#executeScene").removeAttr("disabled"),a("#pauseExecuteScene").attr("disabled","true"),a("#stopExecuteScene").attr("disabled","true"),a("#saveExecResult").attr("disabled","true"),Ma=-1,a("#stateTable").udeTable().dataTable().fnClearTable(),a("#stateTable").udeTable().fnRedraw(Na);var c=s();a.ude.rpc.testcaseRpc.getEventsInScene(c,pa,b)}function O(b,c,d){var e="";e=b?"Running"==b?"running-state":"Finished"==b?"finished-state":"Error"==b?"error-state":"waiting-state":"waiting-state";var f=(d.id,a("<div class='cell-widget' align='center'/>")),g="<div class='testcasestate "+e+"'></div>",h=a(g);return f.append(h),a("<div/>").append(f).html()}function P(b,c,d){var e=d.id,f=a("<div class='cell-widget' align='center'/>"),g=a("<input class='eventradio' type='radio' name='startevent' value='"+e+"' id='"+e+"'/> ");return f.append(g),a("<div/>").append(f).html()}function Q(b){var c=a("#execEventTable").udeTable().fnGetSelectedRowDataIndex();a(".eventradio").attr("checked",!1),a(".eventradio").eq(c).attr("checked",!0);var d=c,e=b.state,f=b.execId;if("Finished"==e||"Error"==e){var g=function(b){var c=230,d=b.getParameter("imageStream"),e=b.getParameter("height"),f=b.getParameter("width"),g=e*c/f;a("#eventResultAppImage").attr("src","data:image/png;base64,"+d),a("#eventResultAppImage").height(g),a("#eventResultAppImage").width(c);var h=b.getParameter("errorMsg"),i=b.getParameter("exceptionMessage");h?(a("#errorTable").show(),a("#errorMsg").val(h),a("#errorMsgContent").val(h),a("#exceptionMsg").val(i)):a("#errorTable").hide()};a.ude.rpc.testcaseRpc.getCachedImage(d,g,f)}}function R(){a("#state_container").css("height",a("#stateList").height()-8),a("#event_container").css("height",a("#execEventList").height()-a(".common-content-top").outerHeight()-8),a("#stateTable").udeTable({data:Na,bSort:!1,columns:[{sTitle:"\u72b6\u6001",mData:"state",sWidth:"20%",mRender:O},{sTitle:"\u4efb\u52a1\u540d\u79f0",mData:"taskName",sWidth:"80%"}]}),a("#execEventTable").udeTable({data:null,bSort:!1,columns:[{sTitle:"",mData:"state",sWidth:"5%",mRender:P},{sTitle:"\u72b6\u6001",mData:"state",sWidth:"5%",mRender:O},{sTitle:a.i18n.prop("testcase.caseeditevent.initEventGrid.controlType"),mData:"controlType",sWidth:"10%",mRender:a.ude.page.testcase.caseDesign.eventjs.displayType},{sTitle:"\u6587\u672c",mData:"name",sWidth:"16%",mRender:a.ude.page.testcase.caseDesign.eventjs.displayText},{sTitle:"\u8def\u5f84",mData:"name",sWidth:"10%",mRender:a.ude.page.testcase.caseDesign.eventjs.displayPath},{sTitle:"\u6807\u8bc6",mData:"name",sWidth:"10%",mRender:a.ude.page.testcase.caseDesign.eventjs.displayId},{sTitle:a.i18n.prop("testcase.caseeditevent.initEventGrid.operActionId"),mData:"operActionId",sWidth:"16%"},{sTitle:a.i18n.prop("testcase.caseeditevent.initEventGrid.varValue"),mData:a.ude.page.testcase.caseDesign.eventjs.varToValue,sWidth:"16%"},{sTitle:"\u4f4d\u7f6e",mData:"name",sWidth:"12%",mRender:a.ude.page.testcase.caseDesign.eventjs.displayBound}],onClick:Q})}function S(){for(var b=a("#execEventTable").udeTable().fnGetData(),c=0,d=0,e=0;e<b.length;e++)"Finished"==b[e].state?c++:"Error"==b[e].state&&d++;a("#successCount").text(c),a("#failCount").text(d)}function T(){return Ia=a.ude.page.testcase.appScenedesign.main.findAllSelectedScenes(),0==Ia.length?void showMessage("\u8bf7\u9009\u62e9\u8981\u6267\u884c\u7684\u573a\u666f",null,"error"):void U()}function U(){a("#androidDeviceTbodyExec").html(""),a("#Dialog_selectDeviceAndroidDivExec").css("height","auto"),a.ude.dialog.open("androidDeviceChooseDialog",{title:"\u9009\u62e9\u6d4b\u8bd5\u8bbe\u5907",width:"490px"}),V()}function V(){Y(),a("#androidDeviceTbodyExec").append("<tr class='tr' align='center'><td class='td'><input type='checkbox' name='' value='methodSeclect'/></td><td class='td'>\u8bbe\u5907:&nbsp;<input style='width:180px;' type='text' ></input></td></tr>");var b=a("#androidDeviceTbodyExec").find("tr:last-child").find("input"),c=a(b[1]),d=a.ude.page.testcase.caseDesign.main.getCurrentAvailableDevices();c.udeSelect().setData(d)}function W(){var b=a("#androidDeviceTbodyExec").children(),c=[],d=0,e=0;for(e=0;b[e];e++)a(b[e]).find("input")[0].checked===!0&&(c[d++]=b[e]);for(var f in c)c[f]&&a(c[f]).remove();Y("del")}function X(){for(var b=a("#androidDeviceTbodyExec").find(".select2-chosen"),c=a.ude.page.testcase.caseDesign.main.getCurrentAvailableDevices(),d=[],e=0;e<b.length;e++){var f=a(b[e]),g=f.text();if(""!=g)for(var h=0;h<c.length;h++)c[h].name.indexOf(g)!=-1&&d.push(c[h])}if(0==d.length)return showMessage("\u8bf7\u9009\u62e9\u8981\u4f7f\u7528\u7684\u8bbe\u5907\uff01",null,"error"),!1;Ha={};var i=Ia.length,j=d.length;if(j>i)for(var e=0;e<i;e++)Ha[d[e].id]||(Ha[d[e].id]=[]),Ha[d[e].id].push(Ia[e]);else if(1==j)Ha[d[0].id]=Ia;else{for(var k=Math.floor(i/j),l=k*j,m=0,n=1;n<=l;n++)Ha[d[m].id]||(Ha[d[m].id]=[]),Ha[d[m].id].push(Ia[n-1]),n%j==0?m=0:m++;for(var o=i-l,e=0;e<o;e++){var n=l+e;Ha[d[e].id].push(Ia[n])}}a.ude.dialog.close(),Z()}function Y(b){var c=a("#androidDeviceChooseDialog").parent().offset().top,d=a("#androidDeviceChooseDialog").parent().height(),e=document.body.clientHeight,f=e-d-c,g=a("#Dialog_selectDeviceAndroidDivExec")[0].scrollHeight,h=a("#Dialog_selectDeviceAndroidDivExec")[0].clientHeight,i=g>h;f<30&&("del"!==b||i)?a("#Dialog_selectDeviceAndroidDivExec").css("height",a("#Dialog_selectDeviceAndroidDivExec").height()):a("#Dialog_selectDeviceAndroidDivExec").css("height","auto")}function Z(){a("#scenesExecTabHeader").html(""),a("#scenesExecTab").html(""),a("#scenesExecTab").css("height",500);for(var b in Ha){for(var c="",d=a.ude.page.testcase.caseDesign.main.getCurrentAvailableDevices(),e=0;e<d.length;e++)b==d[e].id&&(c=d[e].name);var f=b.replace(/\./g,"_").replace(/\:/g,"_"),g='<li><a id="for_'+f+'" href="#tabFor_'+f+'"  data-toggle="tab">'+c+"</a></li>";a("#scenesExecTabHeader").append(g);for(var h=Ha[b],e=0;e<h.length;e++)_(h[e].id);var i=h.length,j="<div class='tab-pane active' id=\"tabFor_"+f+"\" style='width:100%;height:100%;overflow:hidden'><div style='float:left;width:75%;border:1px solid #000000;height:100%'><div id=\"stateListFor_"+f+"\" style='height:22%;'><div class='common-content-down' id=\"state_containerFor_"+f+"\"><div class='system-content-down-middle'><div class='down-middle-content'><table id=\"stateTableFor_"+f+"\" class='udeTable' style='width: 50%;'></table></div></div></div></div><div id=\"execEventListFor_"+f+"\" style='height:78%;border-top:1px solid;'><div class='common-content-top common-background'><div class='common-left '><label style='font-size:15px;float:left;'>\u603b\u573a\u666f:<span id=\"sceneCountFor_"+f+'">'+i+'</span></label></div></div><div id="event_containerFor_'+f+"\"></div></div></div><div style='float:right;width:24%;border:1px solid #000000;height:100%'><img id=\"eventResultAppImageFor_"+f+"\" style='width:230px;height:410px' src=''/><table style='width:99%;display:none' id=\"errorTableFor_"+f+"\"><tr><td><label for='errorMsg'>\u9519\u8bef\u4fe1\u606f</label></td></tr><tr><td><textarea readonly='true' class='form-control' id=\"errorMsgFor_"+f+"\" cols='2' style='width:93%;'></textarea></td></tr><tr><td style='width:13%;'><a id=\"showExceptionFor_"+f+"\" href='javascript:void(0)' style='text-decoration:underline'>\u67e5\u770b\u8be6\u60c5</a></td></tr></table></div></div>";a("#scenesExecTab").append(j)}a("#isSaveSceneReportAuto").attr("checked","checked"),a("#downloadExecResultForScenes").attr("disabled","true"),a.ude.dialog.open("executeProcessDialogForSceneExec",{title:"\u6d4b\u8bd5\u573a\u666f\u6267\u884c",width:"1000px"});for(var b in Ha){var f=b.replace(/\./g,"_").replace(/\:/g,"_"),h=Ha[b],k=document.body.clientHeight/(i.length+1);k<=200&&(k=200),document.getElementById("event_containerFor_"+f).innerHTML="";var l=a("#event_containerFor_"+f);l.css("overflow","auto");var k=document.body.clientHeight/(h.length+1);k<=200&&(k=200);for(var e=0;e<h.length;e++)l.append('<div class="common-content-top common-background"><div class="common-left "><label style="font-size:15px;float:left;">\u573a\u666f\u540d\u79f0:<span>'+h[e].name+'</span></label></div><div class="common-right "></div></div><div class="common-content-down"><div class="system-content-down-middle"><div class="down-middle-content" style="height:'+k+'px"><table id="event_containerFor_'+h[e].id+'" class="udeTable" style="width:50%;"></table></div></div></div>')}var m=setInterval(function(){for(var b=!0,c=0;c<Ia.length;c++){var d=Ia[c].id;if(!Ja.hasOwnProperty(d)||!Ja[d].eventData){b=!1;break}}1==b&&(clearInterval(m),$(),a("#scenesExecTabHeader").find("li:last-child").find("a").click())},2e3)}function $(){for(var b in Ha){var c=Ha[b],d=b.replace(/\./g,"_").replace(/\:/g,"_");a("#state_containerFor_"+d).css("height",a("#stateListFor_"+d).height()-8),a("#event_containerFor_"+d).css("height",a("#execEventListFor_"+d).height()-a(".common-content-top").outerHeight()-8),a("#stateTableFor_"+d).udeTable({data:Na,bSort:!1,columns:[{sTitle:"\u72b6\u6001",mData:"state",sWidth:"20%",mRender:O},{sTitle:"\u4efb\u52a1\u540d\u79f0",mData:"taskName",sWidth:"80%"}]}),a("#stateTableFor_"+d).udeTable().dataTable().fnClearTable(),a("#stateTableFor_"+d).udeTable().fnRedraw(Na);for(var e=0;e<c.length;e++)a("#event_containerFor_"+c[e].id).udeTable({data:null,bSort:!1,columns:[{sTitle:"",mData:"state",sWidth:"5%",mRender:P},{sTitle:"\u72b6\u6001",mData:"state",sWidth:"5%",mRender:O},{sTitle:a.i18n.prop("testcase.caseeditevent.initEventGrid.controlType"),mData:"controlType",sWidth:"10%",mRender:a.ude.page.testcase.caseDesign.eventjs.displayType},{sTitle:"\u6587\u672c",mData:"name",sWidth:"16%",mRender:a.ude.page.testcase.caseDesign.eventjs.displayText},{sTitle:"\u8def\u5f84",mData:"name",sWidth:"10%",mRender:a.ude.page.testcase.caseDesign.eventjs.displayPath},{sTitle:"\u6807\u8bc6",mData:"name",sWidth:"10%",mRender:a.ude.page.testcase.caseDesign.eventjs.displayId},{sTitle:a.i18n.prop("testcase.caseeditevent.initEventGrid.operActionId"),mData:"operActionId",sWidth:"16%"},{sTitle:a.i18n.prop("testcase.caseeditevent.initEventGrid.varValue"),mData:a.ude.page.testcase.caseDesign.eventjs.varToValue,sWidth:"16%"},{sTitle:"\u4f4d\u7f6e",mData:"name",sWidth:"12%",mRender:a.ude.page.testcase.caseDesign.eventjs.displayBound}],onClick:ja}),a("#event_containerFor_"+c[e].id).udeTable().dataTable().fnClearTable(),a("#event_containerFor_"+c[e].id).udeTable().fnRedraw(Ja[c[e].id].eventData)}}function _(b){var c=function(a){var c="",d="",e="",f="",g={},h="",i={},j=new DataCenter,k=new DataStore(va),l=a.getDataStore("sceneLevel").getRowSet().getData();l.length>0&&(g=l[0]),h=g.sceneId;for(var m=a.getDataStore("SceneFlowConfig"),n=m.getRowSet().getData(),o=0;o<n.length;o++){var p=n[o].paramGroup,q=n[o].id;""==p&&(p="[defaultPG]"),e+=p+",",c+=n[o].caseId+",",d+=q+",",f=n[o].createPerson}""!=d&&(d=d.substring(0,d.length-1)),""!=c&&(c=c.substring(0,c.length-1)),""!=e&&(e=e.substring(0,e.length-1)),aa(d)&&(i.url="",i.browserType="",i.sceneId=ba(d,c),i.testKind="1",i.projId=sa,i.assignIpAddr="",i.moreConfig="",k.setRowSetName(va),k.getRowSet().addRow(i),j.addDataStore(k),j.addParameter("initScene",b),Ja[b]={sceneIdStr:c,sceneNameStr:d,paramGroupStr:e,allSceneName:f,sceneLevelDs:g,allSceneId:h,execConfig:i,configDc:j,configDs:k},ca(b))};a.ude.rpc.testcaseRpc.getEditSceneByProject(c,b)}function aa(a){return!(!a||""===a)||(showMessage("\u8bf7\u9009\u62e9\u6d4b\u8bd5\u7684\u7528\u4f8b\uff01",null,"error"),!1)}function ba(a,b){for(var c=a,d=c.split(","),e=b.split(","),f=a.split(","),g="",h=!0,i=0;i<d.length;i++){var j=f.indexOf(d[i]);j!=-1&&(h?(g+=e[j],h=!1):g=g+","+e[j])}return g}function ca(b){function c(c){if(c||showMessage("\u83b7\u53d6\u6b65\u9aa4\u4fe1\u606f\u5931\u8d25\uff01",null,"error"),"1"===c.getCode())return void showMessage(c.getDetail(),null,"error");var d=function(d){if(!d)return void showMessage("\u83b7\u53d6\u52a8\u6001\u53c2\u6570\u5931\u8d25",null,"error");if("1"===d.getCode())return void showMessage(d.getDetail(),null,"error");for(var e=c.getDataStore("eventStore"),f=e.getRowSet().getData(),g=d.getDataStore("DynamicParams"),h=g.getRowSet().getData(),i=0;i<f.length;i++){var j=f[i];if(!j.operActionId||"setParam"!=j.operActionId){var k=j.varId;if(j&&j.varType&&"var"==j.varType)if(j.varLevel&&"3"==j.varLevel)for(var l=0;l<h.length;l++){var m=h[l];if(m&&m.paramName&&m.paramName==k&&m.level&&"3"==m.level){j.varValue=m.value;break}}else if(j.varLevel&&"2"==j.varLevel)for(var l=0;l<h.length;l++){var m=h[l];if(m&&m.paramName&&m.paramName==k&&m.level&&"2"==m.level){j.varValue=m.value;break}}else if(j.varLevel&&"1"==j.varLevel)for(var l=0;l<h.length;l++){var m=h[l];if(m&&m.paramName&&m.paramName==k&&m.level&&"1"==m.level){j.varValue=m.value;break}}}}Ja[b].eventData=f,console.info(Ja[b]),a.ude.rpc.testcaseRpc.clearCachedImage(function(){})};a.ude.rpc.testcaseRpc.getDynamicParams(d)}var d=ba(Ja[b].sceneNameStr,Ja[b].sceneIdStr);a.ude.rpc.testcaseRpc.getEventsInScene(d,Ja[b].paramGroupStr,c)}function da(){Qa=[];var b=function(){Oa=!1;for(var a in Ha)Ka++,fa(a)};if("checked"==a("#isSaveSceneReportAuto").attr("checked")){var c=function(){b()};ea(c)}else b()}function ea(b){var c=0,d=function(){var e=Ia[c].id,f="";for(var g in Ha)for(var h=Ha[g],i=0;i<h.length;i++)if(e==h[i].id){f=g;break}var j=new DataCenter;j.addParameter("sceneIdStr",Ja[e].sceneIdStr),j.addParameter("sceneNameStr",Ja[e].sceneNameStr),j.addParameter("caseNameStr",Ja[e].sceneNameStr),j.addParameter("paramGroupStr",Ja[e].paramGroupStr),j.addParameter("allSceneName",Ja[e].allSceneName),j.addParameter("allSceneId",Ja[e].allSceneId),j.addParameter("currentSceneId",e),j.addParameter("currentDevice",f);var k=f.replace(/\./g,"_").replace(/\:/g,"_"),l=a("#stateTableFor_"+k).udeTable().dataTable().fnGetData(),m=a("#event_containerFor_"+e).udeTable().dataTable().fnGetData(),n=new DataStore("stateTable");n.setRowSetName(wa);for(var i=0;i<l.length;i++){var o=new Object;o.eventType="state",o.eventOrder=(i+1).toString(),o.objectText=l[i].taskName,o.resultState=l[i].state,n.getRowSet().addRow(o)}j.addDataStore(n);var p=new DataStore("execEventTable");p.setRowSetName(wa);for(var q=0;q<m.length;q++){var r=new Object;r.eventId=m[q].id,r.eventType="event",r.eventOrder=(q+1).toString();var s=m[q].name;r.objectName=s,r.objectType=a.ude.page.testcase.caseDesign.eventjs.displayType(m[q].controlType,"",m[q]),r.objectText=a.ude.page.testcase.caseDesign.eventjs.displayText(s),r.objectPath=a.ude.page.testcase.caseDesign.eventjs.displayPath(s),r.objectId=a.ude.page.testcase.caseDesign.eventjs.displayId(s),r.operAction=m[q].operActionId,r.operValue=m[q].varValue,r.objectPosition=a.ude.page.testcase.caseDesign.eventjs.displayBound(s),r.resultState=m[q].state,p.getRowSet().addRow(r)}j.addDataStore(p);var t=function(a){if(!a||"0"!==a.getCode())return void showMessage("\u62a5\u544a\u6570\u636e\u4fdd\u5b58\u5931\u8d25\uff01",null,"error");var e=a.getParameter("detailIds");if(e){var f=e.split(",");if(f.length>=3){for(var g=0;g<l.length;g++)l[g].execId=f[g];
for(var g=0;g<m.length;g++)m[g].execId=f[g+3]}}c==Ia.length-1?(Qa.push(a.getParameter("execId")),b()):(Qa.push(a.getParameter("execId")),c++,d())};a.ude.rpc.execute.saveExecResultBasicInfo(j,t)};d()}function fa(b){var c=b.replace(/\./g,"_").replace(/\:/g,"_"),d=function(d){if(!Oa)if(d){var e=d.getParameter("successful"),g=d.getParameter("resultMessage");if(e){var i={taskName:"\u68c0\u67e5\u8bbe\u5907",index:"1",state:"Finished"};if(a("#stateTableFor_"+c).udeTable().dataTable().fnUpdateRowByIndex(0,i),"iOS"==Fa){var k=d.getParameter("selectSim");if(k){for(var l=d.getParameter("simulatorList"),m=l.split(";"),i=[],n=0;n<m.length;n++){var o=m[n];i[n]={id:o,name:o}}a(document).off("click","#selectSim"),a(document).on("click","#selectSim",function(a){h()}),a(document).off("click","#cancelSelectSim"),a(document).on("click","#cancelSelectSim",function(a){f()}),a.ude.page.testcase.caseDesign.main.showSelectIOSSimDialog(i)}else{var i={taskName:"\u542f\u52a8\u5f15\u64ce",index:"2",state:"Running"};a("#stateTable").udeTable().dataTable().fnUpdateRowByIndex(1,i),Ca=d.getParameter("deviceName"),Da=d.getParameter("osVersion"),Ea=d.getParameter("udid"),j()}}else{var i={taskName:"\u542f\u52a8\u5f15\u64ce",index:"2",state:"Running"};a("#stateTableFor_"+c).udeTable().dataTable().fnUpdateRowByIndex(1,i),ga(b)}}else{var i={taskName:"\u68c0\u67e5\u8bbe\u5907",index:"1",state:"Error"};a("#stateTableFor_"+c).udeTable().dataTable().fnUpdateRowByIndex(0,i),showMessage(g,null,"error")}}else{var i={taskName:"\u68c0\u67e5\u8bbe\u5907",index:"1",state:"Error"};a("#stateTableFor_"+c).udeTable().dataTable().fnUpdateRowByIndex(0,i),showMessage("\u83b7\u53d6\u8bbe\u5907\u4fe1\u606f\u5931\u8d25",null,"error")}},e={taskName:"\u68c0\u67e5\u8bbe\u5907",index:"1",state:"Running"};a("#stateTableFor_"+c).udeTable().dataTable().fnUpdateRowByIndex(0,e),"iOS"==Fa?a.ude.rpc.testcaseRpc.checkIOSDevice(d):a.ude.rpc.testcaseRpc.checkDevice(d,b)}function ga(b){var c=b.replace(/\./g,"_").replace(/\:/g,"_"),d=function(d){if(!Oa)if(d){var e=d.getParameter("successful"),f=d.getParameter("resultMessage");if(e){var g={taskName:"\u542f\u52a8\u5f15\u64ce",index:"2",state:"Finished"};a("#stateTableFor_"+c).udeTable().dataTable().fnUpdateRowByIndex(1,g);var g={taskName:"\u542f\u52a8\u5e94\u7528",index:"3",state:"Running"};a("#stateTableFor_"+c).udeTable().dataTable().fnUpdateRowByIndex(2,g),ha(b)}else{var g={taskName:"\u542f\u52a8\u5f15\u64ce",index:"2",state:"Error"};a("#stateTableFor_"+c).udeTable().dataTable().fnUpdateRowByIndex(1,g),showMessage(f,null,"error")}}else{var g={taskName:"\u542f\u52a8\u5f15\u64ce",index:"2",state:"Error"};a("#stateTableFor_"+c).udeTable().dataTable().fnUpdateRowByIndex(1,g),showMessage("\u542f\u52a8\u5f15\u64ce\u5931\u8d25",null,"error")}};a.ude.rpc.testcaseRpc.startAgent(d,b)}function ha(b){var c=b.replace(/\./g,"_").replace(/\:/g,"_"),d=function(d){if(!Oa)if(d){var e=d.getParameter("successful"),f=d.getParameter("resultMessage");if(e){var g={taskName:"\u542f\u52a8\u5e94\u7528",index:"3",state:"Finished"};a("#stateTableFor_"+c).udeTable().dataTable().fnUpdateRowByIndex(2,g),ia(b)}else{var g={taskName:"\u542f\u52a8\u5e94\u7528",index:"3",state:"Error"};a("#stateTableFor_"+c).udeTable().dataTable().fnUpdateRowByIndex(2,g),showMessage(f,null,"error")}}else{var g={taskName:"\u542f\u52a8\u5e94\u7528",index:"3",state:"Error"};a("#stateTableFor_"+c).udeTable().dataTable().fnUpdateRowByIndex(2,g),showMessage("\u542f\u52a8\u5e94\u7528\u5931\u8d25",null,"error")}},e=window.location.host;"iOS"==Fa?a.ude.rpc.testcaseRpc.startIOSApp(e,Ca,Da,Ea,d):a.ude.rpc.testcaseRpc.startApp(e,d,b)}function ia(b){var c=b.replace(/\./g,"_").replace(/\:/g,"_"),d=0,e=0,f=Ha[b];if(0!=f.length){var g=a("#event_containerFor_"+f[0].id).udeTable().fnGetData(),h=parseInt(a("input[name=imageParamForScene]:checked").val(),10),i=function(g){var j=a("#event_containerFor_"+f[e].id).udeTable().dataTable().fnGetData();if(!Oa){var k=(f[e].id,g.getParameter("execResult")),l="";l=k&&"success"==k?"Finished":"Error";var m=j[d];m.state=l,a("#event_containerFor_"+f[e].id).udeTable().dataTable().fnUpdateRowByIndex(d,m);var n=230,o=g.getParameter("imageStream");if(o){var p=g.getParameter("height"),q=g.getParameter("width"),r=p*n/q;a("#eventResultAppImageFor_"+c).attr("src","data:image/png;base64,"+o),a("#eventResultAppImageFor_"+c).height(r),a("#eventResultAppImageFor_"+c).width(n)}var s=g.getParameter("errorMsg"),t=g.getParameter("exceptionMessage");if(s?(a("#errorTableFor_"+c).show(),a("#errorMsgFor_"+c).val(s),a("#errorMsgContentFor_"+c).val(s),a("#exceptionMsgFor_"+c).val(t)):a("#errorTableFor_"+c).hide(),d!=j.length-1){d+=1;var u=j[d];u.state="Running",a("#event_containerFor_"+f[e].id).udeTable().dataTable().fnUpdateRowByIndex(d,u),a("#event_containerFor_"+f[e].id).udeTable().dataTable().fnScrollToRow(d);var v=j[d].execId?j[d].execId:"";a.ude.page.testcase.appCaseDesign.main.runTestEvent(j[d],i,j[d].wait,!1,h,b,v,f[e].id+"_"+d)}else{if("checked"==a("#isSaveSceneReportAuto").attr("checked")){for(var w=[],x=[],y=0;y<j.length;y++)w.push(j[y].execId),x.push(j[y].state);a.ude.rpc.execute.updateMobileExecInfo(w.toString(),x.toString(),function(){})}if(e==f.length-1)a("#executeAllScenes").removeAttr("disabled"),a("#saveExecResultForScenes").removeAttr("disabled"),La++,"checked"==a("#isSaveSceneReportAuto").attr("checked")&&a("#downloadExecResultForScenes").removeAttr("disabled","true");else{e++,d=0;var j=a("#event_containerFor_"+f[e].id).udeTable().dataTable().fnGetData(),z=j[d];z.state="Running",a("#event_containerFor_"+f[e].id).udeTable().dataTable().fnUpdateRowByIndex(d,z),a("#event_containerFor_"+f[e].id).udeTable().dataTable().fnScrollToRow(d);var v=j[d].execId?j[d].execId:"";a.ude.page.testcase.appCaseDesign.main.runTestEvent(j[d],i,j[d].wait,!1,h,b,v,f[e].id+"_"+d)}}}};if(g&&g.length>0){d==-1&&(d=0);var j=g[d];j.state="Running",a("#event_containerFor_"+f[0].id).udeTable().dataTable().fnUpdateRowByIndex(d,j),a("#event_containerFor_"+f[0].id).udeTable().dataTable().fnScrollToRow(d);var k=g[d].execId?g[d].execId:"";a.ude.page.testcase.appCaseDesign.main.runTestEvent(g[d],i,g[d].wait,!1,h,b,k,f[0].id+"_"+d)}}}function ja(b){for(var c=b.eventId,d=-1,e="",f="",g=b.execId,h=a.ude.page.testcase.appScenedesign.main.findAllSelectedScenes(),i=0;i<h.length;i++){var j=a("#event_containerFor_"+h[i].id).udeTable().dataTable().fnGetSelectedRowData();null!=j&&c==j.eventId&&(d=a("#event_containerFor_"+h[i].id).udeTable().dataTable().fnGetSelectedRowDataIndex(),e=Ia[i].id)}for(var k in Ha)for(var l=Ha[k],i=0;i<l.length;i++)if(l[i].id==e){f=k;break}var m=f.replace(/\./g,"_").replace(/\:/g,"_"),n=b.state;if("Finished"==n||"Error"==n){var o=function(b){var c=230,d=b.getParameter("imageStream"),e=b.getParameter("height"),f=b.getParameter("width"),g=e*c/f;a("#eventResultAppImageFor_"+m).attr("src","data:image/png;base64,"+d),a("#eventResultAppImageFor_"+m).height(g),a("#eventResultAppImageFor_"+m).width(c);var h=b.getParameter("errorMsg"),i=b.getParameter("exceptionMessage");h?(a("#errorTableFor_"+m).show(),a("#errorMsgFor_"+m).val(h),a("#errorMsgContentFor_"+m).val(h),a("#exceptionMsgFor_"+m).val(i)):a("#errorTableFor_"+m).hide()};a.ude.rpc.testcaseRpc.getCachedImage(e+"_"+d,o,g)}}a.ude.page.testcase.appSceneExec.main={init:b,initDownloadSceneButton:w,editScene:v,runScene:I};var ka={},la={},ma=null,na="",oa="",pa="",qa="",ra="",sa="",ta="",ua={},va="com.neusoft.utf.portal.execute.entity.UtfTestExecutionT",wa="com.neusoft.utf.portal.execute.entity.UtfMobileExecDetailT",xa="com.neusoft.utf.portal.common.entity.SceneInfo",ya="com.neusoft.utf.portal.common.entity.SceneLevel",za=new DataCenter,Aa=new DataStore(va),Ba=!1,Ca=null,Da=null,Ea=null,Fa="",Ga="",Ha={},Ia=[],Ja={},Ka=0,La=0,Ma=-1,Na=[{taskName:"\u68c0\u67e5\u8bbe\u5907",index:"1",state:"Waiting"},{taskName:"\u542f\u52a8\u5f15\u64ce",index:"2",state:"Waiting"},{taskName:"\u542f\u52a8\u5e94\u7528",index:"3",state:"Waiting"}],Oa=!1,Pa=!1,Qa=[]}(jQuery),function(a){a.execute.mobileResult={getAllMobileResultInfo:function(a){var b={};b.url=appPath+"/utf/execute/getAllMobileResultInfo.action",b.sync=!1,b.load=a,$.maf.action.requestData(b)},getMobileResultDetail:function(a,b){var c=new DataCenter;c.addParameter("execId",a);var d={};d.url=appPath+"/utf/execute/getMobileResultDetail.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},getMobileResultDetailToReport:function(a,b,c){var d=new DataCenter;d.addParameter("execId",a),d.addParameter("withImage",c);var e={};e.url=appPath+"/utf/execute/getMobileResultDetailToReport.action",e.sync=!1,e.load=b,$.maf.action.requestData(e,d)},getMobileResultScreenshot:function(a,b){var c=new DataCenter;c.addParameter("detailId",a);var d={};d.url=appPath+"/utf/execute/getMobileResultScreenshot.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)}}}($.ude.rpc),function(a){function b(){var b={timeOnlyTitle:a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_timeOnlyTitle"),currentText:a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_currentText"),closeText:a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_closeText"),customFormat:"yyyy-mm-dd",showHour:!1,showMinute:!1,showTime:!1,changeMonth:!0,changeYear:!0,monthNamesShort:[a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort1"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort2"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort3"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort4"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort5"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort6"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort7"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort8"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort9"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort10"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort11"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_monthNamesShort12")],dayNamesMin:[a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_dayNamesMin0"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_dayNamesMin1"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_dayNamesMin2"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_dayNamesMin3"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_dayNamesMin4"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_dayNamesMin5"),a.i18n.prop("ude.page.system.project.projectJs.setTimePicker_dayNamesMin6")]};a("#createDate").datetimepicker(b),a("#endFreateDate").datetimepicker(b)}function c(){var b=a.trim(a("#sceneName").val()),c=a.trim(a("#osType").val()),e=a.trim(a("#createPerson").val()),f=a.trim(a("#createDate").val()),g=a.trim(a("#endFreateDate").val()),h=a.trim(a("#caseName").val());return""!=f&&""!=g&&f>g?void showMessage("\u5f00\u59cb\u65f6\u95f4\u4e0d\u80fd\u5927\u4e8e\u7ed3\u675f\u65f6\u95f4",null,"error"):void d(b,c,e,f,g,h)}function d(b,c,d,e,f,g){a("#mobileResultTable").dataTable().fnDestroy(),i(appPath+"/utf/execute/getAllMobileResultInfo.action",[{name:"sceneName",value:b},{name:"osType",value:c},{name:"createPerson",value:d},{name:"createDate",value:e},{name:"endFreateDate",value:f},{name:"caseName",value:g}])}function e(){a("#createDate").mousedown(function(){}),a("#endFreateDate").mousedown(function(){}),a("#searchBtn").bind("click",function(){c()}),a("#casePassCount").bind("click",function(){y()}),a("#eventPassCount").bind("click",function(){z()}),a("#downLoadReport").bind("click",function(){a.ude.util.confirmAdd("\u662f\u5426\u8981\u5c06\u56fe\u7247\u4e0b\u8f7d\u5230\u672c\u5730\uff1f",function(){a.ude.rpc.execute.mobileResult.getMobileResultDetailToReport(I,function(a){var b=a.getParameter("downLoadPath");window.location.href=appPath+b},"yes")},function(){a.ude.rpc.execute.mobileResult.getMobileResultDetailToReport(I,function(a){var b=a.getParameter("downLoadPath");window.location.href=appPath+b},"no")})}),b(),i(appPath+"/utf/execute/getAllMobileResultInfo.action",[]),C=!1,s(),a("#closeExecDialog").bind("click",function(b){a.ude.dialog.close()}),a("#memChartRadio").bind("click",function(){a("#memChart").show(),a("#cpuChart").hide()}),a("#cpuChartRadio").bind("click",function(){a("#memChart").hide(),a("#cpuChart").show()}),f(),a(".common-content-down").css("height",a(".common-content").height()-a(".common-content-top").outerHeight())}function f(){a("#showException").bind("click",function(b){a.ude.dialog.open("exceptionDialog",{title:"\u5f02\u5e38\u4fe1\u606f",width:"490px"})})}function g(b){if(!b)return void showMessage(a.i18n.prop("ude.page.execute.redrawExecResultSuccess"),null,"error");if(1===b.getCode())return void showMessage(b.getDetail(),null,"");var c=b.getDataStore("mobileResultStore"),d=c.getRowSet().getData(),e=d.length;return e>0?(H=d,A(B,H,"passingRates")):h("passingRatesChart","\u6ca1\u6709\u6570\u636e"),d}function h(b,c){var d=B.init(document.getElementById(b));d.dispose();var e=a("#"+b);e[0].innerHTML=c}function i(b,c){a("#mobileResultTable").pagingTable({oLanguage:{sEmptyTable:a.i18n.prop("ude.utfpagingtableJs.paging_nodata"),sInfo:a.i18n.prop("ude.utfpagingtableJs.paging_info"),sInfoEmpty:"",sZeroRecords:a.i18n.prop("ude.utfpagingtableJs.paging_nodata"),oPaginate:{sFirst:a.i18n.prop("ude.utfpagingtableJs.paging_first"),sLast:a.i18n.prop("ude.utfpagingtableJs.paging_last"),sNext:a.i18n.prop("ude.utfpagingtableJs.paging_next"),sPrevious:a.i18n.prop("ude.utfpagingtableJs.paging_previous")}},server:b,serverParams:c,serverCallback:g,bSort:!1,columns:[{sTitle:"\u573a\u666f\u540d",mData:"sceneName",sWidth:"10%"},{sTitle:"\u7528\u4f8b\u540d",mData:"caseName",sWidth:"28%"},{sTitle:"\u7528\u4f8b\u6570",mData:"caseCount",sWidth:"6%"},{sTitle:"\u7528\u4f8b\u901a\u8fc7\u7387",mData:"casePassingRates",sWidth:"6%",mRender:j},{sTitle:"\u6b65\u9aa4\u6570",mData:"eventsCount",sWidth:"6%"},{sTitle:"\u6b65\u9aa4\u901a\u8fc7\u7387",mData:"passingRates",sWidth:"6%",mRender:j},{sTitle:"\u64cd\u4f5c\u7cfb\u7edf",mData:"osType",sWidth:"8%"},{sTitle:"\u6267\u884c\u4eba",mData:"createPerson",sWidth:"10%"},{sTitle:"\u6267\u884c\u65f6\u95f4",mData:"createDate",sWidth:"15%",mRender:k},{sTitle:"\u8be6\u7ec6",mData:"id",sWidth:"5%",mRender:l}]})}function j(a){if(""!=a)return a+"%"}function k(b){return a.ude.util.dateFormat(b,"yyyy-MM-dd hh:mm:ss")}function l(a){return"<div style='text-align:center;'><div title ='\u67e5\u770b\u660e\u7ec6' class='report-query' onclick='$.ude.page.execute.mobileResult.showDetail(\""+a+"\")'></div></div>"}function m(b){I=b,a.ude.rpc.execute.mobileResult.getMobileResultDetail(b,n)}function n(b){if(!b)return void showMessage("\u83b7\u53d6\u8be6\u7ec6\u4fe1\u606f\u5931\u8d25\u3002",null,"error");if("1"===b.getCode())return void showMessage(b.getDetail(),null,"error");var c=b.getDataStore("stateStore"),d=b.getDataStore("eventStore"),e=b.getDataStore("infoStore");D=c.getRowSet().getData();var f=d.getRowSet().getData(),g=e.getRowSet().getData();document.getElementById("telInfos").innerHTML="",null!=g&&a("#telInfos").append("\u624b\u673a\u4fe1\u606f( "),null!=g[0].mobileInfoManufacturer&&a("#telInfos").append("\u5382\u5546\uff1a"+g[0].mobileInfoManufacturer+" | "),null!=g[0].mobileInfoModel&&a("#telInfos").append("\u578b\u53f7\uff1a"+g[0].mobileInfoModel+" | "),null!=g[0].mobileInfoVersion&&a("#telInfos").append("\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\uff1a"+g[0].mobileInfoVersion+" | "),null!=g[0].mobileInfoDensity&&a("#telInfos").append("\u5c4f\u5e55\u5206\u8fa8\u7387\uff1a"+g[0].mobileInfoDensity+" | "),null!=g[0].mobileInfoImsi&&a("#telInfos").append("imsi\uff1a"+g[0].mobileInfoImsi+" | "),null!=g&&a("#telInfos").append(" )"),G=new Array,F=new Array,E=null;for(var h=0;h<f.length;h++)E=b.getDataStore(f[h].operAction+h).getRowSet().getData(),G[h]=f[h].operAction,F[h]=E;document.getElementById("event_container").innerHTML="";var i=a("#event_container");i.css("overflow","auto");var j=document.body.clientHeight/(G.length+1);j<=200&&(j=200);for(var h=0;h<G.length;h++)i.append('<div class="common-content-top common-background"><div class="common-left "><label style="font-size:15px;float:left;">\u7528\u4f8b\u540d\u79f0:<span>'+G[h]+'</span></label></div><div class="common-right "><label style="font-size:15px;float:right;">\u603b\u6b65\u9aa4\u6570:<span id="totalCount'+h+'">0</span>,\u6210\u529f\u6570:<span id="successCount'+h+'">0</span>,\u5931\u8d25\u6570:<span id="failCount'+h+'">0</span></label></div></div><div class="common-content-down"><div class="system-content-down-middle"><div class="down-middle-content" style="height:'+j+'px"><table id="event_container'+h+'" class="udeTable" style="width:50%;"></table></div></div></div>');o()}function o(){p(),a.ude.dialog.open("executeProcess",{title:"\u7528\u4f8b\u6267\u884c\u7ed3\u679c",width:"1000px"}),a("#stateTable").udeTable().dataTable().fnClearTable(),a("#stateTable").udeTable().fnRedraw(D);for(var b=0;b<F.length;b++)if(E=F[b],a("#event_container"+b).udeTable().dataTable().fnClearTable(),a("#event_container"+b).udeTable().fnRedraw(E),a("#event_container"+b).udeTable().fnSelectRowByIndex(null),0==b){a("#event_container"+b).udeTable().fnSelectRowByIndex(E.length-1);var c=a("#event_container"+b).udeTable().fnGetSelectedRowData(),d=a("#event_container"+b).udeTable().data("onClick");d(c)}E=new Array;for(var e=0,b=0;b<F.length;b++)for(var f=0;f<F[b].length;f++)E[e]=F[b][f],e++;t(),a("#memChart").show(),a("#cpuChart").show(),v(B,E),x(B,E),a("#memChartRadio").click()}function p(){a("#state_container").css("height",a("#stateList").height()-8),a("#event_container").css("height",a("#execEventList").height()-a(".common-content-top").outerHeight()-8+document.body.clientHeight-280),C||(a("#stateTable").udeTable({data:null,bSort:!1,columns:[{sTitle:"\u72b6\u6001",mData:"resultState",sWidth:"20%",mRender:r},{sTitle:"\u4efb\u52a1\u540d\u79f0",mData:"objectText",sWidth:"80%"}]}),C=!0);for(var b=0;b<G.length;b++)a("#event_container"+b).udeTable({data:null,bSort:!1,columns:[{sTitle:"\u72b6\u6001",mData:"resultState",sWidth:"5%",mRender:r},{sTitle:a.i18n.prop("testcase.caseeditevent.initEventGrid.controlType"),mData:"objectType",sWidth:"10%"},{sTitle:"\u6587\u672c",mData:"objectText",sWidth:"18%"},{sTitle:"\u8def\u5f84",mData:"objectPath",sWidth:"10%"},{sTitle:"\u6807\u8bc6",mData:"objectId",sWidth:"10%"},{sTitle:a.i18n.prop("testcase.caseeditevent.initEventGrid.operActionId"),mData:"operAction",sWidth:"16%"},{sTitle:a.i18n.prop("testcase.caseeditevent.initEventGrid.varValue"),mData:"operValue",sWidth:"19%"},{sTitle:"\u4f4d\u7f6e",mData:"objectPosition",sWidth:"12%"}],onClick:q})}function q(b){var c=230,d=function(d){var e=d.getParameter("screenshot");if(e&&""!=e){var f=b.resultScreenshotHeight,g=b.resultScreenshotWidth,h=f*c/g;a("#eventResultAppImage").attr("src","data:image/png;base64,"+e),a("#eventResultAppImage").height(h),a("#eventResultAppImage").width(c)}else a("#eventResultAppImage").attr("src","")};a.ude.rpc.execute.mobileResult.getMobileResultScreenshot(b.id,d);var e=b.resultMsg,f=b.resultException;e&&""!=e?(a("#errorTable").show(),a("#errorMsg").val(e),a("#errorMsgContent").val(e),a("#exceptionMsg").val(f)):a("#errorTable").hide()}function r(b,c,d){var e="";e=b?"Running"==b?"running-state":"Finished"==b?"finished-state":"Error"==b?"error-state":"waiting-state":"waiting-state";var f=(d.id,a("<div class='cell-widget' align='center'/>")),g="<div class='testcasestate "+e+"'></div>",h=a(g);return f.append(h),a("<div/>").append(f).html()}function s(){a.ude.pageResizeHandler=function(){a(".common-content-down").css("height",a(".common-content").height()-a(".common-content-top").outerHeight())}}function t(){for(var b=0,c=0,d=1;d<=G.length;d++){b=d;for(var e=a("#event_container"+(d-1)).udeTable().fnGetData(),f=0,g=0,h=0;h<e.length;h++)"Finished"==e[h].resultState?f++:"Error"==e[h].resultState&&g++,"Finished"!=e[h].resultState&&(b=0);0==b&&c++,a("#totalCount"+(d-1)).text(e.length),a("#successCount"+(d-1)).text(f),a("#failCount"+(d-1)).text(g)}0==b&&(b=0),a("#caseCount").text(G.length),a("#caseSuccessCount").text(G.length-c),a("#failCaseCount").text(c),a("#casePassingRates").text(100-c/G.length*100+"%")}function u(a){B=a}function v(a,b){for(var c=a.init(document.getElementById("memChart")),d=[],e=[],f=0;f<b.length;f++)d[f]=f,b[f].resultMem?e[f]=parseInt(b[f].resultMem):e[f]=0;var g={tooltip:{trigger:"axis",formatter:function(a){var c=a[0][0],d=a[0][1],e=a[0][2],f="<div style='text-align:left;'>";return f=f+"\u63a7\u4ef6\u7c7b\u578b:"+b[d].objectType,f=f+"<br/>\u6587\u672c:"+b[d].objectText,f=f+"<br/>\u64cd\u4f5c:"+b[d].operAction,f=f+"<br/>"+c+":"+e+"MB",f+="</div>"}},grid:{x:40,y:10,x2:0,y2:10},calculable:!1,yAxis:[{type:"value",axisLabel:{formatter:"{value}M"}}],xAxis:[{type:"category",data:d,axisLabel:{show:!1}}],series:[{name:"\u5185\u5b58\u5360\u7528",type:"line",data:e}]};c.setOption(g),c.on("click",function(a){var b=a.name;w(b)})}function w(b){for(var c=0,d=-1,e=0;e<G.length;e++)a("#event_container"+e).udeTable().fnSelectRowByIndex(null);for(var e=0;e<G.length;e++){d+=Number(a("#totalCount"+e).text());{if(!(b>d)){b-=c,a("#event_container"+e).udeTable().fnSelectRowByIndex(b),a("#event_container"+e).udeTable().fnScrollToSelectedRow();var f=a("#event_container"+e).udeTable().fnGetSelectedRowData(),g=a("#event_container"+e).udeTable().data("onClick");g(f);break}c+=Number(a("#totalCount"+e).text())}}}function x(a,b){for(var c=a.init(document.getElementById("cpuChart")),d=[],e=[],f=0;f<b.length;f++)d[f]=f,b[f].resultCpu?e[f]=parseInt(b[f].resultCpu):e[f]=0;var g={tooltip:{trigger:"axis",formatter:function(a){var c=a[0][0],d=a[0][1],e=a[0][2],f="<div style='text-align:left;'>";return f=f+"\u63a7\u4ef6\u7c7b\u578b:"+b[d].objectType,f=f+"<br/>\u6587\u672c:"+b[d].objectText,f=f+"<br/>\u64cd\u4f5c:"+b[d].operAction,f=f+"<br/>"+c+":"+e+"%",f+="</div>"}},grid:{x:40,y:10,x2:0,y2:10},calculable:!1,yAxis:[{type:"value",axisLabel:{formatter:"{value}%"}}],xAxis:[{type:"category",data:d,axisLabel:{show:!1}}],series:[{name:"CPU\u5360\u7528",type:"line",data:e}]};c.setOption(g),c.on("click",function(a){var b=a.name;w(b)})}function y(){A(B,H,"casePassingRates"),a("#casePassCount").attr("checked",!0),a("#eventPassCount").attr("checked",!1)}function z(){A(B,H,"passingRates"),a("#eventPassCount").attr("checked",!0),a("#casePassCount").attr("checked",!1)}function A(b,c,d){var e=b.init(document.getElementById("passingRatesChart")),f=[],g=[];if("passingRates"==d)for(var h=0;h<c.length;h++)f[h]=h,c[h].passingRates?g[h]=parseInt(c[h].passingRates):g[h]=0;else if("casePassingRates"==d)for(var h=0;h<c.length;h++)f[h]=h,c[h].casePassingRates?g[h]=parseInt(c[h].casePassingRates):g[h]=0;var i={tooltip:{trigger:"axis",formatter:function(b){var d=b[0][0],e=b[0][1],f=b[0][2],g="<div style='text-align:left;'>";return g=g+"\u573a\u666f\u540d:"+c[e].sceneName,g=g+"<br/>\u6267\u884c\u65f6\u95f4:"+a.ude.util.dateFormat(c[e].createDate,"yyyy-MM-dd hh:mm:ss"),g=g+"<br/>"+d+":"+f+"%",g+="</div>"}},grid:{x:40,y:10,x2:0,y2:10},calculable:!1,yAxis:[{type:"value",axisLabel:{formatter:"{value}%"},splitNumber:5}],xAxis:[{type:"category",data:f,axisLabel:{show:!1}}],series:[{name:"\u901a\u8fc7\u7387",type:"line",data:g}]};e.setOption(i),e.on("click",function(b){var c=b.name;a("#mobileResultTable").udeTable().fnSelectRowByIndex(c),a("#mobileResultTable").udeTable().fnScrollToSelectedRow();var d=a("#mobileResultTable").udeTable().fnGetSelectedRowData(),e=a("#mobileResultTable").udeTable().data("onClick");e(d)})}a.ude.page.execute.mobileResult={init:e,initDashBoard:u,showDetail:m};var B,C=!1,D=null,E=null,F=null,G=null,H=null,I=""}(jQuery),function(a){a.projectStructure={getQueryMenuTree:function(a,b){var c=new DataCenter;c.addParameter("ismenu",b);var d={};d.url=appPath+"/utf/config/projectstructure/queryMenuTree.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},getQueryMenuTreeNode:function(a,b,c,d){var e=new DataCenter;e.addParameter("id",b),e.addParameter("menuId",c),e.addParameter("pageType",d);var f={};f.url=appPath+"/utf/config/projectstructure/queryMenuTreeNode.action",f.sync=!1,f.load=a,$.maf.action.requestData(f,e)},saveMenuTreeData:function(a,b){var c={};c.url=appPath+"/utf/config/projectstructure/saveMenuTreeData.action",c.sync=!1,c.load=a,$.maf.action.requestData(c,b)},delTreeNode:function(a,b){var c=new DataCenter;c.addParameter("id",b);var d={};d.url=appPath+"/utf/config/projectstructure/delTreeNode.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)},getTreeNodeDataByMenuId:function(a,b){var c=new DataCenter;c.addParameter("menuId",b);var d={};d.url=appPath+"/utf/config/projectstructure/getTreeNodeDataByMenuId.action",d.sync=!1,d.load=a,$.maf.action.requestData(d,c)}}}($.ude.rpc),function(a){a.scene={getSceneNodes:function(a,b){var c=new DataCenter;c.addParameter("sceneId",a);var d={};d.url=appPath+"/utf/testcase/scenedesign/getSceneNodes.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},getComboBoxDataCommon:function(a,b){var c={};c.url=appPath+"/utf/testcase/scenedesign/getComboBoxDataCommon.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},setSceneNode:function(a,b,c){var d=new DataCenter;d.addParameter("nodeId",a),d.addParameter("operType",b);var e={};e.url=appPath+"/utf/testcase/scenedesign/setSceneNod.action",e.sync=!1,e.load=c,$.maf.action.requestData(e,d)},addSceneNode:function(a,b,c,d,e,f){var g=new DataCenter;g.addParameter("sceneId",a),g.addParameter("nodeId",b),g.addParameter("caseId",c),g.addParameter("paramFileGrop",d),g.addParameter("methodsStr",e);var h={};h.url=appPath+"/utf/testcase/scenedesign/addSceneNode.action",h.sync=!1,h.load=f,$.maf.action.requestData(h,g)},getSceneInfoAndLevel:function(a,b){var c=new DataCenter;c.addParameter("sceneId",a);var d={};d.url=appPath+"/utf/testcase/scenedesign/getSceneInfoAndLevel.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},saveSceneInfoAndLevel:function(a,b,c,d,e){var f=new DataCenter,g=new DataStore(a),h=new DataStore(b);g.setRowSetName(a),h.setRowSetName(b),g.getRowSet().addRow(c),h.getRowSet().addRow(d),f.addDataStore(g),f.addDataStore(h);var i={};i.url=appPath+"/utf/testcase/scenedesign/saveSceneInfoAndLevel.action",i.sync=!1,i.load=e,$.maf.action.requestData(i,f)},deleteScene:function(a,b){var c=new DataCenter;c.addParameter("sceneId",a);var d={};d.url=appPath+"/utf/testcase/scenedesign/deleteScene.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},saveSceneNode:function(a,b){var c={};c.url=appPath+"/utf/testcase/scenedesign/saveSceneNode.action",c.sync=!1,c.load=b,$.maf.action.requestData(c,a)},getCurrentProjectInfo:function(a){var b={};b.url=appPath+"/utf/testcase/scenedesign/getCurrentProjectInfo.action",b.sync=!1,b.load=a,$.maf.action.requestData(b)},getSceneByCaseId:function(a,b){var c=new DataCenter;c.addParameter("caseId",a);var d={};d.url=appPath+"/utf/testcase/scenedesign/getSceneByCaseId.action",d.sync=!1,d.load=b,$.maf.action.requestData(d,c)},setSceneNodeStateByCaseId:function(a,b,c,d){var e=new DataCenter;e.addParameter("caseId",a),e.addParameter("status",b),e.addParameter("sceneId",c);var f={};f.url=appPath+"/utf/testcase/scenedesign/setSceneNodeStateByCaseId.action",f.sync=!1,f.load=d,$.maf.action.requestData(f,e)}}}($.ude.rpc);